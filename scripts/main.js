"use strict";class CControls extends CTableData{constructor(){super(["control","id","element","className","controlNamePath","name"],["control","id","element","className","controlNamePath","name"],["object","id","controlNamePath"])}findControls(t){let e=new Array,o=this.find(t);for(let t=0;t<o.length;t++)e.push({control:o[t].get(0).asObject,id:o[t].get(1).asString,element:o[t].get(2).asObject,className:o[t].get(3).asString,controlNamePath:o[t].get(4).asString,name:o[t].get(5).asString});return e}addControl(t){CSystem.controls.add([t,t.id,t.controlElement,t.className,t.getNamPath(),t.name]),window[t.name]=t}deleteControl(t){let e=this.findIndexRow("control",t);this.delete(e),delete window[t.name]}getControlFromElement(t){let e=CSystem.controls.findControls([{columnName:"element",value:t}]);return e.length>0?e[0].control:void 0}getControlFromId(t){let e=CSystem.controls.findControls([{columnName:"id",value:t}]);return e.length>0?e[0].control:void 0}}class CPaper extends CSelectArea{constructor(){super(...arguments),this._useDraw=!0}get useDraw(){return this._useDraw}set useDraw(t){this._useDraw=t}doThisPointerMove(t,e){super.doThisPointerMove(t,e)}doPenDraw(t){super.doPenDraw(t)}}class CIcon extends CPanel{constructor(t,e){super(t,e),this.applicationUrl="",this.linkClassName="",this.useMove=!0,this.moveAreaLength=-1,this.useResize=!1,this.resizeAreaLength=0,this.usePointerCapture=!0,this.useMoveClick=!0}doResource(){super.doResource(),this.useMove=!0,this.moveAreaLength=-1,this.useResize=!1,this.resizeAreaLength=0,this.usePointerCapture=!0,this.useMoveClick=!0}doThisPointerDown(t,e){if(!this.selected){if(null!=this.parent&&this.parent instanceof CICons){let t=this.parent.getSelectedIcons();for(let e=0;e<t.length;e++)t[e].selected=!1}this.selected=!0}super.doThisPointerDown(t,e)}doMove(t){if(super.doMove(t),null!=this.parent&&this.parent instanceof CICons){let t=this.parent.getSelectedIcons();for(let e=0;e<t.length;e++)t[e]!=this&&(t[e].position.left+=this.position.left-this.__preMovePoint.x,t[e].position.top+=this.position.top-this.__preMovePoint.y)}}}class CTaskbarIcon extends CIcon{constructor(t,e){super(t,e),this._seq=-1,this.lockMoveY=!0}get seq(){return this._seq}set seq(t){this._seq!=t&&(this._seq=t,null!=this.taskbar&&this.taskbar.doChangeTaskbarIconSeq(this))}doResource(){super.doResource(),this.lockMoveY=!0}doRemove(){this.taskbar=void 0,this.data=void 0,super.doRemove()}}class CICons extends CPaper{doSelectArea(t,e){super.doSelectArea(t,e);let o=this.getIcons(),i=new CRect(t.x,t.y,e.x,e.y);for(let t=0;t<o.length;t++){let e=new CRect(o[t].position.left,o[t].position.top,o[t].position.left+o[t].position.width,o[t].position.top+o[t].position.height);o[t].selected=i.isIntersection(e)}}doKeyDown(t){if(super.doKeyDown(t),t.ctrlKey&&"A"==t.key.toUpperCase()){let t=this.getIcons();for(let e=0;e<t.length;e++)t[e].selected=!0}}getIcons(){let t=new Array,e=CSystem.getChildControls(this);for(let o=0;o<e.length;o++)e[o]instanceof CIcon&&t.push(e[o]);return t}getSelectedIcons(){let t=new Array,e=CSystem.getChildControls(this);for(let o=0;o<e.length;o++)e[o]instanceof CIcon&&e[o].selected&&t.push(e[o]);return t}alignIcons(t,e,o,i){if("force"==t){let t=this.getIcons(),n=o,s=o;if("right"==i)for(let i=0;i<t.length;i++)n+e>window.innerWidth&&(n=o,s+=e+o),t[i].position.left=n,t[i].position.top=s,n+=e+o;else for(let i=0;i<t.length;i++)s+e>window.innerHeight&&(s=o,n+=e+o),t[i].position.left=n,t[i].position.top=s,s+=e+o}else{let t=new Set,n=this.getIcons();for(let s=0;s<n.length;s++){let a=Math.floor(n[s].position.left/(e+o)),r=a*(e+o),l=(a=Math.floor(n[s].position.top/(e+o)))*(e+o);for(;;){if(!t.has(r+","+l)){t.add(r+","+l),n[s].position.left=r+o,n[s].position.top=l+o;break}"right"==i?(r+=e+o)+e>window.innerWidth&&(r=o,l+=e+o):(l+=e+o)+e>window.innerHeight&&(l=o,r+=e+o)}}}}}class CApplication extends CDataClass{constructor(){super(),this._applicationId=CSequence.getSequence(this.className)}static doBeforeExecute(t){}static doAfterExecute(t){}static doBeforeTerminate(t){}static doAfterTerminate(t){}get applicationId(){return this._applicationId}doRemove(){super.doRemove(),this.desktop=void 0}doExecute(){CApplication.applications.set(this.applicationId,this)}doTerminate(){CApplication.applications.delete(this.applicationId),this.remove()}execute(){CApplication.doBeforeExecute(this),this.doExecute(),CApplication.doAfterExecute(this)}terminate(){CApplication.doBeforeTerminate(this),this.doTerminate(),CApplication.doAfterTerminate(this)}}CApplication.systemIcon=new Map,CApplication.applications=new Map;class CCoverApplication extends CApplication{constructor(){super(),this.defaultWidth=1e3,this.defaultHeight=600,this.appName=""}doExecute(){if(super.doExecute(),null!=this.desktop&&null!=this.desktop.cover){let t=this;this.desktop.cover.onHide=function(){null!=t.desktop&&null!=t.desktop.cover&&t.doCoverHide(t.desktop.cover)},this.doCoverShow(this.desktop.cover)}else this.terminate()}doCoverShow(t){t.showCover()}doCoverHide(t){}}class CWindowApplication extends CApplication{constructor(){super(),this.defaultWidth=1e3,this.defaultHeight=600,this.appName="";let t=this;this._mainWindow=new CWindowModel(void 0,this.applicationId),this._mainWindow.resource="window_sky.frame",this._mainWindow.closeAction="hide",this._mainWindow.onHide=function(){t.doWindowClose()}}get mainWindow(){return this._mainWindow}doRemove(){this._mainWindow.remove(),super.doRemove()}doExecute(){super.doExecute(),null!=this.desktop&&(this.mainWindow.parent=this.desktop.applicationLayer,this.mainWindow.showCenter(this.defaultWidth,this.defaultHeight,this.appName,"hide"))}doWindowClose(){this.terminate(),null!=this.onWindowClose&&this.onWindowClose(this)}}class CTaskbar extends CPanel{constructor(t,e){super(t,e),this._iconLength=50,this._iconMargin=10,this.iconsLeft=new CList,this.iconsRight=new CList;let o=this;CSystem.onResourceLoad.push(function(){o.init()})}get iconLength(){return this._iconLength}set iconLength(t){this._iconLength!=t&&(this._iconLength=t,this.doChangeIconLengthMargin())}get iconMargin(){return this._iconMargin}set iconMargin(t){this._iconMargin!=t&&(this._iconMargin=t,this.doChangeIconLengthMargin())}doToData(t){super.doToData(t),CDataClass.putData(t,"iconLength",this.iconLength,50),CDataClass.putData(t,"iconMargin",this.iconMargin,10)}doFromData(t){super.doFromData(t),this.iconLength=CDataClass.getData(t,"iconLength",50),this.iconMargin=CDataClass.getData(t,"iconMargin",10)}doRemove(){super.doRemove(),this.desktop=void 0}doChangeSize(){super.doChangeSize(),this.doSetIconsPosition()}doNotifyAppsChange(){}doChangeTaskbarIconSeq(t){let e=t.seq*(this.iconLength+this.iconMargin)+this.iconMargin;t.position.left=e,t.position.top=this.position.height-this.iconLength-this.iconMargin}doChangeIconLengthMargin(){this.doSetIconsPosition()}doSetIconsPosition(){for(let t=0;t<this.iconsLeft.length;t++){let e=t*(this.iconLength+this.iconMargin)+this.iconMargin;this.iconsLeft.get(t).position.left=e,this.iconsLeft.get(t).position.top=this.position.height-this.iconLength-this.iconMargin,this.iconsLeft.get(t).position.width=this.iconLength,this.iconsLeft.get(t).position.height=this.iconLength}for(let t=0;t<this.iconsRight.length;t++){let e=this.position.width-(t+1)*(this.iconLength+this.iconMargin);this.iconsRight.get(t).position.left=e,this.iconsRight.get(t).position.top=this.position.height-this.iconLength-this.iconMargin,this.iconsRight.get(t).position.width=this.iconLength,this.iconsRight.get(t).position.height=this.iconLength}}doCreateIcons(){let t=this;function e(e){let o=CApplication.systemIcon.get(e.linkClassName);null!=o?CSystem.resources.has(o)?e.resource=o:(e.resource="empty_icon_button.control",e.text=o):(e.resource="empty_icon_button.control",e.text=e.linkClassName),e.onClick=function(){let o=new Function("return new "+e.linkClassName+"()")();o.desktop=t.desktop,o.data=e.data,o.execute()}}for(let t=0;t<CTaskbar.fixListLeft.length;t++){let o=new CTaskbarIcon(this);o.linkClassName=CTaskbar.fixListLeft.get(t),e(o),o.taskbar=this,o.seq=t,this.iconsLeft.add(o)}for(let t=0;t<CTaskbar.fixListRight.length;t++){let o=new CTaskbarIcon(this);o.linkClassName=CTaskbar.fixListRight.get(t),e(o),o.taskbar=this,o.seq=t,o.useMove=!1,this.iconsRight.add(o)}}init(){this.doCreateIcons(),this.doSetIconsPosition()}}CTaskbar.fixListLeft=new CList,CTaskbar.fixListRight=new CList,CTaskbar.systemTaskbars=new CList;class CDesktop extends CICons{constructor(t,e){super(t,e),this.backgroundLayer=new CAnimationControl(this),this.iconLayer=new CPanel(this),this.gadgetLayer=new CPanel(this),this.clock=new CClock(this.gadgetLayer),this.applicationLayer=new CPanel(this),this.frontLayer=new CPanel(this),this.cover=new CCover(this),this.menu=new CPanel(this),this.popupDesktop=new CPopup,this.popupTaskbar=new CPopup,this.popupTaskbarIcon=new CPopup,this.popupIcon=new CPopup,this.taskbar=new CTaskbar(this),this._backgroundImageSrc="",this.taskbar.desktop=this,this.iconLayer.position.align=EPositionAlign.CLIENT,this.gadgetLayer.position.align=EPositionAlign.CLIENT,this.applicationLayer.position.align=EPositionAlign.CLIENT,this.frontLayer.position.align=EPositionAlign.CLIENT,this.backgroundLayer.position.align=EPositionAlign.CLIENT,this.clock.on()}get backgroundImageSrc(){return this._backgroundImageSrc}set backgroundImageSrc(t){if(this._backgroundImageSrc!=t){this._backgroundImageSrc=t;let e=this.layers.getCanvasItems("backgroundImage");for(let o=0;o<e.length;o++)e[o].imageSrc=t}}doResource(){super.doResource(),this.iconLayer.position.align=EPositionAlign.CLIENT,this.gadgetLayer.position.align=EPositionAlign.CLIENT,this.applicationLayer.position.align=EPositionAlign.CLIENT,this.frontLayer.position.align=EPositionAlign.CLIENT,this.backgroundLayer.position.align=EPositionAlign.CLIENT,this.applicationLayer.transform.translateZ=0,CSystem.setDesktopSize(CSystem.desktopAlignKind)}doToData(t){super.doToData(t),CDataClass.putData(t,"taskbar",this.taskbar.toData(),{},!0),CDataClass.putData(t,"menu",this.menu.toData(),{},!0),CDataClass.putData(t,"popupDesktop",this.popupDesktop.toData(),{},!0),CDataClass.putData(t,"popupTaskbar",this.popupTaskbar.toData(),{},!0),CDataClass.putData(t,"popupTaskbarIcon",this.popupTaskbarIcon.toData(),{},!0),CDataClass.putData(t,"popupIcon",this.popupIcon.toData(),{},!0),CDataClass.putData(t,"iconLayer",this.iconLayer.toData(),{},!0),CDataClass.putData(t,"backgroundLayer",this.backgroundLayer.toData(),{},!0),CDataClass.putData(t,"gadgetLayer",this.gadgetLayer.toData(),{},!0),CDataClass.putData(t,"clock",this.clock.toData(),{},!0),CDataClass.putData(t,"applicationLayer",this.applicationLayer.toData(),{},!0),CDataClass.putData(t,"frontLayer",this.frontLayer.toData(),{},!0),CDataClass.putData(t,"cover",this.cover.toData(),{},!0)}doFromData(t){super.doFromData(t),this.taskbar.fromData(CDataClass.getData(t,"taskbar",{},!0)),this.menu.fromData(CDataClass.getData(t,"menu",{},!0)),this.popupDesktop.fromData(CDataClass.getData(t,"popupDesktop",{},!0)),this.popupTaskbar.fromData(CDataClass.getData(t,"popupTaskbar",{},!0)),this.popupTaskbarIcon.fromData(CDataClass.getData(t,"popupTaskbarIcon",{},!0)),this.popupIcon.fromData(CDataClass.getData(t,"popupIcon",{},!0)),this.iconLayer.fromData(CDataClass.getData(t,"iconLayer",{},!0)),this.backgroundLayer.fromData(CDataClass.getData(t,"backgroundLayer",{},!0)),this.gadgetLayer.fromData(CDataClass.getData(t,"gadgetLayer",{},!0)),this.clock.fromData(CDataClass.getData(t,"clock",{},!0)),this.applicationLayer.fromData(CDataClass.getData(t,"applicationLayer",{},!0)),this.frontLayer.fromData(CDataClass.getData(t,"frontLayer",{},!0)),this.cover.fromData(CDataClass.getData(t,"cover",{},!0)),this.iconLayer.position.align=EPositionAlign.CLIENT,this.gadgetLayer.position.align=EPositionAlign.CLIENT,this.applicationLayer.position.align=EPositionAlign.CLIENT,this.frontLayer.position.align=EPositionAlign.CLIENT,this.backgroundLayer.position.align=EPositionAlign.CLIENT,this.applicationLayer.transform.translateZ=0}doChangeSize(){super.doChangeSize(),this.cover.position.width=this.position.width,this.cover.position.height=this.position.height}alignIcons(t,e,o,i){if("force"==t){let t=this.getIcons(),n=o,s=o;if("right"==i)for(let i=0;i<t.length;i++)n+e>window.innerWidth&&(n=o,s+=e+o),t[i].position.left=n,t[i].position.top=s,n+=e+o;else for(let i=0;i<t.length;i++)s+e>window.innerHeight-this.taskbar.position.height&&(s=o,n+=e+o),t[i].position.left=n,t[i].position.top=s,s+=e+o}else{let t=new Set,n=this.getIcons();for(let s=0;s<n.length;s++){let a=Math.floor(n[s].position.left/(e+o)),r=a*(e+o),l=(a=Math.floor(n[s].position.top/(e+o)))*(e+o);for(;;){if(!t.has(r+","+l)){t.add(r+","+l),n[s].position.left=r+o,n[s].position.top=l+o;break}"right"==i?(r+=e+o)+e>window.innerWidth&&(r=o,l+=e+o):(l+=e+o)+e>window.innerHeight-this.taskbar.position.height&&(l=o,r+=e+o)}}}}static newDesktopCover(t){let e=new CCover(document.body),o=e.addLayer().addItem();return o.fill.styleKind=EStyleKind.SOLID,o.fill.solidColor="rgba(0,0,0,0.8)",e.showAnimationTrigger=new CAnimator(e,["line_10000.graph"]),e.showAnimationTrigger.addAnimationGraphProperty("opacity","line_10000.graph",0,1),e.showAnimationTrigger.onGraphAnimate=function(t,e,o,i,n,s){CSystem.desktopList.get(0).filter.blurValue=10*s},e.hideAnimationTrigger=new CAnimator(e,["line_10000.graph"]),e.hideAnimationTrigger.addAnimationGraphProperty("opacity","line_10000.graph",1,0),e.hideAnimationTrigger.onGraphAnimate=function(t,e,o,i,n,s){CSystem.desktopList.get(0).filter.blurValue=10-10*s},e.position.left=0,e.position.top=0,e.position.width=window.innerWidth,e.position.height=window.innerHeight,CSystem.browserCovers.set(t,e),e}}class CSystem{static doAnimationFrame(t,e){try{CSystem.isDraw&&CSystem.doRequestLayersDraw();for(let o=0;o<CSystem.onAnimationFrame.length;o++)CSystem.onAnimationFrame[o](t,e)}catch(t){console.log("do animation frame error",t)}}static doRequestLayersDraw(){CSystem.requestDraw.size>0&&(CSystem.requestDraw.forEach(function(t){try{t.doDraw()}catch(t){console.log("layer draw error",t)}}),CSystem.requestDraw.clear())}static doResourceLoad(){for(let t=0;t<CSystem.requestResources.length;t++)CSystem.requestResources[t].doResource();CSystem.requestResources=[];for(let t=0;t<CSystem.onResourceLoad.length;t++)CSystem.onResourceLoad[t]()}static doGlobalPointerDown(t){let e=t.target;CSystem.hidePickups(e),CSystem.points.set(t.pointerId,t);for(let e=0;e<CSystem.onPointerDown.length;e++)CSystem.onPointerDown[e](t)}static doGlobalPointerMove(t){for(let e=0;e<CSystem.onPointerMove.length;e++)CSystem.onPointerMove[e](t)}static doGlobalPointerUp(t){for(let e=0;e<CSystem.onPointerUp.length;e++)CSystem.onPointerUp[e](t);CSystem.points.delete(t.pointerId)}static doGlobalPointerCancel(t){for(let e=0;e<CSystem.onPointerCancel.length;e++)CSystem.onPointerCancel[e](t);CSystem.points.delete(t.pointerId)}static hidePickups(t){let e=new Set,o=CSystem.controls.findControls([{columnName:"className",value:"CPickupControl"}]),i=CSystem.controls.findControls([{columnName:"className",value:"CPopup"}]);for(let t=0;t<i.length;t++)o.push(i[t]);for(let t=0;t<o.length;t++)e.add(o[t].control);if(0==e.size)return;let n,s=CSystem.controls.getControlFromElement(t),a=t;for(;null!=a;){if("CONTROL"==a.tagName){let t=CSystem.controls.getControlFromElement(a);if(t instanceof CPickupControl){n=t;break}}a=a.parentElement}e.forEach(function(t){null!=n?t!=n&&t.hide():null!=s&&t.ignoreControls.has(s)||t.hide()})}static getOverControls(t,e){let o=new Array;for(let i=0;i<CSystem.controls.length;i++){let n=CSystem.controls.getRow(i).get(0).asObject,s=n.getElementBounds(),a=0,r=0,l=s.left<=t.pageX&&s.right>=t.pageX&&s.top<=t.pageY&&s.bottom>=t.pageY;l&&(a=t.pageX-s.left,r=t.pageY-s.top);let h=!1;for(let t=0;t<e.length;t++)s.left<=e.get(t).point.pageX&&s.right>=e.get(t).point.pageX&&s.top<=e.get(t).point.pageY&&s.bottom>=e.get(t).point.pageY&&(h=!0,a=e.get(t).point.pageX-s.left,r=e.get(t).point.pageY-s.top);(l||h)&&o.push({control:n,x:a,y:r})}return o}static getControl(t){if(t instanceof HTMLElement){let e=this.controls.findIndex(2,t);if(e.length>0)return e[0].get(0).asObject}else{let e=this.controls.findIndex(1,t);if(e.length>0)return e[0].get(0).asObject}}static getControlsFromClassName(t){let e=new Array,o=CSystem.controls.findIndex(3,t);for(let t=0;t<o.length;t++)e.push(o[t].get(0).asObject);return e}static getControlsFromName(t){let e=new Array,o=CSystem.controls.findIndex(4,t);for(let t=0;t<o.length;t++)e.push(o[t].get(0).asObject);return e}static getBroControls(t){let e=new Array,o=t.parent;if(null!=o)for(let t=0;t<o.controlElement.children.length;t++){let i=o.controlElement.children[t];if("CONTROL"==i.tagName){let t=this.getControl(i);e.push(t)}}else if(null!=t.controlElement.parentElement)for(let o=0;o<t.controlElement.parentElement.children.length;o++){let i=t.controlElement.parentElement.children[o];if("CONTROL"==i.tagName){let t=this.getControl(i);e.push(t)}}return e}static getBroVisiblePositions(t){let e=new Array,o=CSystem.getBroControls(t);for(let t=0;t<o.length;t++)o[t].visible&&e.push(o[t].position);return e}static getChildControls(t){let e=new Array;for(let o=0;o<t.controlElement.children.length;o++){let i=t.controlElement.children[o];if("CONTROL"==i.tagName){let t=this.getControl(i);e.push(t)}}return e}static getAllChildControls(t){let e=new Array;function o(t,e){e.push(t);let i=CSystem.getChildControls(t);for(let t=0;t<i.length;t++)o(i[t],e)}let i=CSystem.getChildControls(t);for(let t=0;t<i.length;t++)o(i[t],e);return e}static findControls(t){let e=new Array;for(let o=0;o<t.children.length;o++){let i=t.children[o];if("CONTROL"==i.tagName){let t=this.getControl(i);e.push(t)}}return e}static async threadExec(t){}static scriptExec(t){let e=document.getElementsByTagName("head")[0],o=document.createElement("script");o.innerText=t,e.appendChild(o)}static styleLoad(t){let e=document.getElementsByTagName("head")[0],o=document.createElement("style");o.innerText=t,e.appendChild(o)}static showBrowserCover(t,e,o=!0){let i=CSystem.browserCovers.get(t);null!=i&&(null!=e&&e(i),i.bringToFront(),i.position.left=0,i.position.top=0,i.position.width=window.innerWidth,i.position.height=window.innerHeight,i.showCover(o))}static hideBrowserCover(t){let e=CSystem.browserCovers.get(t);null!=e&&e.hideCover()}static getZPlus(){return CSystem.zPlus++,this.zPlus}static getZMinus(){return CSystem.zMinus--,CSystem.zMinus}static showMessage(t,e,o,i){let n=CSystem.browserCovers.get("cover");if(null!=n){let s=new CPanel(n),a=s.addLayer().addItem();a.fill.styleKind=EStyleKind.SOLID,a.fill.solidColor="#181818",a.radiusX=5,a.radiusY=5,s.position.align=EPositionAlign.CENTER,s.position.width=null==i?300:i;let r=new CLabel(s);r.position.align=EPositionAlign.TOP,r.position.height=40,r.textSet.fill.solidColor="#FFFFFF",r.text=t;let l=new CButton(r);l.resource="button8.control",l.position.align=EPositionAlign.RIGHT,l.position.width=50,l.position.margins.all=5,l.text="확인",l.onClick=function(){null!=n&&n.hideCover(),null!=o&&o()},(l=new CButton(r)).resource="button8.control",l.position.align=EPositionAlign.LEFT,l.position.width=50,l.position.margins.all=5,l.text="취소",l.onClick=function(){null!=n&&n.hideCover()};let h=new CLabel(s);h.position.align=EPositionAlign.CLIENT,h.textSet.fill.solidColor="#FFFFFF",h.text=e;let c=CStringUtil.getTextWidth(h.textSet,e),p=CStringUtil.getTextHeight(h.textSet,e);c+20>s.position.width&&(s.position.width=c+20),s.position.height=85,p+20>40&&(s.position.height=p+20+45),s.filter.filterSet.shadow=!0,s.filter.shadowX=0,s.filter.shadowY=0,n.onHide=function(){s.remove()},n.showCover()}}static confirm(t,e,o,i,n,s){let a=new CPanel(i),r=a.addLayer().addItem();r.fill.styleKind=EStyleKind.SOLID,r.fill.solidColor="#181818",r.radiusX=5,r.radiusY=5,a.position.align=EPositionAlign.CENTER,a.position.width=null==s?300:s;let l=new CLabel(a);l.position.align=EPositionAlign.TOP,l.position.height=40,l.textSet.fill.solidColor="#FFFFFF",l.text=t;let h=new CLabel(a);h.position.align=EPositionAlign.TOP,h.position.height=40,h.textSet.fill.solidColor="#FFFFFF",h.text=e;for(let t=0;t<o.length;t++){let e=new CButton(a);e.resource="button8.control",e.position.align=EPositionAlign.TOP,e.position.height=30,e.position.margins.all=5,e.position.margins.bottom=0,e.text=o[t],e.index=t,e.onClick=function(){i.hideCover(),n(e.index)}}a.position.height=35*o.length+85,a.filter.filterSet.shadow=!0,a.filter.shadowX=0,a.filter.shadowY=0,i.onHide=function(){a.remove()},i.showCover()}static prompt(t,e,o,i,n,s){let a=new CPanel(o),r=a.addLayer().addItem();r.fill.styleKind=EStyleKind.SOLID,r.fill.solidColor="#181818",r.radiusX=5,r.radiusY=5,a.position.align=EPositionAlign.CENTER,a.position.width=null==s?300:s;let l=new CLabel(a);l.position.align=EPositionAlign.TOP,l.position.height=40,l.textSet.fill.solidColor="#FFFFFF",l.text=t;let h=new CButton(l);h.resource="button8.control",h.position.align=EPositionAlign.RIGHT,h.position.width=50,h.position.margins.all=5,h.text="확인",h.onClick=function(){let t=new Array;for(let e=0;e<c.length;e++)t.push(c[e].value);null!=o&&o.hideCover(),i(t)},(h=new CButton(l)).resource="button8.control",h.position.align=EPositionAlign.LEFT,h.position.width=50,h.position.margins.all=5,h.text="취소",h.onClick=function(){null!=o&&o.hideCover()};let c=new Array;for(let t=0;t<e.length;t++){let o=new CLabelTextBox(a);o.textBox.resource="textbox32.control",o.textBox.position.width=200,o.textSet.fill.solidColor="#808080",o.position.align=EPositionAlign.TOP,o.position.height=30,o.position.margins.all=5,o.position.margins.bottom=0,o.label=e[t],c.push(o)}if(null!=n)for(let t=0;t<n.length;t++)c[t].value=n[t];a.position.height=35*e.length+45,a.filter.filterSet.shadow=!0,a.filter.shadowX=0,a.filter.shadowY=0,null!=o&&(o.onHide=function(){a.remove()},o.showCover())}static promptSystem(t,e,o,i,n){let s=CSystem.browserCovers.get("cover");null!=s&&CSystem.prompt(t,e,s,o,i,n)}static elementSendToBack(t){if(null!=t.parentElement){let e=t.parentElement;e.removeChild(t),e.prepend(t)}}static elementBrintToFront(t){if(null!=t.parentElement){let e=t.parentElement;e.removeChild(t),e.appendChild(t)}}static setClipborad(t){}static getClipboard(){return""}static init(t){let e=CSystem.resources.get(t);if(null!=e.init){return new Function(e.init)()}}static setToArray(t){let e=new Array;return t.forEach(function(t){e.push(t)}),e}static setFromArray(t,e){t.clear();for(let o=0;o<e.length;o++)t.add(e[o])}static uploadFiles(t){let e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("webkitdirectory",""),e.setAttribute("directory",""),e.onchange=function(o){const i=e.files;null!=i&&null!=t&&t(i),e.remove()},e.click()}static uploadFilesEach(t){let e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("webkitdirectory",""),e.setAttribute("directory",""),e.onchange=function(o){const i=e.files;if(null!=i)for(let e=0;e<i.length;e++)t(i[e]);e.remove()},e.click()}static saveAsFile(t,e){let o=document.createElement("a");o.href="data:attachment/text,"+encodeURI(t),o.target="_blank",o.download=e,o.click()}static saveBlobAsFile(t,e){var o=URL.createObjectURL(t),i=document.createElement("a");i.setAttribute("href",o),i.setAttribute("download",e),i.click(),i.remove(),URL.revokeObjectURL(o)}static loadFromFile(t){let e=document.createElement("input");e.type="file",e.click(),e.onchange=function(o){null!=e.files&&t(e.files[0])}}static loadFromFiles(t){let e=document.createElement("input");e.type="file",e.multiple=!0,e.click(),e.onchange=function(o){null!=e.files&&t(e.files)}}static async loadSystemResource(){CTimeChecker.startChecker(),await loadSystemResource(),console.log("system resource load",CTimeChecker.stopChecker())}static isDarkMode(){return!!window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches}static setDesktopSize(t){if(null==t||"client"==t)for(let t=0;t<CSystem.desktopList.length;t++)CSystem.desktopList.get(t).position.left=0,CSystem.desktopList.get(t).position.top=0,CSystem.desktopList.get(t).position.width=window.innerWidth,CSystem.desktopList.get(t).position.height=window.innerHeight;else if("vert"==t){let t=window.innerHeight/CSystem.desktopList.length;for(let e=0;e<CSystem.desktopList.length;e++)CSystem.desktopList.get(e).position.left=0,CSystem.desktopList.get(e).position.top=e*t,CSystem.desktopList.get(e).position.width=window.innerWidth,CSystem.desktopList.get(e).position.height=t}else if("horz"==t){let t=window.innerWidth/CSystem.desktopList.length;for(let e=0;e<CSystem.desktopList.length;e++)CSystem.desktopList.get(e).position.left=e*t,CSystem.desktopList.get(e).position.top=0,CSystem.desktopList.get(e).position.width=t,CSystem.desktopList.get(e).position.height=window.innerHeight}else if("grid"==t){let t=Math.floor(Math.sqrt(CSystem.desktopList.length)),e=0,o=0,i=0,n=window.innerWidth/t,s=window.innerHeight/Math.ceil(CSystem.desktopList.length/t);for(;;){let a=o*n,r=i*s;if(CSystem.desktopList.get(e).position.left=a,CSystem.desktopList.get(e).position.top=r,CSystem.desktopList.get(e).position.width=n,CSystem.desktopList.get(e).position.height=s,++o>=t&&(o=0,i++),++e>=CSystem.desktopList.length)break}}}static newDesktop(){let t=new CDesktop(CSystem.clientBody,CSequence.getSequence("desktop"));return CSystem.desktopList.add(t),CSystem.setDesktopSize(CSystem.desktopAlignKind),t}}CSystem.points=new Map,CSystem.dragControls=new Set,CSystem.resourcesLoad=!1,CSystem.controls=new CControls,CSystem.resources=new Map,CSystem.requestResources=new Array,CSystem.clientBody=new CPanel,CSystem.desktopList=new CList,CSystem.desktopAlignKind="client",CSystem.browserCovers=new Map,CSystem.systemFont=new Map,CSystem.requestDraw=new CSet,CSystem.isDraw=!0,CSystem.onAnimationFrame=new Array,CSystem.onResourceLoad=new Array,CSystem.onPointerDown=new Array,CSystem.onPointerMove=new Array,CSystem.onPointerUp=new Array,CSystem.onPointerCancel=new Array,CSystem.zPlus=0,CSystem.zMinus=0;const CON_SOCKET_URL="ws://localhost",CON_HOST="http://localhost";{CSystem.styleLoad("\n        .scrollno {-ms-overflow-style: none;scrollbar-width: none;}\n        .scrollno::-webkit-scrollbar {display: none;}\n    ");let t,e=document.createElement("canvas").getContext("2d");function _t(e){let o=(new Date).getTime();null!=t&&CSystem.doAnimationFrame(t,o),t=o,window.requestAnimationFrame(_t)}null!=e&&(CSystem.bufferingContext=e),window.requestAnimationFrame(_t),async function(){await CSystem.loadSystemResource(),CSystem.resourcesLoad=!0,CSystem.doResourceLoad()}(),loadLazyResource(),window.addEventListener("pointerdown",function(t){CSystem.doGlobalPointerDown(t)}),window.addEventListener("pointermove",function(t){CSystem.doGlobalPointerMove(t)}),window.addEventListener("pointerup",function(t){CSystem.doGlobalPointerUp(t)}),window.addEventListener("pointercancel",function(t){CSystem.doGlobalPointerCancel(t)}),window.addEventListener("load",function(){this.document.body.appendChild(CSystem.clientBody.controlElement),CSystem.clientBody.position.left=0,CSystem.clientBody.position.top=0,CSystem.clientBody.position.width=window.innerWidth,CSystem.clientBody.position.height=window.innerHeight,CDesktop.newDesktopCover("cover"),window.onresize=function(){CSystem.clientBody.position.left=0,CSystem.clientBody.position.top=0,CSystem.clientBody.position.width=window.innerWidth,CSystem.clientBody.position.height=window.innerHeight,CSystem.clientBody.transform.translateZ=0,CSystem.setDesktopSize(CSystem.desktopAlignKind),CSystem.browserCovers.forEach(function(t){t.position.left=0,t.position.top=0,t.position.width=window.innerWidth,t.position.height=window.innerHeight})},CSystem.onResourceLoad.push(function(){CSystem.newDesktop().resource="desktop_dark2.control",CApplication.systemIcon.set("CAppTextEditor","text_button.control"),CApplication.systemIcon.set("CAppPathEditor","shape_button.control"),CApplication.systemIcon.set("CAppLayersSceneEditor","shape_button.control"),CApplication.systemIcon.set("CAppGraphEditor","graph_button.control"),CTaskbar.fixListLeft.add("CAppTextEditor"),CTaskbar.fixListLeft.add("CAppPathEditor"),CTaskbar.fixListLeft.add("CAppLayersSceneEditor"),CTaskbar.fixListLeft.add("CAppGraphEditor"),CSystem.setDesktopSize(CSystem.desktopAlignKind)})})}