"use strict";var EPickupAlignKind,EPickupShowKind,EScrollBarKind,EScrollPressKind,EPointerAreaKind,ECellControlAlign,EEditorShowKind,ETabButtonKind,ECalendarDateKind;!function(t){t[t.LEFT=0]="LEFT",t[t.RIGHT=1]="RIGHT"}(EPickupAlignKind||(EPickupAlignKind={})),function(t){t[t.TOP=0]="TOP",t[t.BOTTOM=1]="BOTTOM"}(EPickupShowKind||(EPickupShowKind={}));class CButton extends CPanel{constructor(t,e){super(t,e),this.pickupResource="",this.pickupHeight=200,this.pickupAlignKind=EPickupAlignKind.LEFT,this.pickupShowKind=EPickupShowKind.BOTTOM,this.usePickupParentBody=!1,this.hasFocus=!0}doToData(t){super.doToData(t),CDataClass.putData(t,"pickupResource",this.pickupResource,""),CDataClass.putData(t,"pickupWidth",this.pickupWidth,void 0),CDataClass.putData(t,"pickupHeight",this.pickupHeight,200),CDataClass.putData(t,"pickupAlignKind",this.pickupAlignKind,EPickupAlignKind.LEFT),CDataClass.putData(t,"pickupShowKind",this.pickupShowKind,EPickupShowKind.BOTTOM),CDataClass.putData(t,"usePickupParentBody",this.usePickupParentBody,!1)}doFromData(t){super.doFromData(t),this.pickupResource=CDataClass.getData(t,"pickupResource",""),this.pickupWidth=CDataClass.getData(t,"pickupWidth",void 0),this.pickupHeight=CDataClass.getData(t,"pickupHeight",200),this.pickupAlignKind=CDataClass.getData(t,"pickupAlignKind",EPickupAlignKind.LEFT),this.pickupShowKind=CDataClass.getData(t,"pickupShowKind",EPickupShowKind.BOTTOM),this.usePickupParentBody=CDataClass.getData(t,"usePickupParentBody",!1)}doKeyDown(t){super.doKeyDown(t)," "!=t.key&&"Enter"!=t.key||this.click()}getPickupWidth(){return null==this.pickupWidth?this.position.width:this.pickupWidth}doClick(t){super.doClick(t);let e=this;if(""!=this.pickupResource)if(this.usePickupParentBody){let t=this.controlElement.getBoundingClientRect(),i=t.left;if(this.pickupAlignKind==EPickupAlignKind.RIGHT&&(i=t.left-t.width-this.getPickupWidth()),null==this._pickup){let o=t.top;o=this.pickupShowKind==EPickupShowKind.BOTTOM?t.top+t.height+1:t.top-this.pickupHeight-1,CPickupControl.showPickup(this.pickupResource,document.body,i,o,this.getPickupWidth(),this.pickupHeight,function(t){e.doBeforePickupShow(t)},function(t){e.doAfterPickupShow(t)},function(t){e.doBeforePickupRemove(t)})}else this._pickup.hide(),this._pickup=void 0}else{this.bringToFront();let t=0;if(this.pickupAlignKind==EPickupAlignKind.RIGHT&&(t=this.position.width-this.getPickupWidth()),null==this._pickup){let i=0;i=this.pickupShowKind==EPickupShowKind.BOTTOM?this.position.height+1:this.position.top-this.pickupHeight-1,CPickupControl.showPickup(this.pickupResource,this,t,i,this.getPickupWidth(),this.pickupHeight,function(t){e.doBeforePickupShow(t)},function(t){e.doAfterPickupShow(t)},function(t){e.doBeforePickupRemove(t)})}else this._pickup.hide(),this._pickup=void 0}}doBeforePickupShow(t){this._pickup=t,this._pickup.ignoreControls.add(this);let e=this;this._pickup.onRemove=function(){e._pickup=void 0},null!=this.onBeforePickupShow&&this.onBeforePickupShow(this,t)}doAfterPickupShow(t){null!=this.onAfterPickupShow&&this.onAfterPickupShow(this,t)}doBeforePickupRemove(t){this._pickup=void 0,null!=this.onBeforePickupRemove&&this.onBeforePickupRemove(this,t)}}class CLabel extends CPanel{constructor(t,e){super(t,e);let i=this.layers.addLayer(),o=i.addItem();o.name="backgroundCanvasItem",this.backgroundCanvasItem=o,(o=i.addItem()).kind=ECanvasItemKind.TEXT,o.name="text"}}class CLabelTextBox extends CLabel{constructor(t,e){super(t,e),this.textBox=new CTextBox(this);let i=this;this.textBox.position.align=EPositionAlign.RIGHT,this.textBox.onResource=function(){i.textBox.position.align=EPositionAlign.RIGHT,i.textSet.hAlign=ETextAlign.HEAD,i.textSet.margins.left=5},this.textBox.position.width=100}get label(){return this.text}set label(t){this.text=t}get value(){return this.textBox.text}set value(t){this.textBox.text=t}doToData(t){super.doToData(t),CDataClass.putData(t,"label",this.label,""),CDataClass.putData(t,"value",this.value,""),CDataClass.putData(t,"textBox",this.textBox.toData(),{},!0)}doFromData(t){super.doFromData(t),this.label=CDataClass.getData(t,"label",""),this.value=CDataClass.getData(t,"value",""),this.textBox.fromData(CDataClass.getData(t,"textBox",{},!0))}doResource(){super.doResource(),this.textBox.position.align=EPositionAlign.RIGHT,this.textSet.hAlign=ETextAlign.HEAD,this.textSet.margins.left=5}addProperties(){let t=new Array;return t.push({instance:this.label,propertyName:"label",readOnly:!1,enum:[]}),t.push({instance:this.value,propertyName:"value",readOnly:!1,enum:[]}),t}}class CCheckBox extends CButton{doClick(t){super.doClick(t),this.checked=!this.checked}}class CSelectBox extends CButton{doClick(t){super.doClick(t),this.selected=!this.selected}}class CMoveControl extends CPanel{constructor(t,e){super(t,e),this.useMove=!0,this.moveAreaLength=this.position.height}doResource(){super.doResource(),this.useMove=!0,this.moveAreaLength=this.position.height}doChangeSize(){super.doChangeSize(),this.moveAreaLength=this.position.height}}class CSelectGroupBox extends CButton{constructor(){super(...arguments),this._groupName=""}get groupName(){return this._groupName}set groupName(t){this._groupName=t}doClick(t){super.doClick(t),this.selected=!0}doChangeSelected(){if(this.selected){let t=this.getGroupOtherItems();for(let e=0;e<t.length;e++)t[e].selected=!1}super.doChangeSelected()}getGroupOtherItems(){let t=new Array,e=CSystem.controls.findControls([{columnName:"className",value:this.className}]);for(let i=0;i<e.length;i++)e[i].control!=this&&e[i].control.as().groupName==this.groupName&&t.push(e[i].control);return t}}class CPickupControl extends CPanel{constructor(t,e){super(t,e),this.autoRemove=!1,this.ignoreControls=new Set,this.hasFocus=!0,this._visible=!1,this.controlElement.style.display="none"}doResource(){super.doResource(),this.hasFocus=!0,this._visible=!1,this.controlElement.style.display="none"}doShowPickup(){this.visible=!0,null!=this.onShow&&this.onShow(this)}doHidePickup(){null!=this.onBeforeHide&&this.onBeforeHide(this),this.visible=!1}doHide(){this.autoRemove&&this.remove(),super.doHide()}show(){this.doShowPickup()}hide(){this.doHidePickup()}static showPickup(t,e,i,o,s,n,a,r,l){let h=new CPickupControl(e);return h.resource=t,h.position.left=i,h.position.top=o,h.position.width=s,h.position.height=n,h.autoRemove=!0,null!=a&&a(h),h.onBeforeRemove=function(t){null!=l&&l(t)},h.show(),null!=r&&r(h),h}}class CPopupItem{constructor(t,e,i=""){this.name="",this.text="",this.shortcut="",this.name=t,this.text=e,this.shortcut=i}}class CPopupItemControl extends CPanel{constructor(){super(...arguments),this.idx=-1,this.popName=""}}class CPopup extends CPickupControl{constructor(){super(document.body),this._items=new CTreeData,this.popupResource="",this.popupItemResource="",this.popupWidth=200,this.position.padding.all=5}get items(){return this._items}itemControlClear(){let t=CSystem.getChildControls(this);for(let e=0;e<t.length;e++)t[e].remove()}itemRefresh(){let t=this;this.itemControlClear();for(let i=0;i<this._items.length;i++){let o=new CPopupItemControl(this);o.idx=i;let s=this._items.getItem(i);if(o.resource=this.popupItemResource,o.position.left=5,o.position.top=30*i+5,o.position.width=this.popupWidth-10,o.position.height=30,null!=s&&null!=s.value.asObject){o.text=s.value.asObject.text,o.popName=s.value.asObject.name,o.canvasItemText("righttext",s.value.asObject.shortcut);let i=30*s.items.length+10;if(s.items.length>0){function e(){t.__cPop=new CPopup,t.__cPop.__pPop=t;let e=t;for(;null!=e.__pPop;)e=e.__pPop;t.__cPop.__apPop=e,t.__cPop.idx=o.idx,t.__cPop.popupResource=t.popupResource,t.__cPop.resource=t.popupResource,t.__cPop.autoRemove=!0,null!=s&&t.__cPop.items.fromData(s.items.toData()),o.getElementBounds().right+t.popupWidth<=window.innerWidth?t.__cPop.position.left=o.getElementBounds().right:t.__cPop.position.left=o.getElementBounds().left-t.popupWidth,o.getElementBounds().top+i<=window.innerHeight?t.__cPop.position.top=o.getElementBounds().top:t.__cPop.position.top=o.getElementBounds().top-i+o.position.height,t.__cPop.position.width=t.popupWidth,t.__cPop.show()}o.canvasItemText("rightarrow","▶"),o.onThisPointerOver=function(){if(null!=t.__cPop){if(o.idx!=t.__cPop.idx){!function t(e){null!=e.__cPop&&t(e.__cPop),e.hide()}(t.__cPop),e()}}else e()}}else o.onThisPointerOver=function(){if(null!=t.__cPop){!function t(e){null!=e.__cPop&&t(e.__cPop),e.hide()}(t.__cPop),t.__cPop=void 0}};o.onClick=function(){null!=t.__apPop?t.__apPop.doPopupClick(o.popName,o.text):t.doPopupClick(o.popName,o.text),t.hide()}}}this.position.height=30*this._items.length+10}doResource(){super.doResource(),this.position.padding.all=5}doPopupClick(t,e){null!=this.onPopupClick&&this.onPopupClick(this,t,e)}doHidePickup(){this.__cPop=void 0,this.__pPop=void 0,this.__apPop=void 0,super.doHidePickup()}addItem(t,e,i,o){if(null!=o){let s=o.addItem();return s.value.asObject=new CPopupItem(t,e,i),s}{let o=this.items.addItem();return o.value.asObject=new CPopupItem(t,e,i),o}}show(){this.itemRefresh(),super.show()}}class CElementControl extends CPanel{constructor(t,e,i){super(e,i),this._elementMargins=new CNotifyRect;let o=this;this._element=document.createElement(t),this._controlElement.appendChild(this._element),this._element.style.position="absolute",this.doInitInnerElement(),this._elementMargins.onChange=function(){o.doSetInnerElementSize()}}get element(){return this._element}get elementMargins(){return this._elementMargins}doToData(t){super.doToData(t),CDataClass.putData(t,"elementMargins",this._elementMargins.toData(),{},!0)}doFromData(t){super.doFromData(t),this.elementMargins.fromData(CDataClass.getData(t,"elementMargins",{},!0))}doResource(){super.doResource(),this.elementBringToFront()}doRemove(){this.element.remove(),super.doRemove()}doSetElementSize(){super.doSetElementSize(),this.doSetInnerElementSize()}doChangeLayerCount(){this.elementBringToFront(),super.doChangeLayerCount()}doInitInnerElement(){let t=this;this._element.addEventListener("pointerdown",function(e){t.enabled&&t.doElementPointerDown(e)}),this._element.addEventListener("pointermove",function(e){t.enabled&&t.doElementPointerMove(e)}),this._element.addEventListener("pointerup",function(e){t.enabled&&t.doElementPointerUp(e)}),this._element.addEventListener("pointercancel",function(e){t.enabled&&t.doElementPointerCancel(e)}),this._element.addEventListener("pointerover",function(e){t.enabled&&t.doElementPointerOver(e)}),this._element.addEventListener("pointerout",function(e){t.enabled&&t.doElementPointerOut(e)}),this._element.addEventListener("pointerenter",function(e){t.enabled&&t.doElementPointerEnter(e)}),this._element.addEventListener("pointerleave",function(e){t.enabled&&t.doElementPointerLeave(e)}),null!=this.onInitInnerElement&&this.onInitInnerElement(this)}doSetInnerElementSize(){this._element.style.left=this.elementMargins.left+"px",this._element.style.top=this.elementMargins.left+"px",this._element.style.width=this.position.width-this.elementMargins.left-this.elementMargins.right+"px",this._element.style.height=this.position.height-this.elementMargins.top-this.elementMargins.bottom+"px",null!=this.onSetInnerElementSize&&this.onSetInnerElementSize(this)}doElementPointerDown(t){null!=this.onElementPointerDown&&this.onElementPointerDown(this,t)}doElementPointerMove(t){null!=this.onElementPointerMove&&this.onElementPointerMove(this,t)}doElementPointerUp(t){null!=this.onElementPointerUp&&this.onElementPointerUp(this,t)}doElementPointerCancel(t){null!=this.onElementPointerCancel&&this.onElementPointerCancel(this,t)}doElementPointerOver(t){null!=this.onElementPointerOver&&this.onElementPointerOver(this,t)}doElementPointerEnter(t){null!=this.onElementPointerEnter&&this.onElementPointerEnter(this,t)}doElementPointerOut(t){null!=this.onElementPointerOut&&this.onElementPointerOut(this,t)}doElementPointerLeave(t){null!=this.onElementPointerLeave&&this.onElementPointerLeave(this,t)}elementBringToFront(){this.element.parentNode==this.controlElement&&(this.controlElement.removeChild(this.element),this.controlElement.appendChild(this.element))}}class CImage extends CElementControl{constructor(t,e){super("img",t,e),this._src="",this._element.style.pointerEvents="none";let i=this;this._element.onload=function(){i.doImageLoad()}}get src(){return this._src}set src(t){this._src!=t&&(this._src=t,this._element.src=t)}doImageLoad(){null!=this.onImageLoad&&this.onImageLoad(this)}doToData(t){super.doToData(t),CDataClass.putData(t,"src",this.src,"")}doFromData(t){super.doFromData(t),this.src=CDataClass.getData(t,"src","")}doInitInnerElement(){this._element.style.border="none",this._element.style.outline="none",this._element.style.objectFit="contain",this._element.style.objectPosition="center",super.doInitInnerElement()}}class CTextBox extends CElementControl{constructor(t,e){super("input",t,e),this._textColor="rgba(0,0,0,1)"}get input(){return this._element}get textColor(){return this._textColor}set textColor(t){this._textColor!=t&&(this._textColor=t,this.input.style.color=t)}get text(){return this.input.value}set text(t){t!=this.input.value&&(this.input.value=t,this.doChange("text"),this.doChangeText())}get focused(){return this._focused}set focused(t){this._focused!=t&&(this._focused=t,t?this.input.focus():this.input.blur(),this.doChange(CControl.CON_CHANGE_FOCUS))}doToData(t){super.doToData(t),CDataClass.putData(t,"textColor",this._textColor,"rgba(0,0,0,1)")}doFromData(t){super.doFromData(t),this.textColor=CDataClass.getData(t,"textColor","rgba(0,0,0,1)")}doSetInnerElementSize(){this._element.style.left=this.elementMargins.left+"px",this._element.style.top=this.elementMargins.top+"px",this._element.style.width=this.position.width-this.elementMargins.left-this.elementMargins.right-4+"px",this._element.style.height=this.position.height-this.elementMargins.top-this.elementMargins.bottom-2+"px",null!=this.onSetInnerElementSize&&this.onSetInnerElementSize(this)}doInitInnerElement(){let t=this;this._element.setAttribute("type","text"),this._element.setAttribute("spellcheck","false"),this._element.style.border="none",this._element.style.outline="none",this._element.style.background="transparent",this._element.addEventListener("focus",function(){t.focused=!0}),this._element.addEventListener("blur",function(){t.focused=!1}),this._element.addEventListener("input",function(e){t.doChange("text"),t.doChangeText()}),super.doInitInnerElement()}}class CTextArea extends CElementControl{constructor(t,e){super("textarea",t,e),this.__useScrollbar=!1,this._wrap=!1,this._textColor="rgba(0,0,0,1)",this._scrollbarResource="",this._hScrollbar=new CScrollbar(this),this._vScrollbar=new CScrollbar(this),this._scrollbarLength=15,this._useHScrollbar=!0,this._useVScrollbar=!0,this.useTab=!0,this.useEnter=!0,this.useCtrlA=!0;let i=this;this._vScrollbar.scrollbarKind=EScrollBarKind.V,this._hScrollbar.onResource=function(){i.doSetInnerElementSize()},this._vScrollbar.onResource=function(){i.doSetInnerElementSize()},this._hScrollbar.onScroll=function(t,e){let o=i.textArea.scrollWidth-parseFloat(CStringUtil.replaceAll(i.textArea.style.width,"px",""));i.textArea.scrollLeft=o*e},this._vScrollbar.onScroll=function(t,e){let o=i.textArea.scrollHeight-parseFloat(CStringUtil.replaceAll(i.textArea.style.height,"px",""));i.textArea.scrollTop=o*e},this._hScrollbar.onThisPointerDown=function(){i.__useScrollbar=!0},this._hScrollbar.onThisPointerUp=function(){i.__useScrollbar=!1},this._vScrollbar.onThisPointerDown=function(){i.__useScrollbar=!0},this._vScrollbar.onThisPointerUp=function(){i.__useScrollbar=!1},this.textArea.addEventListener("scroll",function(t){if(!i.__useScrollbar){let t=i.textArea.scrollWidth-parseFloat(CStringUtil.replaceAll(i.textArea.style.width,"px",""));i.hScrollbar.valueRatio=CCalc.crRange2Value(0,t,i.textArea.scrollLeft,0,1),t=i.textArea.scrollHeight-parseFloat(CStringUtil.replaceAll(i.textArea.style.height,"px","")),i.vScrollbar.valueRatio=CCalc.crRange2Value(0,t,i.textArea.scrollTop,0,1)}}),this.textArea.addEventListener("keydown",function(t){if("A"==t.key.toUpperCase()&&t.ctrlKey&&i.useCtrlA&&i.textArea.select(),"Tab"==t.code&&i.useTab){var e=i.textArea.value,o=i.textArea.selectionStart,s=i.textArea.selectionEnd;i.textArea.value=e.substring(0,o)+"\t"+e.substring(s),i.textArea.selectionStart=i.textArea.selectionEnd=o+1,t.preventDefault()}if("Enter"==t.code&&!t.ctrlKey&&i.useEnter){if(t.isComposing)return;e=i.textArea.value,o=i.textArea.selectionStart,s=i.textArea.selectionEnd;let n=e.substring(0,o),a="";for(let t=n.length-1;t>=0&&"\n"!=n[t];t--)a=n[t]+a;let r=a.split("\t").length-1;i.textArea.value=e.substring(0,o)+"\n";for(let t=0;t<r;t++)i.textArea.value=i.textArea.value+"\t";i.textArea.value=i.textArea.value+e.substring(s),i.textArea.selectionStart=i.textArea.selectionEnd=o+1+r,t.preventDefault()}})}get textArea(){return this._element}get textColor(){return this._textColor}set textColor(t){this._textColor!=t&&(this._textColor=t,this.textArea.style.color=t)}get text(){return this.textArea.value}set text(t){t!=this.textArea.value&&(this.textArea.value=t,this.doChange("text"),this.doChangeText())}get wrap(){return this._wrap}set wrap(t){this._wrap!=t&&(this._wrap=t,t?this.textArea.setAttribute("wrap","on"):this.textArea.setAttribute("wrap","off"))}get focused(){return this._focused}set focused(t){this._focused!=t&&(this._focused=t,t?this.textArea.focus():this.textArea.blur(),this.doChange(CControl.CON_CHANGE_FOCUS))}get scrollbarResource(){return this._scrollbarResource}set scrollbarResource(t){this._scrollbarResource!=t&&(this._scrollbarResource=t,this.doChangeScrollbarResource())}get scrollbarLength(){return this._scrollbarLength}set scrollbarLength(t){this._scrollbarLength!=t&&(this._scrollbarLength=t,this.doChangeScrollbarInfo())}get hScrollbar(){return this._hScrollbar}get vScrollbar(){return this._vScrollbar}get useHScrollbar(){return this._useHScrollbar}set useHScrollbar(t){this._useHScrollbar!=t&&(this._useHScrollbar=t,this.doChangeScrollbarInfo())}get useVScrollbar(){return this._useVScrollbar}set useVScrollbar(t){this._useVScrollbar!=t&&(this._useVScrollbar=t,this.doChangeScrollbarInfo())}doToData(t){super.doToData(t),CDataClass.putData(t,"wrap",this.wrap,!1),CDataClass.putData(t,"textColor",this._textColor,"rgba(0,0,0,1)"),CDataClass.putData(t,"scrollbarResource",this.scrollbarResource,""),CDataClass.putData(t,"scrollbarLength",this.scrollbarLength,15),CDataClass.putData(t,"useHScrollbar",this.useHScrollbar,!0),CDataClass.putData(t,"useVScrollbar",this.useVScrollbar,!0),CDataClass.putData(t,"useTab",this.useTab,!0),CDataClass.putData(t,"useCtrlA",this.useCtrlA,!0),CDataClass.putData(t,"useEnter",this.useEnter,!0)}doFromData(t){super.doFromData(t),this.wrap=CDataClass.getData(t,"wrap",!1),this.textColor=CDataClass.getData(t,"textColor","rgba(0,0,0,1)"),this.scrollbarResource=CDataClass.getData(t,"scrollbarResource",""),this.scrollbarLength=CDataClass.getData(t,"scrollbarLength",15),this.useHScrollbar=CDataClass.getData(t,"useHScrollbar",!0),this.useVScrollbar=CDataClass.getData(t,"useVScrollbar",!0),this.useTab=CDataClass.getData(t,"useTab",!0),this.useCtrlA=CDataClass.getData(t,"useCtrlA",!0),this.useEnter=CDataClass.getData(t,"useEnter",!0)}doSetInnerElementSize(){this._element.style.left=this.elementMargins.left+"px",this._element.style.top=this.elementMargins.top+"px";let t=0,e=0;e=this.useHScrollbar?this.position.height-this.elementMargins.top-this.elementMargins.bottom-this.scrollbarLength:this.position.height-this.elementMargins.top-this.elementMargins.bottom,t=this.useVScrollbar?this.position.width-this.elementMargins.left-this.elementMargins.right-this.scrollbarLength:this.position.width-this.elementMargins.left-this.elementMargins.right,this._element.style.width=t-4+"px",this._element.style.height=e-4+"px",this.useHScrollbar&&(this._hScrollbar.position.left=this.elementMargins.left,this._hScrollbar.position.top=this.position.height-this.elementMargins.bottom-this._scrollbarLength,this._hScrollbar.position.width=t,this._hScrollbar.position.height=this._scrollbarLength,this._hScrollbar.scrollbarKind=EScrollBarKind.H,this._hScrollbar.bringToFront()),this.useVScrollbar&&(this._vScrollbar.position.left=this.position.width-this._scrollbarLength-this.elementMargins.right,this._vScrollbar.position.top=this.elementMargins.top,this._vScrollbar.position.width=this._scrollbarLength,this._vScrollbar.position.height=e,this._vScrollbar.scrollbarKind=EScrollBarKind.V,this._vScrollbar.bringToFront()),this._hScrollbar.visible=this.useHScrollbar,this._vScrollbar.visible=this.useVScrollbar,null!=this.onSetInnerElementSize&&this.onSetInnerElementSize(this)}doInitInnerElement(){let t=this;this._element.setAttribute("spellcheck","false"),this._element.style.border="none",this._element.style.outline="none",this._element.style.background="transparent",this._element.style.resize="none",this._element.style.tabSize="2",this.textArea.setAttribute("wrap","off"),this.textArea.setAttribute("class","scrollno"),this._element.addEventListener("focus",function(){t.focused=!0}),this._element.addEventListener("blur",function(){t.focused=!1}),this._element.addEventListener("input",function(e){t.doChange("text"),t.doChangeText()}),super.doInitInnerElement()}doChangeScrollbarResource(){this._hScrollbar.resource=this._scrollbarResource,this._vScrollbar.resource=this._scrollbarResource}doChangeScrollbarInfo(){this.doSetInnerElementSize()}scrollBottom(){this.textArea.scrollTop=this.textArea.scrollHeight}}!function(t){t[t.H=0]="H",t[t.V=1]="V"}(EScrollBarKind||(EScrollBarKind={})),function(t){t[t.BUTTON1=0]="BUTTON1",t[t.BUTTON2=1]="BUTTON2",t[t.BODY=2]="BODY"}(EScrollPressKind||(EScrollPressKind={}));class CCustomScrollBar extends CPanel{constructor(t,e){super(t,e),this._scrollbarKind=EScrollBarKind.H,this._useScrollButton=!1,this._min=0,this._max=100,this._value=0,this.usePointerCapture=!0}get scrollbarKind(){return this._scrollbarKind}set scrollbarKind(t){this._scrollbarKind!=t&&(this._scrollbarKind=t,this.doChangeScrollBarKind())}get useScrollButton(){return this._useScrollButton}set useScrollButton(t){this._useScrollButton!=t&&(this._useScrollButton=t,this.doChangeUseScrollButton())}get min(){return this._min}set min(t){this._min!=t&&(this._min=t,this.doChangeMin())}get max(){return this._max}set max(t){this._max!=t&&(this._max=t,this.doChangeMax())}get value(){return this._value}set value(t){let e=t;e<this.min&&(e=this.min),e>this.max&&(e=this.max),this._value!=e&&(this._value=e,this.doChangeValue())}get valueRatio(){return CCalc.crRange2Value(this.min,this.max,this.value,0,1)}set valueRatio(t){let e=t;e<0&&(e=0),e>1&&(e=1),this.value=CCalc.crRange2Value(0,1,t,this.min,this.max)}getButtonLength(){switch(this._scrollbarKind){case EScrollBarKind.H:return this._useScrollButton?this.position.height:0;case EScrollBarKind.V:return this._useScrollButton?this.position.width:0}}getCursorLength(){switch(this._scrollbarKind){case EScrollBarKind.H:return this.position.height;case EScrollBarKind.V:return this.position.width}}getValuePosition(){let t=0;if(this.scrollbarKind==EScrollBarKind.H){t=(this.position.width-2*this.getButtonLength()-this.getCursorLength())*this.valueRatio}else{t=(this.position.height-2*this.getButtonLength()-this.getCursorLength())*this.valueRatio}return this.useScrollButton&&(t+=this.getButtonLength()),t}doResource(){super.doResource(),this.usePointerCapture=!0}doToData(t){super.doToData(t),CDataClass.putData(t,"scrollbarKind",this.scrollbarKind,EScrollBarKind.H),CDataClass.putData(t,"useScrollButton",this.useScrollButton,!1),CDataClass.putData(t,"min",this.min,0),CDataClass.putData(t,"max",this.max,100),CDataClass.putData(t,"value",this.value,0)}doFromData(t){super.doFromData(t),this.scrollbarKind=CDataClass.getData(t,"scrollbarKind",EScrollBarKind.H),this.useScrollButton=CDataClass.getData(t,"useScrollButton",!1),this.min=CDataClass.getData(t,"min",0),this.max=CDataClass.getData(t,"max",100),this.value=CDataClass.getData(t,"value",0)}doThisPointerDown(t,e){super.doThisPointerDown(t,e),null==this.__scrollPressKind&&(this.scrollbarKind==EScrollBarKind.H?t.offsetX<this.getButtonLength()?(this.__scrollPressKind=EScrollPressKind.BUTTON1,this.doScrollButton1Down()):t.offsetX>this.position.width-this.getButtonLength()?(this.__scrollPressKind=EScrollPressKind.BUTTON2,this.doScrollButton2Down()):(this.__scrollPressKind=EScrollPressKind.BODY,this.doScrollBody(t)):t.offsetY<this.getButtonLength()?(this.__scrollPressKind=EScrollPressKind.BUTTON1,this.doScrollButton1Down()):t.offsetY>this.position.height-this.getButtonLength()?(this.__scrollPressKind=EScrollPressKind.BUTTON2,this.doScrollButton2Down()):(this.__scrollPressKind=EScrollPressKind.BODY,this.doScrollBody(t)))}doThisPointerMove(t,e){super.doThisPointerMove(t,e),this.__scrollPressKind==EScrollPressKind.BODY&&this.doScrollBody(t)}doThisPointerUp(t,e){switch(super.doThisPointerUp(t,e),this.__scrollPressKind){case EScrollPressKind.BUTTON1:this.doScrollButton1up();break;case EScrollPressKind.BUTTON2:this.doScrollButton2up()}this.__scrollPressKind=void 0}doChangeScrollBarKind(){null!=this.onChangeScrollbarKind&&this.onChangeScrollbarKind(this)}doChangeUseScrollButton(){null!=this.onChangeUseScrollButton&&this.onChangeUseScrollButton(this)}doChangeMin(){this.doScroll(),null!=this.onChangeMin&&this.onChangeMin(this)}doChangeMax(){this.doScroll(),null!=this.onChangeMax&&this.onChangeMax(this)}doChangeValue(){this.doScroll(),null!=this.onChangeValue&&this.onChangeValue(this)}doScroll(){null!=this.onScroll&&this.onScroll(this,this.valueRatio,this.getValuePosition())}doScrollButton1Down(){let t=this;this.__interval=setInterval(function(){t.value--},16),null!=this.onScrollButton1Down&&this.onScrollButton1Down(this)}doScrollButton1up(){clearInterval(this.__interval),null!=this.onScrollButton1Up&&this.onScrollButton1Up(this)}doScrollButton2Down(){let t=this;this.__interval=setInterval(function(){t.value++},16),null!=this.onScrollButton2Down&&this.onScrollButton2Down(this)}doScrollButton2up(){clearInterval(this.__interval),null!=this.onScrollButton2Up&&this.onScrollButton2Up(this)}doScrollBody(t){if(this.scrollbarKind==EScrollBarKind.H){let e=this.position.width-2*this.getButtonLength()-this.getCursorLength(),i=t.offsetX-this.getButtonLength()-this.getCursorLength()/2;this.valueRatio=CCalc.crRange2Value(0,e,i,0,1)}else{let e=this.position.height-2*this.getButtonLength()-this.getCursorLength(),i=t.offsetY-this.getButtonLength()-this.getCursorLength()/2;this.valueRatio=CCalc.crRange2Value(0,e,i,0,1)}null!=this.onScrollBody&&this.onScrollBody(this,t)}}class CScrollbar extends CCustomScrollBar{doResource(){super.doResource(),this.value=0,this.doSetScrollItems()}doChangeUseScrollButton(){super.doChangeUseScrollButton(),this.doSetScrollItems()}doChangeSize(){super.doChangeSize(),this.doSetScrollItems()}doScrollBody(t){super.doScrollBody(t),this.doSetScrollItems()}doScroll(){super.doScroll(),this.doSetScrollItems()}doSetScrollItems(){let t=this.layers.getCanvasItems("scrollbutton1"),e=this.layers.getCanvasItems("scrollbutton2"),i=this.layers.getCanvasItems("scrollcursor");for(let e=0;e<t.length;e++)t[e].visible=this.useScrollButton,t[e].position.height=this.getButtonLength(),t[e].position.width=this.getButtonLength(),this.scrollbarKind==EScrollBarKind.H&&(t[e].align=ECanvasItemAlign.LEFT),this.scrollbarKind==EScrollBarKind.V&&(t[e].align=ECanvasItemAlign.TOP);for(let t=0;t<e.length;t++)e[t].visible=this.useScrollButton,e[t].position.height=this.getButtonLength(),e[t].position.width=this.getButtonLength(),this.scrollbarKind==EScrollBarKind.H&&(e[t].align=ECanvasItemAlign.RIGHT),this.scrollbarKind==EScrollBarKind.V&&(e[t].align=ECanvasItemAlign.BOTTOM);for(let t=0;t<i.length;t++)i[t].align=ECanvasItemAlign.NONE,this.scrollbarKind==EScrollBarKind.H&&(i[t].position.left=this.getValuePosition(),i[t].position.top=0,i[t].position.height=this.getCursorLength(),i[t].position.width=this.getCursorLength()),this.scrollbarKind==EScrollBarKind.V&&(i[t].position.left=0,i[t].position.top=this.getValuePosition(),i[t].position.height=this.getCursorLength(),i[t].position.width=this.getCursorLength())}}class CScrollBox extends CPanel{constructor(t,e){super(t,e),this.__useScrollbar=!1,this.__autoScroll=0,this._background=new CPanel(this),this._scrollbarResource="",this._hScrollbar=new CScrollbar(this),this._vScrollbar=new CScrollbar(this),this._scrollbarLength=15,this._useHScrollbar=!0,this._useVScrollbar=!0,this._scrollAnimatorResource="";let i=this;this._background.overflow="scroll",this._content=new CLayout(this._background),this.overflow="hidden",this._vScrollbar.scrollbarKind=EScrollBarKind.V,this._hScrollbar.onResource=function(){i.doSetInnerSize()},this._vScrollbar.onResource=function(){i.doSetInnerSize()},this._hScrollbar.onScroll=function(t,e){let o=i.scrollWidth-i._background.position.width;i.scrollLeft=o*e},this._vScrollbar.onScroll=function(t,e){let o=i.scrollHeight-i._background.position.height;i.scrollTop=o*e},this._hScrollbar.onThisPointerDown=function(){i.__useScrollbar=!0},this._hScrollbar.onThisPointerUp=function(){i.__useScrollbar=!1},this._vScrollbar.onThisPointerDown=function(){i.__useScrollbar=!0},this._vScrollbar.onThisPointerUp=function(){i.__useScrollbar=!1},this._background.controlElement.onscroll=function(){i.doScroll()}}get scrollAnimatorResource(){return this._scrollAnimatorResource}set scrollAnimatorResource(t){this._scrollAnimatorResource=t,""!=t&&(this.scrollAnimationTrigger=CAnimator.animatorFromResource(this,t))}get isAutoScroll(){return 0!=this.__autoScroll}get background(){return this._background}get content(){return this._content}get contentWidth(){return this._content.position.width}set contentWidth(t){this._content.position.width=t,this.doChangeContentSize()}get contentHeight(){return this._content.position.height}set contentHeight(t){this._content.position.height=t,this.doChangeContentSize()}get scrollLeft(){return this._background.controlElement.scrollLeft}set scrollLeft(t){this._background.controlElement.scrollLeft=t}get scrollTop(){return this._background.controlElement.scrollTop}set scrollTop(t){this._background.controlElement.scrollTop=t}get scrollbarResource(){return this._scrollbarResource}get scrollWidth(){return this._background.controlElement.scrollWidth}get scrollHeight(){return this._background.controlElement.scrollHeight}set scrollbarResource(t){this._scrollbarResource!=t&&(this._scrollbarResource=t,this.doChangeScrollbarResource())}get scrollbarLength(){return this._scrollbarLength}set scrollbarLength(t){this._scrollbarLength!=t&&(this._scrollbarLength=t,this.doChangeScrollbarInfo())}get useHScrollbar(){return this._useHScrollbar}set useHScrollbar(t){this._useHScrollbar!=t&&(this._useHScrollbar=t,this.doChangeScrollbarInfo())}get useVScrollbar(){return this._useVScrollbar}set useVScrollbar(t){this._useVScrollbar!=t&&(this._useVScrollbar=t,this.doChangeScrollbarInfo())}get hScrollbar(){return this._hScrollbar}get vScrollbar(){return this._vScrollbar}get contentViewWidth(){return this._background.position.width-this.position.padding.left-this.position.padding.right}get contentViewHeight(){return this._background.position.height-this.position.padding.top-this.position.padding.bottom}doToData(t){super.doToData(t),CDataClass.putData(t,"scrollbarResource",this.scrollbarResource,""),CDataClass.putData(t,"scrollbarLength",this.scrollbarLength,15),CDataClass.putData(t,"useHScrollbar",this.useHScrollbar,!0),CDataClass.putData(t,"useVScrollbar",this.useVScrollbar,!0),CDataClass.putData(t,"contentWidth",this.contentWidth,0),CDataClass.putData(t,"contentHeight",this.contentHeight,0),CDataClass.putData(t,"scrollAnimatorResource",this.scrollAnimatorResource,""),null!=this.scrollAnimationTrigger&&CDataClass.putData(t,"scrollAnimationTrigger",this.scrollAnimationTrigger.toData(),{},!0)}doFromData(t){super.doFromData(t),this.scrollbarResource=CDataClass.getData(t,"scrollbarResource",""),this.scrollbarLength=CDataClass.getData(t,"scrollbarLength",15),this.useHScrollbar=CDataClass.getData(t,"useHScrollbar",!0),this.useVScrollbar=CDataClass.getData(t,"useVScrollbar",!0),this.contentWidth=CDataClass.getData(t,"contentWidth",0),this.contentHeight=CDataClass.getData(t,"contentHeight",0),CAnimator.fromAnimatorData(t,this,"scrollAnimationTrigger"),this.scrollAnimatorResource=CDataClass.getData(t,"scrollAnimatorResource",""),this.overflow="hidden"}doResource(){super.doResource(),this.overflow="hidden"}doRemove(){this.content.remove(),super.doRemove()}doChangeSize(){super.doChangeSize(),this.doSetInnerSize()}doSetInnerSize(){this.background.position.left=this.position.padding.left,this.background.position.top=this.position.padding.top;let t=0,e=0;e=this.useHScrollbar?this.position.height-this.position.padding.top-this.position.padding.bottom-this.scrollbarLength:this.position.height-this.position.padding.top-this.position.padding.bottom,t=this.useVScrollbar?this.position.width-this.position.padding.left-this.position.padding.right-this.scrollbarLength:this.position.width-this.position.padding.left-this.position.padding.right,this.background.position.width=t,this.background.position.height=e,this._hScrollbar.visible=this.useHScrollbar,this._vScrollbar.visible=this.useVScrollbar,this.useHScrollbar&&(this._hScrollbar.position.left=this.position.padding.left,this._hScrollbar.position.top=this.position.height-this.position.padding.bottom-this._scrollbarLength,this._hScrollbar.position.width=t,this._hScrollbar.position.height=this._scrollbarLength,this._hScrollbar.scrollbarKind=EScrollBarKind.H,this._hScrollbar.bringToFront(),this._hScrollbar.enabled=t<this.contentWidth),this.useVScrollbar&&(this._vScrollbar.position.left=this.position.width-this._scrollbarLength-this.position.padding.right,this._vScrollbar.position.top=this.position.padding.top,this._vScrollbar.position.width=this._scrollbarLength,this._vScrollbar.position.height=e,this._vScrollbar.scrollbarKind=EScrollBarKind.V,this._vScrollbar.bringToFront(),this._vScrollbar.enabled=e<this.contentHeight),null!=this.onSetInnerSize&&this.onSetInnerSize(this)}doChangeScrollbarResource(){this._hScrollbar.resource=this._scrollbarResource,this._vScrollbar.resource=this._scrollbarResource,null!=this.onChangeScrollbarResource&&this.onChangeScrollbarResource(this)}doChangeScrollbarInfo(){this.doSetInnerSize(),null!=this.onChangeScrollbarInfo&&this.onChangeScrollbarInfo(this)}doChangeContentSize(){this.doSetInnerSize(),null!=this.onChangeContentSize&&this.onChangeContentSize(this)}doScroll(){if(null!=this.scrollAnimationTrigger&&this.scrollAnimationTrigger.start(),!this.__useScrollbar){let t=this.scrollWidth-this._background.position.width;this.hScrollbar.valueRatio=CCalc.crRange2Value(0,t,this.scrollLeft,0,1),t=this.scrollHeight-this._background.position.height,this.vScrollbar.valueRatio=CCalc.crRange2Value(0,t,this.scrollTop,0,1)}null!=this.onScroll&&this.onScroll(this)}scrollToLeft(){let t=this,e=this.scrollTop;CAnimation.animate(100,function(i,o,s){t.scrollLeft=e+-e*o})}scrollToRight(){let t=this,e=this.scrollLeft,i=this.scrollWidth-e;CAnimation.animate(100,function(o,s,n){t.scrollLeft=e+i*s})}scrollToTop(){let t=this,e=this.scrollTop;CAnimation.animate(100,function(i,o,s){t.scrollTop=e+-e*o})}scrollToBottom(){let t=this,e=this.scrollTop,i=this.scrollHeight-e;CAnimation.animate(100,function(o,s,n){t.scrollTop=e+i*s})}scrollTo(t,e){let i=t;i>this.scrollWidth&&(i=this.scrollWidth),i<0&&(i=0);let o=e;o>this.scrollHeight&&(o=this.scrollHeight),o<0&&(o=0);let s=this.scrollLeft,n=i-s,a=this.scrollTop,r=o-a,l=this;CAnimation.animate(100,function(t,e,i){l.scrollLeft=s+n*e,l.scrollTop=a+r*e})}startAutoScroll(t,e,i=10,o){let s=this,n=0;n="x"==t?this.scrollLeft:this.scrollTop,0==this.__autoScroll&&(this.__autoScroll=setInterval(function(){"x"==t&&(s.hScrollbar.value+=e,null!=o&&o(s.scrollLeft-n),n=s.scrollLeft,s.hScrollbar.value==s.hScrollbar.max&&s.stopAutoScroll()),"y"==t&&(s.vScrollbar.value+=e,null!=o&&o(s.scrollTop-n),n=s.scrollTop,s.vScrollbar.value==s.vScrollbar.max&&s.stopAutoScroll())},i))}stopAutoScroll(){clearInterval(this.__autoScroll),this.__autoScroll=0}addProperties(){let t=super.addProperties();return t.push({instance:this.scrollAnimationTrigger,propertyName:"scrollAnimationTrigger",readOnly:!1,enum:[]}),t.push({instance:this.contentWidth,propertyName:"contentWidth",readOnly:!1,enum:[]}),t.push({instance:this.contentHeight,propertyName:"contentHeight",readOnly:!1,enum:[]}),t}}class CUnlimitedScrollBox extends CPanel{constructor(t,e){super(t,e),this.__ignoreScroll=!1,this.__scrollChecker=0,this.__useScrollbar=!1,this.__autoScroll=0,this.__preScrollLeft=0,this.__preScrollTop=0,this._background=new CPanel(this),this._scrollbarResource="",this._hScrollbar=new CScrollbar(this),this._vScrollbar=new CScrollbar(this),this._scrollbarLength=15,this._useHScrollbar=!0,this._useVScrollbar=!0,this._scrollMinX=-9e15,this._scrollMaxX=9e15,this._scrollMinY=-9e15,this._scrollMaxY=9e15,this._scrollX=0,this._scrollY=0,this.scrollStopCheckInterval=100,this.isCirculationX=!1,this.isCirculationY=!1,this._scrollAnimatorResource="";let i=this;this._background.overflow="scroll",this.stopPropagation.down=!0,this.stopPropagation.move=!0,this.stopPropagation.up=!0,this.stopPropagation.wheel=!0,this._content=new CLayout(this._background),this._content.position.width=33554400,this._content.position.height=33554400,this.contentToCenter(),this._vScrollbar.scrollbarKind=EScrollBarKind.V,this._hScrollbar.onResource=function(){i.doSetInnerSize()},this._vScrollbar.onResource=function(){i.doSetInnerSize()},this._hScrollbar.onScroll=function(t,e){i.scrollX=CCalc.crRange2Value(0,1,e,i._scrollMinX,i._scrollMaxX)},this._vScrollbar.onScroll=function(t,e){i.scrollY=CCalc.crRange2Value(0,1,e,i._scrollMinY,i._scrollMaxY)},this._hScrollbar.onThisPointerDown=function(){i.__useScrollbar=!0},this._hScrollbar.onThisPointerUp=function(){i.__useScrollbar=!1},this._vScrollbar.onThisPointerDown=function(){i.__useScrollbar=!0},this._vScrollbar.onThisPointerUp=function(){i.__useScrollbar=!1},this._background.controlElement.onscroll=function(){i.__ignoreScroll||i.doScroll()}}get scrollAnimatorResource(){return this._scrollAnimatorResource}set scrollAnimatorResource(t){this._scrollAnimatorResource=t,""!=t&&(this.scrollAnimationTrigger=CAnimator.animatorFromResource(this,t))}get isAutoScroll(){return 0!=this.__autoScroll}get background(){return this._background}get content(){return this._content}get scrollMinX(){return this._scrollMinX}set scrollMinX(t){let e=t;e>this.scrollMaxX&&(e=this.scrollMaxX),this._scrollMinX!=e&&(this._scrollMinX=e,this.doChangeScrollArea())}get scrollMaxX(){return this._scrollMaxX}set scrollMaxX(t){let e=t;e<this.scrollMinX&&(e=this.scrollMinX),this._scrollMaxX!=e&&(this._scrollMaxX=e,this.doChangeScrollArea())}get scrollMinY(){return this._scrollMinY}set scrollMinY(t){let e=t;e>this.scrollMaxY&&(e=this.scrollMaxY),this._scrollMinY!=e&&(this._scrollMinY=e,this.doChangeScrollArea())}get scrollMaxY(){return this._scrollMaxY}set scrollMaxY(t){let e=t;e<this.scrollMinY&&(e=this.scrollMinY),this._scrollMaxY!=e&&(this._scrollMaxY=e,this.doChangeScrollArea())}get scrollX(){return this._scrollX}set scrollX(t){let e=t;this.isCirculationX?(e<this._scrollMinX&&(e=this._scrollMaxX-(this._scrollMinX-e)),e>this._scrollMaxX&&(e=this._scrollMinX+(e-this._scrollMaxX))):(e<this._scrollMinX&&(e=this._scrollMinX),e>this._scrollMaxX&&(e=this._scrollMaxX)),this._scrollX==e||isNaN(e)||(this._scrollX=e,this.doChangeScrollValue())}get scrollY(){return this._scrollY}set scrollY(t){let e=t;this.isCirculationY?(e<this._scrollMinY&&(e=this._scrollMaxY-(this._scrollMinY-e)),e>this._scrollMaxY&&(e=this._scrollMinY+(e-this._scrollMaxY))):(e<this._scrollMinY&&(e=this._scrollMinY),e>this._scrollMaxY&&(e=this._scrollMaxY)),this._scrollY==e||isNaN(e)||(this._scrollY=e,this.doChangeScrollValue())}get scrollbarResource(){return this._scrollbarResource}set scrollbarResource(t){this._scrollbarResource!=t&&(this._scrollbarResource=t,this.doChangeScrollbarResource())}get scrollbarLength(){return this._scrollbarLength}set scrollbarLength(t){this._scrollbarLength!=t&&(this._scrollbarLength=t,this.doChangeScrollbarInfo())}get useHScrollbar(){return this._useHScrollbar}set useHScrollbar(t){this._useHScrollbar!=t&&(this._useHScrollbar=t,this.doChangeScrollbarInfo())}get useVScrollbar(){return this._useVScrollbar}set useVScrollbar(t){this._useVScrollbar!=t&&(this._useVScrollbar=t,this.doChangeScrollbarInfo())}get hScrollbar(){return this._hScrollbar}get vScrollbar(){return this._vScrollbar}get contentViewWidth(){return this._background.position.width-this.position.padding.left-this.position.padding.right}get contentViewHeight(){return this._background.position.height-this.position.padding.top-this.position.padding.bottom}contentToCenter(){this.__ignoreScroll=!0,this._content.position.left=0,this._content.position.top=0,this.background.controlElement.scrollLeft=16777200,this.background.controlElement.scrollTop=16777200,this.__preScrollLeft=this.background.controlElement.scrollLeft,this.__preScrollTop=this.background.controlElement.scrollTop,this.__ignoreScroll=!1}doToData(t){super.doToData(t),CDataClass.putData(t,"scrollbarResource",this.scrollbarResource,""),CDataClass.putData(t,"scrollbarLength",this.scrollbarLength,15),CDataClass.putData(t,"useHScrollbar",this.useHScrollbar,!0),CDataClass.putData(t,"useVScrollbar",this.useVScrollbar,!0),CDataClass.putData(t,"scrollAnimatorResource",this.scrollAnimatorResource,""),null!=this.scrollAnimationTrigger&&CDataClass.putData(t,"scrollAnimationTrigger",this.scrollAnimationTrigger.toData(),{},!0)}doFromData(t){super.doFromData(t),this.scrollbarResource=CDataClass.getData(t,"scrollbarResource",""),this.scrollbarLength=CDataClass.getData(t,"scrollbarLength",15),this.useHScrollbar=CDataClass.getData(t,"useHScrollbar",!0),this.useVScrollbar=CDataClass.getData(t,"useVScrollbar",!0),CAnimator.fromAnimatorData(t,this,"scrollAnimationTrigger"),this.scrollAnimatorResource=CDataClass.getData(t,"scrollAnimatorResource","")}doRemove(){this.content.remove(),super.doRemove()}doChangeSize(){super.doChangeSize(),this.doSetInnerSize()}doSetInnerSize(){this.background.position.left=this.position.padding.left,this.background.position.top=this.position.padding.top;let t=0,e=0;e=this.useHScrollbar?this.position.height-this.position.padding.top-this.position.padding.bottom-this.scrollbarLength:this.position.height-this.position.padding.top-this.position.padding.bottom,t=this.useVScrollbar?this.position.width-this.position.padding.left-this.position.padding.right-this.scrollbarLength:this.position.width-this.position.padding.left-this.position.padding.right,this.background.position.width=t,this.background.position.height=e,this._hScrollbar.visible=this.useHScrollbar,this._vScrollbar.visible=this.useVScrollbar,this.useHScrollbar&&(this._hScrollbar.position.left=this.position.padding.left,this._hScrollbar.position.top=this.position.height-this.position.padding.bottom-this._scrollbarLength,this._hScrollbar.position.width=t,this._hScrollbar.position.height=this._scrollbarLength,this._hScrollbar.scrollbarKind=EScrollBarKind.H,this._hScrollbar.bringToFront()),this.useVScrollbar&&(this._vScrollbar.position.left=this.position.width-this._scrollbarLength-this.position.padding.right,this._vScrollbar.position.top=this.position.padding.top,this._vScrollbar.position.width=this._scrollbarLength,this._vScrollbar.position.height=e,this._vScrollbar.scrollbarKind=EScrollBarKind.V,this._vScrollbar.bringToFront()),null!=this.onSetInnerSize&&this.onSetInnerSize(this)}doChangeScrollbarResource(){this._hScrollbar.resource=this._scrollbarResource,this._vScrollbar.resource=this._scrollbarResource,null!=this.onChangeScrollbarResource&&this.onChangeScrollbarResource(this)}doChangeScrollbarInfo(){this.doSetInnerSize(),null!=this.onChangeScrollbarInfo&&this.onChangeScrollbarInfo(this)}doChangeScrollArea(){this.doSetInnerSize()}doScroll(){if(null!=this.scrollAnimationTrigger&&this.scrollAnimationTrigger.start(),this.__preScrollTime=CTime.now,this.scrollX+=this.background.controlElement.scrollLeft-this.__preScrollLeft,this.scrollY+=this.background.controlElement.scrollTop-this.__preScrollTop,this.__preScrollLeft=this.background.controlElement.scrollLeft,this.__preScrollTop=this.background.controlElement.scrollTop,0==this.__scrollChecker){let t=this;this.__scrollChecker=setInterval(function(){null!=t.__preScrollTime&&CTime.now-t.__preScrollTime>t.scrollStopCheckInterval&&0==t.__pressedThisPoints.length&&0==t.__pressedBubblePoints.length&&(clearInterval(t.__scrollChecker),t.__scrollChecker=0,(t.background.controlElement.scrollLeft>3e7||t.background.controlElement.scrollLeft<1e6||t.background.controlElement.scrollTop>3e7||t.background.controlElement.scrollTop<1e6)&&t.contentToCenter(),t.doScrollStop())},t.scrollStopCheckInterval)}this.__useScrollbar||(this.hScrollbar.valueRatio=CCalc.crRange2Value(this._scrollMinX,this._scrollMaxX,this.scrollX,0,1),this.vScrollbar.valueRatio=CCalc.crRange2Value(this._scrollMinY,this._scrollMaxY,this.scrollY,0,1)),null!=this.onScroll&&this.onScroll(this)}doScrollStop(){null!=this.onScrollStop&&this.onScrollStop(this)}doChangeScrollValue(){null!=this.onChangeScrollValue&&this.onChangeScrollValue(this)}startAutoScroll(t,e,i=10,o){let s=this,n=0;n="x"==t?this.scrollX:this.scrollY,0==this.__autoScroll&&(this.__autoScroll=setInterval(function(){"x"==t&&(s.scrollX+=e,null!=o&&o(s.scrollX-n),n=s.scrollX,s.isCirculationX||s.scrollX!=s.scrollMaxX&&s.scrollX!=s.scrollMinX||s.stopAutoScroll()),"y"==t&&(s.scrollY+=e,null!=o&&o(s.scrollY-n),n=s.scrollY,s.isCirculationY||s.scrollY!=s.scrollMaxY&&s.scrollY!=s.scrollMinY||s.stopAutoScroll())},i))}stopAutoScroll(){clearInterval(this.__autoScroll),this.__autoScroll=0}addProperties(){let t=super.addProperties();return t.push({instance:this.scrollAnimationTrigger,propertyName:"scrollAnimationTrigger",readOnly:!1,enum:[]}),t}}class CCustomListControl extends CPanel{constructor(t,e){super(t,e),this._scroll=new CScrollBox(this),this._itemIndex=-1,this._rowHeight=30,this._itemMargin=0,this._multiSelect=!1,this.useKeyDown=!0;let i=this;this._scroll.position.align=EPositionAlign.CLIENT,this._scroll.useHScrollbar=!1,this._scroll.onScroll=function(){i.doScroll()},this._scroll.onChangeSize=function(){i.doChangeScrollBoxSize()},this._scroll.position.onChangeSize=function(){i.doChangeScrollBoxSize()},this._scroll.onChangeScrollbarInfo=function(){i.doSetScrollContent()},this.scrollBox.background.onThisPointerDown=function(t,e,o){i.doBackgroundPointerDown(e,o)},this.scrollBox.background.onThisPointerMove=function(t,e,o){i.doBackgroundPointerMove(e,o)},this.scrollBox.background.onThisPointerUp=function(t,e,o){i.doBackgroundPointerUp(e,o)},this.scrollBox.background.onThisPointerCancel=function(t,e,o){i.doBackgroundPointerCancel(e,o)},this.scrollBox.background.onThisPointerOver=function(t,e,o){i.doBackgroundPointerOver(e,o)},this.scrollBox.background.onThisPointerOut=function(t,e,o){i.doBackgroundPointerOut(e,o)},this.scrollBox.background.onThisPointerEnter=function(t,e,o){i.doBackgroundPointerEnter(e,o)},this.scrollBox.background.onThisPointerLeave=function(t,e,o){i.doBackgroundPointerLeave(e,o)}}get scrollBox(){return this._scroll}get itemIndex(){return this._itemIndex}set itemIndex(t){let e=t;e<-1&&(e=-1),this._itemIndex!=e&&(this._itemIndex=e,this.doChangeItemIndex())}get rowHeight(){return this._rowHeight}set rowHeight(t){let e=t;e<0&&(e=0),this._rowHeight!=e&&(this._rowHeight=e,this.doChangeItemInfo())}get itemMargin(){return this._itemMargin}set itemMargin(t){this._itemMargin!=t&&(this._itemMargin=t,this.doChangeItemInfo())}get multiSelect(){return this._multiSelect}set multiSelect(t){this._multiSelect!=t&&(this._multiSelect=t,this.doChangeMultiSelect())}get scrollbarResource(){return this.scrollBox.scrollbarResource}set scrollbarResource(t){this.scrollBox.scrollbarResource!=t&&(this.scrollBox.scrollbarResource=t)}get scrollbarLength(){return this.scrollBox.scrollbarLength}set scrollbarLength(t){this.scrollBox.scrollbarLength=t}get length(){return this.getLength()}get scrollTop(){return this.scrollBox.scrollTop}set scrollTop(t){this.scrollBox.scrollTop=t}get scrollHeight(){return this.scrollBox.scrollHeight}getLength(){return 0}doToData(t){super.doToData(t),CDataClass.putData(t,"rowHeight",this.rowHeight,30),CDataClass.putData(t,"itemMargin",this.itemMargin,0),CDataClass.putData(t,"multiSelect",this.multiSelect,!1),CDataClass.putData(t,"useKeyDown",this.useKeyDown,!0),CDataClass.putData(t,"scrollbarResource",this.scrollbarResource,""),CDataClass.putData(t,"scrollbarLength",this.scrollbarLength,15)}doFromData(t){super.doFromData(t),this.rowHeight=CDataClass.getData(t,"rowHeight",30),this.itemMargin=CDataClass.getData(t,"itemMargin",0),this.multiSelect=CDataClass.getData(t,"multiSelect",!1),this.useKeyDown=CDataClass.getData(t,"useKeyDown",!0),this.scrollbarResource=CDataClass.getData(t,"scrollbarResource",""),this.scrollbarLength=CDataClass.getData(t,"scrollbarLength",15)}doChangeSize(){super.doChangeSize(),this.doSetScrollContent()}doChangeItemIndex(){null!=this.onChangeItemIndex&&this.onChangeItemIndex(this)}doChangeItemInfo(){this.doSetScrollContent(),null!=this.onChangeItemInfo&&this.onChangeItemInfo(this)}doSetScrollContent(){this._scroll.contentWidth=this._scroll.contentViewWidth,this._scroll.contentHeight=(this.rowHeight+this.itemMargin)*this.length+this.itemMargin,null!=this.onSetScrollContent&&this.onSetScrollContent(this)}doScroll(){null!=this.onScroll&&this.onScroll(this)}doChangeScrollBoxSize(){this.doSetScrollContent(),null!=this.onChangeScrollBoxSize&&this.onChangeScrollBoxSize(this)}doChangeMultiSelect(){null!=this.onChangeMultiSelect&&this.onChangeMultiSelect(this)}doBackgroundPointerDown(t,e){null!=this.onBackgroundPointerDown&&this.onBackgroundPointerDown(this,t,e)}doBackgroundPointerMove(t,e){null!=this.onBackgroundPointerMove&&this.onBackgroundPointerMove(this,t,e)}doBackgroundPointerUp(t,e){null!=this.onBackgroundPointerUp&&this.onBackgroundPointerUp(this,t,e)}doBackgroundPointerCancel(t,e){null!=this.onBackgroundPointerCancel&&this.onBackgroundPointerCancel(this,t,e)}doBackgroundPointerOver(t,e){null!=this.onBackgroundPointerOver&&this.onBackgroundPointerOver(this,t,e)}doBackgroundPointerOut(t,e){null!=this.onBackgroundPointerOut&&this.onBackgroundPointerOut(this,t,e)}doBackgroundPointerEnter(t,e){null!=this.onBackgroundPointerEnter&&this.onBackgroundPointerEnter(this,t,e)}doBackgroundPointerLeave(t,e){null!=this.onBackgroundPointerLeave&&this.onBackgroundPointerLeave(this,t,e)}doKeyDown(t){super.doKeyDown(t),this.useKeyDown&&("ArrowUp"==t.key&&this.itemIndex>0&&(this.itemIndex--,this.getItemPosition(this.itemIndex).top<this.scrollTop&&this.scrollToIndex(this.itemIndex)),"ArrowDown"==t.key&&this.itemIndex<this.getLength()-1&&(this.itemIndex++,this.getItemPosition(this.itemIndex).top>this.scrollTop+this.scrollBox.contentViewHeight-1&&this.scrollToIndexBottom(this.itemIndex)),"PageUp"==t.key&&(this.scrollTop-=this.scrollBox.contentViewHeight),"PageDown"==t.key&&(this.scrollTop+=this.scrollBox.contentViewHeight),"End"==t.key&&this.scrollToBottom(),"Home"==t.key&&this.scrollToTop())}getItemPosition(t){let e=this.itemMargin+(this.rowHeight+this.itemMargin)*t;return new CRect(this.itemMargin,e,this._scroll.contentViewWidth-this.itemMargin,e+this.rowHeight)}yToIndex(t){if(this.rowHeight<=0)throw new Error("invalid row height : "+this.rowHeight);let e=this.rowHeight+this.itemMargin;return{index:Math.floor(t/e),isMargin:t%e<=this.itemMargin}}getScrollShowPositions(){if(this.rowHeight<=0)throw new Error("invalid row height : "+this.rowHeight);let t=new Array,e=this.yToIndex(this._scroll.scrollTop).index;for(;e*(this.rowHeight+this.itemMargin)+this.itemMargin<this._scroll.scrollTop+this.scrollBox.position.height&&e<this.length;){let i={index:e,position:this.getItemPosition(e)};t.push(i),e++}return t}scrollToBottom(){this.getLength()>0&&this.scrollToIndex(this.getLength()-1)}scrollToTop(){this.getLength()>0&&this.scrollToIndex(0)}scrollToIndex(t){let e=this,i=e.scrollBox.scrollTop,o=e.getItemPosition(t).top-i;CAnimation.animate(100,function(t,s,n){e.scrollBox.scrollTop=i+o*s})}scrollToIndexBottom(t){let e=this,i=e.scrollBox.scrollTop,o=e.getItemPosition(t).top-(e.scrollBox.contentViewHeight-e.rowHeight-e.itemMargin)-i;CAnimation.animate(100,function(t,s,n){e.scrollBox.scrollTop=i+o*s})}addProperties(){let t=new Array;return t.push({instance:this.scrollBox.scrollbarResource,propertyName:"scrollbarResource",readOnly:!1,enum:[]}),t.push({instance:this.scrollBox.scrollTop,propertyName:"scrollTop",readOnly:!1,enum:[]}),t.push({instance:this.scrollBox.scrollHeight,propertyName:"scrollHeight",readOnly:!1,enum:[]}),t.push({instance:this.scrollBox.scrollbarLength,propertyName:"scrollbarLength",readOnly:!1,enum:[]}),t}}class CCustomCanvasListBox extends CCustomListControl{constructor(t,e){super(t,e),this.__preItemClick={time:0,index:-1},this.__downIdx=-1,this.__overIdx=-1,this.__offset=new CNotifyPoint(0,0),this.__listItemData=new Array,this._listItemResource=new Array,this._isDraw=!0,this._selecteItems=new Set,this._checkItems=new Set,this._useCheckBox=!1,this._checkBoxArea=new CRect(0,0,20,20);let i=this;this.__itemsLayer=this.scrollBox.layers.addLayer(),CSystem.elementBrintToFront(this.__itemsLayer.canvas);let o=this.__itemsLayer.canvas.getContext("2d");null!=o&&(this._itemsContext=o),this.__itemsLayer.onDraw=function(){i.doItemsDraw()}}get checkItems(){return this._checkItems}get checkBoxArea(){return this._checkBoxArea}get itemsContext(){return this._itemsContext}get listItemResource(){return this._listItemResource}set listItemResource(t){this._listItemResource!=t&&(this._listItemResource=t,t.length>0&&this.doChangeListItemResource())}get itemsLayer(){return this.__itemsLayer}get isDraw(){return this._isDraw}set isDraw(t){this._isDraw=t,t&&this.doItemsDraw()}get itemIndex(){return this._itemIndex}set itemIndex(t){let e=t;e<-1&&(e=-1),this._itemIndex!=e&&(this._itemIndex=e,this.doChangeItemIndex())}get useCheckBox(){return this._useCheckBox}set useCheckBox(t){this._useCheckBox!=t&&(this._useCheckBox=t,this.isDraw&&this.__itemsLayer.draw())}doToData(t){super.doToData(t),CDataClass.putData(t,"listItemResource",this.listItemResource,[],!0),CDataClass.putData(t,"useCheckBox",this.useCheckBox,!1),CDataClass.putData(t,"checkBoxArea",this.checkBoxArea.toData(),{},!0)}doFromData(t){super.doFromData(t),this.listItemResource=CDataClass.getData(t,"listItemResource",[],!0),this.useCheckBox=CDataClass.getData(t,"useCheckBox",!1),this.checkBoxArea.fromData(CDataClass.getData(t,"checkBoxArea",{},!0))}doBackgroundPointerDown(t,e){let i=this.yToIndex(this.scrollBox.scrollTop+t.offsetY);i.isMargin||i.index>=this.length?this.__downIdx=-1:this.__downIdx=i.index,super.doBackgroundPointerDown(t,e)}doBackgroundPointerMove(t,e){let i=this.yToIndex(this.scrollBox.scrollTop+t.offsetY);i.isMargin?this.__overIdx=-1:this.__overIdx=i.index,this.isDraw&&this.__itemsLayer.draw(),super.doBackgroundPointerMove(t,e)}doBackgroundPointerUp(t,e){let i=this.yToIndex(this.scrollBox.scrollTop+t.offsetY),o=-1;if(o=i.isMargin||i.index>=this.length?-1:i.index,this.__downIdx==o&&(this.itemIndex=o,-1!=o)){if(this.useCheckBox){this.getItemPosition(i.index).offset(0,-this.scrollBox.scrollTop);let e=this.doCheckItem(i.index,t);e.result&&(this.checkItems.has(e.value)?this.checkItems.delete(e.value):this.checkItems.add(e.value))}this.doSelectItem(i.index,t),this.doItemClick(o)}super.doBackgroundPointerUp(t,e)}doBackgroundPointerOut(t,e){this.__overIdx=-1,this.isDraw&&this.__itemsLayer.draw(),super.doBackgroundPointerOut(t,e)}doAddSelectItems(t){this._selecteItems.add(t),this.doChangeSelectItems()}doDeleteSelectItems(t){this._selecteItems.has(t)&&(this._selecteItems.delete(t),this.doChangeSelectItems())}doCheckItem(t,e){return{result:!1,value:void 0}}doSelectItem(t,e){}doSelectAll(){for(let t=0;t<this.length;t++)this._selecteItems.add(t);this.doChangeSelectItems()}doChangeSelectItems(){this.isDraw&&this.__itemsLayer.draw()}doItemClick(t){null!=this.onItemClick&&this.onItemClick(this,t),CTime.now-this.__preItemClick.time<this.repeatClickTime&&t==this.__preItemClick.index&&this.doItemDblClick(t),this.__preItemClick={time:(new Date).getTime(),index:t}}doItemDblClick(t){null!=this.onItemDblClick&&this.onItemDblClick(this,t)}doResource(){super.doResource();let t=this;this.__itemsLayer=this.scrollBox.layers.addLayer(),CSystem.elementBrintToFront(this.__itemsLayer.canvas);let e=this.__itemsLayer.canvas.getContext("2d");null!=e&&(this._itemsContext=e),this.__itemsLayer.onDraw=function(){t.doItemsDraw()}}doChangeItemIndex(){super.doChangeItemIndex(),this.__itemsLayer.draw()}doChangeItemInfo(){super.doChangeItemInfo(),this.__itemsLayer.draw()}doScroll(){super.doScroll(),this.__itemsLayer.draw()}doChangeListItemResource(){this.__listItemData=[];for(let t=0;t<this._listItemResource.length;t++){let e=CSystem.resources.get(this._listItemResource[t]);if(null!=e){let t=new CCanvasItems;t.fromData(e),this.__listItemData.push(t)}}this.isDraw&&this.__itemsLayer.draw()}doItemsDraw(){if(null!=this._itemsContext&&this._isDraw){let t=this.getScrollShowPositions();this._itemsContext.clearRect(0,0,this.__itemsLayer.canvas.width,this.__itemsLayer.canvas.height);for(let e=0;e<t.length;e++){t[e].position.offset(0,-this.scrollBox.scrollTop);let i=t[e].index%this.__listItemData.length,o=this.__listItemData[i];if(null!=this.onBeforeItemDraw){let i={resourceOrItems:""};if(this.onBeforeItemDraw(this,this._itemsContext,t[e].index,t[e].position,o,i),""!=i.resourceOrItems)if("string"==typeof i.resourceOrItems){let t=CSystem.resources.get(i.resourceOrItems),e=new CCanvasItems;e.fromData(t),o=e}else o=i.resourceOrItems}this.doItemDraw(this._itemsContext,t[e].index,t[e].position,o)}}}doItemDraw(t,e,i,o){null!=this.onItemDraw&&this.onItemDraw(this,t,e,i,o)}doKeyDown(t){this.useKeyDown&&("ArrowUp"==t.key&&this.itemIndex>0&&(this.itemIndex--,t.shiftKey&&this.multiSelect||this._selecteItems.clear(),this.doAddSelectItems(this.itemIndex),this.getItemPosition(this.itemIndex).top<this.scrollTop&&this.scrollToIndex(this.itemIndex)),"ArrowDown"==t.key&&this.itemIndex<this.getLength()-1&&(this.itemIndex++,t.shiftKey&&this.multiSelect||this._selecteItems.clear(),this.doAddSelectItems(this.itemIndex),this.getItemPosition(this.itemIndex).top>this.scrollTop+this.scrollBox.contentViewHeight-1&&this.scrollToIndexBottom(this.itemIndex)),"PageUp"==t.key&&(this.scrollTop-=this.scrollBox.contentViewHeight),"PageDown"==t.key&&(this.scrollTop+=this.scrollBox.contentViewHeight),"End"==t.key&&this.scrollToBottom(),"Home"==t.key&&this.scrollToTop(),t.ctrlKey&&"A"==t.key.toUpperCase()&&this.selectAll(),t.ctrlKey||"Enter"!=t.key&&" "!=t.key||-1!=this.itemIndex&&this.doItemClick(this.itemIndex)),null!=this.onKeyDown&&this.onKeyDown(this,t)}selectAll(){this.doSelectAll()}itemsDraw(){this.isDraw&&this.__itemsLayer.draw()}}class CCustomListBox extends CCustomCanvasListBox{constructor(t,e){super(t,e),this._items=new CList,this.objects=new Array;let i=this;this.items.onChange=function(){i.doSetScrollContent(),i.isDraw&&i.__itemsLayer.draw()}}get items(){return this._items}get selectItems(){let t=new Array,e=this;return this._selecteItems.forEach(function(i){t.push(e._items.get(i))}),t}getLength(){return this._items.length}doRemove(){this.objects=[],super.doRemove()}doCheckItem(t,e){if(this.useCheckBox){let i=this.getItemPosition(t);if(i.offset(0,-this.scrollBox.scrollTop),e.offsetX>=i.left+this.checkBoxArea.left&&e.offsetX<=i.left+this.checkBoxArea.right&&e.offsetY>=i.top+this.checkBoxArea.top&&e.offsetY<=i.top+this.checkBoxArea.top+this.checkBoxArea.height)return{result:!0,value:t}}return{result:!1,value:void 0}}doSelectItem(t,e){this.multiSelect&&e.ctrlKey?this._selecteItems.has(t)?this.doDeleteSelectItems(t):this.doAddSelectItems(t):(this._selecteItems.clear(),this.doAddSelectItems(t))}doItemDraw(t,e,i,o){if(null!=CSystem.bufferingContext){let s=o.getItem("over");for(let t=0;t<s.length;t++)s[t].visible=e==this.__overIdx;s=o.getItem("select");for(let t=0;t<s.length;t++)s[t].visible=this._selecteItems.has(e);s=o.getItem("itemindex");for(let t=0;t<s.length;t++)s[t].visible=e==this.itemIndex;s=o.getItem("checkBox");for(let t=0;t<s.length;t++)s[t].visible=this.useCheckBox;s=o.getItem("check");for(let t=0;t<s.length;t++)s[t].visible=this.checkItems.has(e)&&this.useCheckBox;o.draw(t,i,this.__offset,CSystem.bufferingContext,1,1),super.doItemDraw(t,e,i,o)}}checkAll(){if(this.useCheckBox){for(let t=0;t<this.length;t++)this.checkItems.add(t);this.isDraw&&this.__itemsLayer.draw()}}}class CListBox extends CCustomListBox{doItemDraw(t,e,i,o){let s=o.getItem("text");for(let t=0;t<s.length;t++)s[t].text=this._items.get(e);super.doItemDraw(t,e,i,o)}doKeyDown(t){if(this.useKeyDown&&t.ctrlKey&&"C"==t.key.toUpperCase()){let t="";for(let e=0;e<this.items.length;e++)0!=e&&(t+="\n"),t+=this.items.get(e);CSystem.setClipborad(t)}super.doKeyDown(t)}}class CObjectListBox extends CCustomListBox{doItemDraw(t,e,i,o){let s=this._items.get(e),n=Object.keys(s);for(let t=0;t<n.length;t++){let e=o.getItem(n[t]);for(let i=0;i<e.length;i++)"string"==typeof s[n[t]]?e[i].text=s[n[t]]:e[i].text=s[n[t]]+""}super.doItemDraw(t,e,i,o)}}class CCustomTreeListBox extends CCustomCanvasListBox{constructor(t,e){super(t,e),this.__items=new Array,this._items=new CTreeData,this._stateArea=new CRect(0,0,20,20),this._levelLength=20;let i=this;this._items.onChange=function(){i.__items=i.items.getExpandedItems(),i.doSetScrollContent(),i.itemsDraw()}}get items(){return this._items}get selectItems(){let t=new Array;return this._selecteItems.forEach(function(e){t.push(e)}),t}get stateArea(){return this._stateArea}get levelLength(){return this._levelLength}set levelLength(t){this._levelLength=t,t&&this.itemsDraw()}getLength(){return this.__items.length}doToData(t){super.doToData(t),CDataClass.putData(t,"stateArea",this.stateArea.toData(),{},!0),CDataClass.putData(t,"levelLength",this.levelLength,20)}doFromData(t){super.doFromData(t),this.stateArea.fromData(CDataClass.getData(t,"stateArea",{},!0)),this.levelLength=CDataClass.getData(t,"levelLength",20)}doBackgroundPointerUp(t,e){let i=this.yToIndex(this.scrollBox.scrollTop+t.offsetY),o=-1;if(o=i.isMargin||i.index>=this.length?-1:i.index,this.__downIdx==o&&(this.itemIndex=o,-1!=o)){if(this.doStateItem(i.index,t),this.useCheckBox){this.getItemPosition(i.index).offset(0,-this.scrollBox.scrollTop);let e=this.doCheckItem(i.index,t);e.result&&(this.checkItems.has(e.value)?this.checkItems.delete(e.value):this.checkItems.add(e.value))}this.doSelectItem(i.index,t),this.doItemClick(o)}null!=this.onBackgroundPointerUp&&this.onBackgroundPointerUp(this,t,e)}doStateItem(t,e){let i=this.getItemPosition(t);i.offset(this.__items[t].level*this._levelLength,-this.scrollBox.scrollTop),e.offsetX>=i.left+this.stateArea.left&&e.offsetX<=i.left+this.stateArea.right&&e.offsetY>=i.top+this.stateArea.top&&e.offsetY<=i.top+this.stateArea.bottom&&(this.__items[t].item.state==ETreeItemState.COLLAPSE?this.__items[t].item.state=ETreeItemState.EXPAND:this.__items[t].item.state=ETreeItemState.COLLAPSE)}doCheckItem(t,e){let i=this.getItemPosition(t);return i.offset(this.__items[t].level*this._levelLength,-this.scrollBox.scrollTop),this.useCheckBox&&e.offsetX>=i.left+this.checkBoxArea.left&&e.offsetX<=i.left+this.checkBoxArea.right&&e.offsetY>=i.top+this.checkBoxArea.top&&e.offsetY<=i.top+this.checkBoxArea.top+this.checkBoxArea.height?(null!=this.onCheckItem&&this.onCheckItem(this,this.__items[t].item),{result:!0,value:this.__items[t].item}):{result:!1,value:void 0}}doSelectItem(t,e){this.multiSelect&&e.ctrlKey?this._selecteItems.has(this.__items[t].item)?this.doDeleteSelectItems(this.__items[t].item):this.doAddSelectItems(this.__items[t].item):(this._selecteItems.clear(),this.doAddSelectItems(this.__items[t].item)),null!=this.onSelectItem&&this.onSelectItem(this)}doItemDraw(t,e,i,o){if(null!=CSystem.bufferingContext){let s=o.getItem("over");for(let t=0;t<s.length;t++)s[t].visible=e==this.__overIdx;s=o.getItem("select");for(let t=0;t<s.length;t++)s[t].visible=this._selecteItems.has(this.__items[e].item);s=o.getItem("itemindex");for(let t=0;t<s.length;t++)s[t].visible=e==this.itemIndex;s=o.getItem("checkBox");for(let t=0;t<s.length;t++)s[t].visible=this.useCheckBox;s=o.getItem("empty");for(let t=0;t<s.length;t++)s[t].visible="empty"==this.__items[e].item.getState();s=o.getItem("collapse");for(let t=0;t<s.length;t++)s[t].visible="empty"!=this.__items[e].item.getState()&&this.__items[e].item.state==ETreeItemState.COLLAPSE;s=o.getItem("expand");for(let t=0;t<s.length;t++)s[t].visible="empty"!=this.__items[e].item.getState()&&this.__items[e].item.state==ETreeItemState.EXPAND;s=o.getItem("check");for(let t=0;t<s.length;t++)s[t].visible=this.checkItems.has(this.__items[e].item)&&this.useCheckBox;i.left+=this.__items[e].level*this._levelLength,o.draw(t,i,this.__offset,CSystem.bufferingContext,1,1),super.doItemDraw(t,e,i,o)}}selectItem(t){this.multiSelect?this.doAddSelectItems(t):(this._selecteItems.clear(),this.doAddSelectItems(t)),null!=this.onSelectItem&&this.onSelectItem(this)}clear(){this.itemIndex=-1,this._selecteItems.clear(),this.checkItems.clear(),this.items.clear()}}class CTreeListBox extends CCustomTreeListBox{doItemDraw(t,e,i,o){let s=o.getItem("text");for(let t=0;t<s.length;t++)s[t].text=this.__items[e].item.value.asString;super.doItemDraw(t,e,i,o)}}class CObjectTreeListBox extends CCustomTreeListBox{doItemDraw(t,e,i,o){let s=this.__items[e].item.value.asObject,n=Object.keys(s);for(let t=0;t<n.length;t++){let e=o.getItem(n[t]);for(let i=0;i<e.length;i++)"string"==typeof s[n[t]]?e[i].text=s[n[t]]:e[i].text=s[n[t]]+""}super.doItemDraw(t,e,i,o)}}class CListViewItem extends CButton{constructor(t,e){super(t,e),this.orderControl=new CPanel(this);let i,o=this;o.orderControl.visible=!1,o.orderControl.position.align=EPositionAlign.PARENT_SIZE,o.orderControl.usePointerCapture=!0,o.orderControl.onResource=function(){o.orderControl.visible=!1,o.orderControl.position.align=EPositionAlign.PARENT_SIZE,o.orderControl.usePointerCapture=!0};let s=this.position.top,n=-1;this.orderControl.onThisPointerDown=function(t,e){i=e,s=o.position.top,o.bringToFront(),n=o.index,o.opacity=.5},this.orderControl.onThisPointerMove=function(t,e){if(null!=i){let t=s+(e.pageY-i.pageY);if(o.position.top=t,n!=o.index){let t,e=o.listView.getItemFromIndex(o.index);for(let i=0;i<e.length;i++)e[i]!=o&&(t=e[i]);if(null!=t){let e=o.listView.getItemPosition(n),i=t.position.top,s=e.top-i;CAnimation.graphAnimate(100,["acc_head_10000.graph"],function(e,o,n,a,r){t.position.top=i+s*r})}n=o.index}}},this.orderControl.onThisPointerUp=function(t,e){i=void 0;let s=o.listView.getItemPosition(o.index),n=o.position.top,a=s.top-n;CAnimation.graphAnimate(100,["acc_head_10000.graph"],function(t,e,i,s,r){o.position.top=n+a*r}),o.listView.resetOrder(o),o.opacity=1}}get index(){let t=this.listView.yToIndex(this.position.top).index;return t<0&&(t=0),t>this.listView.listItems.length-1&&(t=this.listView.listItems.length-1),t}doToData(t){super.doToData(t),CDataClass.putData(t,"orderControl",this.orderControl.toData(),{},!0)}doFromData(t){super.doFromData(t),this.orderControl.fromData(CDataClass.getData(t,"orderControl",{},!0))}}class CCustomListView extends CCustomListControl{constructor(t,e){super(t,e),this._listItems=new CList,this._selectItems=new Set,this.listItemResource="";let i=this;this.scrollBox.content.onChangeSize=function(){for(let t=0;t<i.listItems.length;t++)i.setItemPosition(t,i.listItems.get(t))}}get selectedItems(){let t=new Array;return this._selectItems.forEach(function(e){t.push(e)}),t}get selectedItem(){let t=this.selectedItems;if(t.length>0)return t[0]}get listItems(){return this._listItems}getLength(){return this._listItems.length}setAllItemPosition(){for(let t=0;t<this.listItems.length;t++)this.setItemPosition(t,this.listItems.get(t))}doSetListItem(t){null!=this.onSetListItem&&this.onSetListItem(this,t)}doItemClick(t){this.multiSelect?t.selected=!t.selected:t.selected=!0,this.doChangeItemSelect(t),null!=this.onListItemClick&&this.onListItemClick(this,t)}doAddItem(){let t=CControl.controlFromResource(this.listItemResource);t.listView=this,this._listItems.add(t),this.doSetScrollContent(),this.setItemPosition(this._listItems.length-1,t),t.parent=this.scrollBox.content;let e=this;return t.onClick=function(){e.doItemClick(t)},t}doInsertItem(t){let e=CControl.controlFromResource(this.listItemResource);this.doSetScrollContent();for(let e=t;e<this._listItems.length;e++)this.setItemPosition(e+1,this._listItems.get(e));e.listView=this,this._listItems.insert(t,e),this.setItemPosition(t,e),e.parent=this.scrollBox.content;let i=this;return e.onClick=function(){i.doItemClick(e)},e}doDeleteItem(t){if(!(t<0||t>=this.length)){this._selectItems.delete(this._listItems.get(t)),this._listItems.get(t).remove(),this._listItems.delete(t);for(let e=t;e<this._listItems.length;e++)this.setItemPosition(e,this._listItems.get(e));this.doSetScrollContent()}}doClear(){for(let t=0;t<this._listItems.length;t++)this._listItems.get(t).remove();this._listItems.clear(),this._selectItems.clear(),this.doSetScrollContent()}doChangeMultiSelect(){super.doChangeMultiSelect()}doChangeItemSelect(t){t.selected?(this.multiSelect||(this._selectItems.forEach(function(e){e!=t&&(e.selected=!1)}),this._selectItems.clear()),this._selectItems.add(t)):this.multiSelect?this._selectItems.delete(t):(this._selectItems.forEach(function(e){e!=t&&(e.selected=!1)}),this._selectItems.clear()),null!=this.onChangeItemSelect&&this.onChangeItemSelect(this,t)}doResetOrder(t){this.listItems.sort(function(t,e){let i=0;return t.index<e.index&&(i=-1),t.index>e.index&&(i=1),i}),null!=this.onResetOrder&&this.onResetOrder(this,t)}setItemPosition(t,e){let i=this.getItemPosition(t);e.position.left=i.left,e.position.top=i.top,e.position.width=i.width,e.position.height=i.height}addItem(){return this.doAddItem()}insertItem(t){return this.doInsertItem(t)}deleteItem(t){this.doDeleteItem(t)}clear(){this.doClear()}getShowItems(){let t=new Array,e=this.getScrollShowPositions();for(let i=0;i<e.length;i++)t.push(this.listItems.get(e[i].index));return t}getItemFromIndex(t){let e=new Array;for(let i=0;i<this.listItems.length;i++)this.listItems.get(i).index==t&&e.push(this.listItems.get(i));return e}resetOrder(t){this.doResetOrder(t)}showOrderControl(){for(let t=0;t<this.listItems.length;t++)this.listItems.get(t).orderControl.bringToFront(),this.listItems.get(t).orderControl.visible=!0}hideOrderControl(){for(let t=0;t<this.listItems.length;t++)this.listItems.get(t).orderControl.visible=!1}}class CListView extends CCustomListView{constructor(t,e){super(t,e)}}class CCustomPickupButton extends CButton{get pickupClientControl(){return this._pickupClientControl}set pickupClientControl(t){this._pickupClientControl=t}doBeforePickupShow(t){super.doBeforePickupShow(t),null!=this._pickupClientControl&&(this._pickupClientControl.parent=t,this._pickupClientControl.position.align=EPositionAlign.CLIENT)}doBeforePickupRemove(t){null!=this._pickupClientControl&&(this._pickupClientControl.parent=void 0),super.doBeforePickupRemove(t)}}class CComboBox extends CButton{constructor(t,e){super(t,e),this._itemIndex=-1,this._list=new CListBox,this._selectText="",this._listBoxResource="",this._listItemResource=[],this._listScrollbarResource="";let i=this;this.listBox.onItemClick=function(){i.doPointerOut(new PointerEvent("")),i.itemIndex=i.listBox.itemIndex,i.listBox.parent.hide()}}get itemIndex(){return this._itemIndex}set itemIndex(t){let e=t;e<-1&&(e=-1),e>this._list.length-1&&(e=this._list.length-1),this._itemIndex!=e&&(this._itemIndex=e,this.doChangeItem())}get comboText(){return this.items.get(this.itemIndex)}get selectText(){return this._selectText}set selectText(t){this._selectText=t,-1==this.itemIndex&&(this.text=t)}get listBox(){return this._list}get listBoxResource(){return this._listBoxResource}set listBoxResource(t){this._listBoxResource=t,this._list.resource=t}get listItemResource(){return this._listItemResource}set listItemResource(t){this._listItemResource=t,this._list.listItemResource=t}get listScrollbarResource(){return this._listScrollbarResource}set listScrollbarResource(t){this._listScrollbarResource=t,this._list.scrollbarResource=t}get items(){return this._list.items}doToData(t){super.doToData(t),CDataClass.putData(t,"selectText",this.selectText,""),CDataClass.putData(t,"listBoxResource",this.listBoxResource,""),CDataClass.putData(t,"listItemResource",this.listItemResource,[],!0),CDataClass.putData(t,"listScrollbarResource",this.listScrollbarResource,""),CDataClass.putData(t,"listBox",this.listBox.toData(),{},!0)}doFromData(t){super.doFromData(t),this.selectText=CDataClass.getData(t,"selectText",""),this.listBoxResource=CDataClass.getData(t,"listBoxResource",""),this.listItemResource=CDataClass.getData(t,"listItemResource",[],!0),this.listScrollbarResource=CDataClass.getData(t,"listScrollbarResource",""),this.listBox.fromData(CDataClass.getData(t,"listBox",{},!0))}doBeforePickupShow(t){super.doBeforePickupShow(t),this._list.parent=t,this._list.hasFocus=!0,this._list.position.align=EPositionAlign.CLIENT,this._list.scrollTop=0,this._list.scrollBox.doScroll();let e=t.position.padding.top+t.position.padding.bottom+this._list.position.margins.top+this._list.position.margins.bottom+this._list.rowHeight*this.items.length+this._list.itemMargin*(this.items.length-1);t.position.height>e&&(t.position.height=e)}doBeforePickupRemove(t){this._list.parent=void 0,super.doBeforePickupRemove(t)}doChangeItem(){-1==this.itemIndex?this.text=this.selectText:this.text=this._list.items.get(this._itemIndex),null!=this.onChangeItem&&this.onChangeItem(this)}addProperties(){let t=super.addProperties();return t.push({instance:this.items,propertyName:"items",readOnly:!1,enum:[]}),t}}class CLanguageComboBox extends CComboBox{constructor(t,e){super(t,e),this.__languageCodes=[],this.__languageLocalNames=[],this._languageNames=new CList;let i=this;this._languageNames.onChange=function(){i.doChangeLanguageNames()}}get languageCodes(){let t=new Array;for(let e=0;e<this.__languageCodes.length;e++)t.push(this.__languageCodes[e]);return t}get languageLocalNames(){let t=new Array;for(let e=0;e<this.__languageLocalNames.length;e++)t.push(this.__languageLocalNames[e]);return t}get languageNames(){return this._languageNames}get languageCode(){return-1==this.itemIndex?void 0:this.__languageCodes[this.itemIndex]}set languageCode(t){let e=-1;for(let i=0;i<this.__languageCodes.length;i++)if(this.__languageCodes[i]==t){e=i;break}this.itemIndex=e}doChangeLanguageNames(){this.__languageCodes=[],this.__languageLocalNames=[];for(let t=0;t<this._languageNames.length;t++){let e=CLanguage.getLanguageFromCountry(this._languageNames.get(t));null!=e&&(this.__languageCodes.push(e.code),this.__languageLocalNames.push(e.localName))}this.items.clear();for(let t=0;t<this.__languageLocalNames.length;t++)this.items.add(this.__languageLocalNames[t]);this.languageCode=CLanguage.localCode}}class CSplitter extends CPanel{constructor(t,e){super(t,e),this.__downValue=0,this.usePointerCapture=!0}doThisPointerDown(t,e){super.doThisPointerDown(t,e),1==this.pressedThisPoints.length&&(this.__down=t,this.__hcon=this.getHandlingControl(),null!=this.__hcon&&(this.position.align!=EPositionAlign.LEFT&&this.position.align!=EPositionAlign.RIGHT||(this.__downValue=this.__hcon.position.width),this.position.align!=EPositionAlign.TOP&&this.position.align!=EPositionAlign.BOTTOM||(this.__downValue=this.__hcon.position.height)))}doThisPointerMove(t,e){super.doThisPointerMove(t,e),this.isPress&&null!=this.__down&&this.__hcon&&this.pressedThisPoints.length>0&&(this.position.align==EPositionAlign.LEFT&&(this.__hcon.position.width=this.__downValue+(t.pageX-this.__down.pageX)),this.position.align==EPositionAlign.RIGHT&&(this.__hcon.position.width=this.__downValue-(t.pageX-this.__down.pageX)),this.position.align==EPositionAlign.TOP&&(this.__hcon.position.height=this.__downValue+(t.pageY-this.__down.pageY)),this.position.align==EPositionAlign.BOTTOM&&(this.__hcon.position.height=this.__downValue-(t.pageY-this.__down.pageY)))}getHandlingControl(){let t,e=CSystem.getBroControls(this),i=-1;for(let o=e.length-1;o>=0;o--)if(this!=e[o]){if(-1!=i&&this.position.align==e[o].position.align&&e[o].visible){t=e[o];break}}else i=o;return t}}class CCustomUnlimitedScrollBoxControl extends CPanel{constructor(t,e){super(t,e),this.scrollBox=new CUnlimitedScrollBox(this);let i=this;this.scrollBox.position.align=EPositionAlign.CLIENT,this.scrollBox.onSetInnerSize=function(){i.doSetInnerSize()},this.scrollBox.onChangeScrollValue=function(){i.doScrollBoxUpdate(),i.doScroll(i.scrollBox.scrollX,i.scrollBox.scrollY)},this.scrollBox.background.onThisPointerDown=function(t,e,o){i.doBackgoundPointerDown(e,o)},this.scrollBox.background.onThisPointerMove=function(t,e,o){i.doBackgoundPointerMove(e,o)},this.scrollBox.background.onThisPointerUp=function(t,e,o){i.doBackgoundPointerUp(e,o)},this.scrollBox.background.onThisPointerCancel=function(t,e,o){i.doBackgoundPointerCancel(e,o)},this.scrollBox.background.onThisPointerOver=function(t,e,o){i.doBackgoundPointerOver(e,o)},this.scrollBox.background.onThisPointerOut=function(t,e,o){i.doBackgoundPointerOut(e,o)},this.scrollBox.background.onThisPointerEnter=function(t,e,o){i.doBackgoundPointerEnter(e,o)},this.scrollBox.background.onThisPointerLeave=function(t,e,o){i.doBackgoundPointerLeave(e,o)}}get scrollMinX(){return this.scrollBox.scrollMinX}set scrollMinX(t){this.scrollBox.scrollMinX=t}get scrollMaxX(){return this.scrollBox.scrollMaxX}set scrollMaxX(t){this.scrollBox.scrollMaxX=t}get scrollMinY(){return this.scrollBox.scrollMinY}set scrollMinY(t){this.scrollBox.scrollMinY=t}get scrollMaxY(){return this.scrollBox.scrollMaxY}set scrollMaxY(t){this.scrollBox.scrollMaxY=t}get scrollX(){return this.scrollBox.scrollX}set scrollX(t){this.scrollBox.scrollX=t}get scrollY(){return this.scrollBox.scrollY}set scrollY(t){this.scrollBox.scrollY=t}get backgroundArea(){return new CRect(this.scrollBox.background.position.left,this.scrollBox.background.position.top,this.scrollBox.background.position.right,this.scrollBox.background.position.bottom)}doSetInnerSize(){this.doScrollBoxUpdate(),null!=this.onSetInnerSize&&this.onSetInnerSize(this)}doScrollBoxUpdate(){null!=this.onScrollBoxUpdate&&this.onScrollBoxUpdate(this)}doBackgoundPointerDown(t,e){null!=this.onBackgoundPointerDown&&this.onBackgoundPointerDown(this,t,e)}doBackgoundPointerMove(t,e){null!=this.onBackgoundPointerMove&&this.onBackgoundPointerMove(this,t,e)}doBackgoundPointerUp(t,e){null!=this.onBackgoundPointerUp&&this.onBackgoundPointerUp(this,t,e)}doBackgoundPointerCancel(t,e){null!=this.onBackgoundPointerCancel&&this.onBackgoundPointerCancel(this,t,e)}doBackgoundPointerOver(t,e){null!=this.onBackgoundPointerOver&&this.onBackgoundPointerOver(this,t,e)}doBackgoundPointerOut(t,e){null!=this.onBackgoundPointerOut&&this.onBackgoundPointerOut(this,t,e)}doBackgoundPointerEnter(t,e){null!=this.onBackgoundPointerEnter&&this.onBackgoundPointerEnter(this,t,e)}doBackgoundPointerLeave(t,e){null!=this.onBackgoundPointerLeave&&this.onBackgoundPointerLeave(this,t,e)}doScroll(t,e){null!=this.onScroll&&this.onScroll(this,t,e)}}class CCellSelectInfo extends CNotifyChangeKindObject{constructor(){super(...arguments),this._startCell=new CNotifyPoint(0,0),this._stopCell=new CNotifyPoint(0,0)}get startCell(){return this._startCell}get stopCell(){return this._stopCell}doToData(t){super.doToData(t),CDataClass.putData(t,"startCell",this.startCell.toData(),{},!0),CDataClass.putData(t,"stopCell",this.stopCell.toData(),{},!0)}doFromData(t){super.doFromData(t),this.startCell.fromData(CDataClass.getData(t,"startCell",{},!0)),this.stopCell.fromData(CDataClass.getData(t,"stopCell",{},!0))}isIn(t){let e=CCalc.minMaxPoint(this._startCell.toPoint(),this._stopCell.toPoint());return t.x>=e.min.x&&t.x<=e.max.x&&t.y>=e.min.y&&t.y<=e.max.y}}class CCellSelectInfoList extends CList{doToData(t){super.doToData(t);for(let e=0;e<this.length;e++)t.push(this.get(e).toData())}doFromData(t){super.doFromData(t),this.clear();for(let e=0;e<t.length;e++){let i=new CCellSelectInfo;i.fromData(t[e]),this.add(i)}}addSelectInfo(t,e,i,o){let s=new CCellSelectInfo;return s.startCell.x=t,s.startCell.y=e,s.stopCell.x=i,s.stopCell.y=o,this.add(s),s}}class CGridInfo extends CNotifyChangeKindObject{constructor(){super(),this._useHeader=!0,this._headerCount=1,this._headerRowHeight=20,this.mergeHeaderCell=new CCellSelectInfoList,this._useIndicator=!0,this._indicatorWidth=50,this.fixLeft=new CNumberList,this.fixTop=new CNumberList,this.fixRight=new CNumberList,this.fixBottom=new CNumberList,this._defaultColumnWidth=100,this._defaultRowHeight=20,this._cellMargin=0,this.diffColumnSize=new CNNMap,this.diffRowSize=new CNNMap,this.mergeCell=new CCellSelectInfoList,this._useFitWidth=!1,this._columnCount=10,this._rowCount=0,this.useResizeColumn=!1,this.useResizeRow=!1,this.resizeGripLength=5;let t=this;this.mergeHeaderCell.onChange=function(){t.doChange(CGridInfo.CON_CHANGE_MERGE_HEADER_CELL)},this.fixLeft.onChange=function(){t.doChange(CGridInfo.CON_CHANGE_FIX_COUNT)},this.fixTop.onChange=function(){t.doChange(CGridInfo.CON_CHANGE_FIX_COUNT)},this.fixRight.onChange=function(){t.doChange(CGridInfo.CON_CHANGE_FIX_COUNT)},this.fixBottom.onChange=function(){t.doChange(CGridInfo.CON_CHANGE_FIX_COUNT)},this.diffColumnSize.onChange=function(){t.doChange(CGridInfo.CON_CHANGE_DIFF_COLUMN_SIZE)},this.diffRowSize.onChange=function(){t.doChange(CGridInfo.CON_CHANGE_DIFF_ROW_SIZE)},this.mergeCell.onChange=function(){t.doChange(CGridInfo.CON_CHANGE_MERGE_CELL)}}static get CON_CHANGE_USE_HEADER(){return"useHeader"}static get CON_CHANGE_HEADER_COUNT(){return"headerCount"}static get CON_CHANGE_HEADER_ROW_HEIGHT(){return"headerRowHeight"}static get CON_CHANGE_MERGE_HEADER_CELL(){return"mergeHeaderCell"}static get CON_CHANGE_USE_INDICATOR(){return"useIndicator"}static get CON_CHANGE_INDICATOR_WIDTH(){return"indicatorWidth"}static get CON_CHANGE_DEFAULT_COLUMN_WIDTH(){return"defaultColumnWidth"}static get CON_CHANGE_DEFAULT_ROW_HEIGHT(){return"defaultRowHeight"}static get CON_CHANGE_CELL_MARGIN(){return"cellMargin"}static get CON_CHANGE_FIX_COUNT(){return"fixCount"}static get CON_CHANGE_DIFF_COLUMN_SIZE(){return"diffColumnSize"}static get CON_CHANGE_DIFF_ROW_SIZE(){return"diffRowSize"}static get CON_CHANGE_MERGE_CELL(){return"mergeCell"}static get CON_CHANGE_USE_FIT_WIDTH(){return"useFitWidth"}static get CON_CHANGE_COLUMN_COUNT(){return"columnCount"}static get CON_CHANGE_ROW_COUNT(){return"rowCount"}get useHeader(){return this._useHeader}set useHeader(t){this._useHeader!=t&&(this._useHeader=t,this.doChange(CGridInfo.CON_CHANGE_USE_HEADER))}get headerCount(){return this._headerCount}set headerCount(t){this._headerCount!=t&&(this._headerCount=t,this.doChange(CGridInfo.CON_CHANGE_HEADER_COUNT))}get headerRowHeight(){return this._headerRowHeight}set headerRowHeight(t){this._headerRowHeight!=t&&(this._headerRowHeight=t,this.doChange(CGridInfo.CON_CHANGE_HEADER_ROW_HEIGHT))}get useIndicator(){return this._useIndicator}set useIndicator(t){this._useIndicator!=t&&(this._useIndicator=t,this.doChange(CGridInfo.CON_CHANGE_USE_INDICATOR))}get indicatorWidth(){return this._indicatorWidth}set indicatorWidth(t){this._indicatorWidth!=t&&(this._indicatorWidth=t,this.doChange(CGridInfo.CON_CHANGE_INDICATOR_WIDTH))}get defaultColumnWidth(){return this._defaultColumnWidth}set defaultColumnWidth(t){this._defaultColumnWidth!=t&&(this._defaultColumnWidth=t,this.doChange(CGridInfo.CON_CHANGE_DEFAULT_COLUMN_WIDTH))}get defaultRowHeight(){return this._defaultRowHeight}set defaultRowHeight(t){this._defaultRowHeight!=t&&(this._defaultRowHeight=t,this.doChange(CGridInfo.CON_CHANGE_DEFAULT_ROW_HEIGHT))}get cellMargin(){return this._cellMargin}set cellMargin(t){this._cellMargin!=t&&(this._cellMargin=t,this.doChange(CGridInfo.CON_CHANGE_CELL_MARGIN))}get useFitWidth(){return this._useFitWidth}set useFitWidth(t){this._useFitWidth!=t&&(this._useFitWidth=t,this.doChange(CGridInfo.CON_CHANGE_USE_FIT_WIDTH))}get columnCount(){return this._columnCount}set columnCount(t){this._columnCount!=t&&(this._columnCount=t,this.doChange(CGridInfo.CON_CHANGE_COLUMN_COUNT))}get rowCount(){return this._rowCount}set rowCount(t){this._rowCount!=t&&(this._rowCount=t,this.doChange(CGridInfo.CON_CHANGE_COLUMN_COUNT))}doToData(t){super.doToData(t),CDataClass.putData(t,"useHeader",this.useHeader,!0),CDataClass.putData(t,"headerCount",this.headerCount,1),CDataClass.putData(t,"headerRowHeight",this.headerRowHeight,20),CDataClass.putData(t,"mergeHeaderCell",this.mergeHeaderCell.toData(),[],!0),CDataClass.putData(t,"fixLeft",this.fixLeft.toData(),[],!0),CDataClass.putData(t,"fixTop",this.fixTop.toData(),[],!0),CDataClass.putData(t,"fixRight",this.fixRight.toData(),[],!0),CDataClass.putData(t,"fixBottom",this.fixBottom.toData(),[],!0),CDataClass.putData(t,"defaultColumnWidth",this.defaultColumnWidth,100),CDataClass.putData(t,"defaultRowHeight",this.defaultRowHeight,20),CDataClass.putData(t,"cellMargin",this.cellMargin,0),CDataClass.putData(t,"diffColumnSize",this.diffColumnSize.toData(),[],!0),CDataClass.putData(t,"diffRowSize",this.diffRowSize.toData(),[],!0),CDataClass.putData(t,"mergeCell",this.mergeCell.toData(),[],!0),CDataClass.putData(t,"useFitWidth",this.useFitWidth,!1),CDataClass.putData(t,"columnCount",this.columnCount,10),CDataClass.putData(t,"rowCount",this.rowCount,0),CDataClass.putData(t,"useResizeColumn",this.useResizeColumn,!1),CDataClass.putData(t,"useResizeRow",this.useResizeRow,!1),CDataClass.putData(t,"resizeGripLength",this.resizeGripLength,5)}doFromData(t){super.doFromData(t),this.useHeader=CDataClass.getData(t,"useHeader",!0),this.headerCount=CDataClass.getData(t,"headerCount",1),this.headerRowHeight=CDataClass.getData(t,"headerRowHeight",20),this.mergeHeaderCell.fromData(CDataClass.getData(t,"mergeHeaderCell",[],!0)),this.fixLeft.fromData(CDataClass.getData(t,"fixLeft",[],!0)),this.fixTop.fromData(CDataClass.getData(t,"fixTop",[],!0)),this.fixRight.fromData(CDataClass.getData(t,"fixRight",[],!0)),this.fixBottom.fromData(CDataClass.getData(t,"fixBottom",[],!0)),this.defaultColumnWidth=CDataClass.getData(t,"defaultColumnWidth",100),this.defaultRowHeight=CDataClass.getData(t,"defaultRowHeight",20),this.cellMargin=CDataClass.getData(t,"cellMargin",0),this.diffColumnSize.fromData(CDataClass.getData(t,"diffColumnSize",[],!0)),this.diffRowSize.fromData(CDataClass.getData(t,"diffRowSize",[],!0)),this.mergeCell.fromData(CDataClass.getData(t,"mergeCell",[],!0)),this.useFitWidth=CDataClass.getData(t,"useFitWidth",!1),this.columnCount=CDataClass.getData(t,"columnCount",10),this.rowCount=CDataClass.getData(t,"rowCount",0),this.useResizeColumn=CDataClass.getData(t,"useResizeColumn",!1),this.useResizeRow=CDataClass.getData(t,"useResizeRow",!1),this.resizeGripLength=CDataClass.getData(t,"resizeGripLength",5)}}!function(t){t[t.NONE=0]="NONE",t[t.HEADER_BUTTON=1]="HEADER_BUTTON",t[t.HEADER_LEFT_FIX=2]="HEADER_LEFT_FIX",t[t.HEADER_CLIENT=3]="HEADER_CLIENT",t[t.HEADER_RIGHT_FIX=4]="HEADER_RIGHT_FIX",t[t.INDICATOR_TOP_FIX=5]="INDICATOR_TOP_FIX",t[t.INDICATOR_CLIENT=6]="INDICATOR_CLIENT",t[t.INDICATOR_BOTTOM_FIX=7]="INDICATOR_BOTTOM_FIX",t[t.TOP_LEFT_FIX=8]="TOP_LEFT_FIX",t[t.TOP_CLIENT_FIX=9]="TOP_CLIENT_FIX",t[t.TOP_RIGHT_FIX=10]="TOP_RIGHT_FIX",t[t.BOTTOM_LEFT_FIX=11]="BOTTOM_LEFT_FIX",t[t.BOTTOM_CLIENT_FIX=12]="BOTTOM_CLIENT_FIX",t[t.BOTTOM_RIGHT_FIX=13]="BOTTOM_RIGHT_FIX",t[t.LEFT_FIX=14]="LEFT_FIX",t[t.RIGHT_FIX=15]="RIGHT_FIX",t[t.CLIENT=16]="CLIENT"}(EPointerAreaKind||(EPointerAreaKind={}));class CCustomGrid extends CCustomUnlimitedScrollBoxControl{constructor(t,e){super(t,e),this.__cellInfo={kind:EPointerAreaKind.NONE,col:-1,row:-1,x:-1,y:-1},this.__downCellInfo={kind:EPointerAreaKind.NONE,col:-1,row:-1,width:-1,height:-1,resizeCol:!1,resizeRow:!1,offsetx:-1,offsety:-1},this.__preClickTime=-1,this.__area=EPointerAreaKind.NONE,this.cellPressed=!1,this.gridInfo=new CGridInfo,this.editable=!1;let i=this;this.gridInfo.onChange=function(t,e){i.doChangeGridInfo(e)},this.doScrollBoxUpdate()}get scrollbarResource(){return this.scrollBox.scrollbarResource}set scrollbarResource(t){this.scrollBox.scrollbarResource=t}get scrollbarLength(){return this.scrollBox.scrollbarLength}set scrollbarLength(t){this.scrollBox.scrollbarLength=t}doToData(t){super.doToData(t),CDataClass.putData(t,"gridInfo",this.gridInfo.toData(),{},!0),CDataClass.putData(t,"editable",this.editable,!1),CDataClass.putData(t,"scrollbarResource",this.scrollbarResource,""),CDataClass.putData(t,"scrollbarLength",this.scrollbarLength,15)}doFromData(t){super.doFromData(t),this.gridInfo.fromData(CDataClass.getData(t,"gridInfo",{},!0)),this.editable=CDataClass.getData(t,"editable",!1),this.scrollbarResource=CDataClass.getData(t,"scrollbarResource",""),this.scrollbarLength=CDataClass.getData(t,"scrollbarLength",15)}doBackgoundPointerDown(t,e){super.doBackgoundPointerDown(t,e),this.setBackgroundArea("down",t,e)}doBackgoundPointerMove(t,e){super.doBackgoundPointerMove(t,e),this.setBackgroundArea("move",t,e)}doBackgoundPointerUp(t,e){super.doBackgoundPointerUp(t,e),this.setBackgroundArea("up",t,e),this.cellPressed=!1}doBackgoundPointerOut(t,e){super.doBackgoundPointerOut(t,e),this.doGridPointerOut(this.__area,t,e),this.__area=EPointerAreaKind.NONE}out(t,e){this.__area==EPointerAreaKind.HEADER_BUTTON&&this.doGridPointerOut(EPointerAreaKind.HEADER_BUTTON,t,e),this.__area==EPointerAreaKind.HEADER_LEFT_FIX&&this.doGridPointerOut(EPointerAreaKind.HEADER_LEFT_FIX,t,e),this.__area==EPointerAreaKind.HEADER_CLIENT&&this.doGridPointerOut(EPointerAreaKind.HEADER_CLIENT,t,e),this.__area==EPointerAreaKind.HEADER_RIGHT_FIX&&this.doGridPointerOut(EPointerAreaKind.HEADER_RIGHT_FIX,t,e),this.__area==EPointerAreaKind.INDICATOR_TOP_FIX&&this.doGridPointerOut(EPointerAreaKind.INDICATOR_TOP_FIX,t,e),this.__area==EPointerAreaKind.INDICATOR_CLIENT&&this.doGridPointerOut(EPointerAreaKind.INDICATOR_CLIENT,t,e),this.__area==EPointerAreaKind.INDICATOR_BOTTOM_FIX&&this.doGridPointerOut(EPointerAreaKind.INDICATOR_BOTTOM_FIX,t,e),this.__area==EPointerAreaKind.LEFT_FIX&&this.doGridPointerOut(EPointerAreaKind.LEFT_FIX,t,e),this.__area==EPointerAreaKind.TOP_LEFT_FIX&&this.doGridPointerOut(EPointerAreaKind.TOP_LEFT_FIX,t,e),this.__area==EPointerAreaKind.TOP_CLIENT_FIX&&this.doGridPointerOut(EPointerAreaKind.TOP_CLIENT_FIX,t,e),this.__area==EPointerAreaKind.TOP_RIGHT_FIX&&this.doGridPointerOut(EPointerAreaKind.TOP_RIGHT_FIX,t,e),this.__area==EPointerAreaKind.RIGHT_FIX&&this.doGridPointerOut(EPointerAreaKind.RIGHT_FIX,t,e),this.__area==EPointerAreaKind.BOTTOM_LEFT_FIX&&this.doGridPointerOut(EPointerAreaKind.BOTTOM_LEFT_FIX,t,e),this.__area==EPointerAreaKind.BOTTOM_CLIENT_FIX&&this.doGridPointerOut(EPointerAreaKind.BOTTOM_CLIENT_FIX,t,e),this.__area==EPointerAreaKind.BOTTOM_RIGHT_FIX&&this.doGridPointerOut(EPointerAreaKind.BOTTOM_RIGHT_FIX,t,e),this.__area==EPointerAreaKind.CLIENT&&this.doGridPointerOut(EPointerAreaKind.CLIENT,t,e),this.__area=EPointerAreaKind.NONE}over(t,e){this.__area==EPointerAreaKind.HEADER_BUTTON&&this.doGridPointerOver(EPointerAreaKind.HEADER_BUTTON,t,e),this.__area==EPointerAreaKind.HEADER_LEFT_FIX&&this.doGridPointerOver(EPointerAreaKind.HEADER_LEFT_FIX,t,e),this.__area==EPointerAreaKind.HEADER_CLIENT&&this.doGridPointerOver(EPointerAreaKind.HEADER_CLIENT,t,e),this.__area==EPointerAreaKind.HEADER_RIGHT_FIX&&this.doGridPointerOver(EPointerAreaKind.HEADER_RIGHT_FIX,t,e),this.__area==EPointerAreaKind.INDICATOR_TOP_FIX&&this.doGridPointerOver(EPointerAreaKind.INDICATOR_TOP_FIX,t,e),this.__area==EPointerAreaKind.INDICATOR_CLIENT&&this.doGridPointerOver(EPointerAreaKind.INDICATOR_CLIENT,t,e),this.__area==EPointerAreaKind.INDICATOR_BOTTOM_FIX&&this.doGridPointerOver(EPointerAreaKind.INDICATOR_BOTTOM_FIX,t,e),this.__area==EPointerAreaKind.LEFT_FIX&&this.doGridPointerOver(EPointerAreaKind.LEFT_FIX,t,e),this.__area==EPointerAreaKind.TOP_LEFT_FIX&&this.doGridPointerOver(EPointerAreaKind.TOP_LEFT_FIX,t,e),this.__area==EPointerAreaKind.TOP_CLIENT_FIX&&this.doGridPointerOver(EPointerAreaKind.TOP_CLIENT_FIX,t,e),this.__area==EPointerAreaKind.TOP_RIGHT_FIX&&this.doGridPointerOver(EPointerAreaKind.TOP_RIGHT_FIX,t,e),this.__area==EPointerAreaKind.RIGHT_FIX&&this.doGridPointerOver(EPointerAreaKind.RIGHT_FIX,t,e),this.__area==EPointerAreaKind.BOTTOM_LEFT_FIX&&this.doGridPointerOver(EPointerAreaKind.BOTTOM_LEFT_FIX,t,e),this.__area==EPointerAreaKind.BOTTOM_CLIENT_FIX&&this.doGridPointerOver(EPointerAreaKind.BOTTOM_CLIENT_FIX,t,e),this.__area==EPointerAreaKind.BOTTOM_RIGHT_FIX&&this.doGridPointerOver(EPointerAreaKind.BOTTOM_RIGHT_FIX,t,e),this.__area==EPointerAreaKind.CLIENT&&this.doGridPointerOver(EPointerAreaKind.CLIENT,t,e)}setBackgroundArea(t,e,i){let o=this.getBackgroundHeaderBounds(),s=this.getBackgroundHeaderButtonBounds(),n=this.getBackgroundIndicatorBounds(),a=this.getBackgroundLeftFixBounds(),r=this.getBackgroundTopFixBounds(),l=this.getBackgroundRightFixBounds(),h=this.getBackgroundBottomFixBounds(),d=this.getBackgroundClientBounds();o.isIn(e.offsetX,e.offsetY)&&(e.offsetX>=a.left&&e.offsetX<a.right?this.__area!=EPointerAreaKind.HEADER_LEFT_FIX&&(this.out(e,i),this.__area=EPointerAreaKind.HEADER_LEFT_FIX,this.over(e,i)):e.offsetX>=l.left&&e.offsetX<l.right?this.__area!=EPointerAreaKind.HEADER_RIGHT_FIX&&(this.out(e,i),this.__area=EPointerAreaKind.HEADER_RIGHT_FIX,this.over(e,i)):this.__area!=EPointerAreaKind.HEADER_CLIENT&&(this.out(e,i),this.__area=EPointerAreaKind.HEADER_CLIENT,this.over(e,i)),this.__area==EPointerAreaKind.HEADER_LEFT_FIX&&this.eventExec(t,this.__area,e.offsetX-s.width,e.offsetY,e,i),this.__area==EPointerAreaKind.HEADER_CLIENT&&this.eventExec(t,this.__area,e.offsetX-a.right,e.offsetY,e,i),this.__area==EPointerAreaKind.HEADER_RIGHT_FIX&&this.eventExec(t,this.__area,e.offsetX-d.right,e.offsetY,e,i)),s.isIn(e.offsetX,e.offsetY)&&(this.__area!=EPointerAreaKind.HEADER_BUTTON&&(this.out(e,i),this.__area=EPointerAreaKind.HEADER_BUTTON,this.over(e,i)),this.eventExec(t,this.__area,e.offsetX,e.offsetY,e,i)),n.isIn(e.offsetX,e.offsetY)&&(e.offsetY>=r.top&&e.offsetY<r.bottom?this.__area!=EPointerAreaKind.INDICATOR_TOP_FIX&&(this.out(e,i),this.__area=EPointerAreaKind.INDICATOR_TOP_FIX,this.over(e,i)):e.offsetY>=h.top&&e.offsetY<h.bottom?this.__area!=EPointerAreaKind.INDICATOR_BOTTOM_FIX&&(this.out(e,i),this.__area=EPointerAreaKind.INDICATOR_BOTTOM_FIX,this.over(e,i)):this.__area!=EPointerAreaKind.INDICATOR_CLIENT&&(this.out(e,i),this.__area=EPointerAreaKind.INDICATOR_CLIENT,this.over(e,i)),this.__area==EPointerAreaKind.INDICATOR_TOP_FIX&&this.eventExec(t,this.__area,e.offsetX,e.offsetY-s.height,e,i),this.__area==EPointerAreaKind.INDICATOR_CLIENT&&this.eventExec(t,this.__area,e.offsetX,e.offsetY-r.bottom,e,i),this.__area==EPointerAreaKind.INDICATOR_BOTTOM_FIX&&this.eventExec(t,this.__area,e.offsetX,e.offsetY-d.bottom,e,i)),a.isIn(e.offsetX,e.offsetY)&&(this.__area!=EPointerAreaKind.LEFT_FIX&&(this.out(e,i),this.__area=EPointerAreaKind.LEFT_FIX,this.over(e,i)),this.eventExec(t,this.__area,e.offsetX-s.width,e.offsetY-r.bottom,e,i)),r.isIn(e.offsetX,e.offsetY)&&(e.offsetX>=a.left&&e.offsetX<a.right?this.__area!=EPointerAreaKind.TOP_LEFT_FIX&&(this.out(e,i),this.__area=EPointerAreaKind.TOP_LEFT_FIX,this.over(e,i)):e.offsetX>=l.left&&e.offsetX<l.right?this.__area!=EPointerAreaKind.TOP_RIGHT_FIX&&(this.out(e,i),this.__area=EPointerAreaKind.TOP_RIGHT_FIX,this.over(e,i)):this.__area!=EPointerAreaKind.TOP_CLIENT_FIX&&(this.out(e,i),this.__area=EPointerAreaKind.TOP_CLIENT_FIX,this.over(e,i)),this.__area==EPointerAreaKind.TOP_LEFT_FIX&&this.eventExec(t,this.__area,e.offsetX-s.width,e.offsetY-o.bottom,e,i),this.__area==EPointerAreaKind.TOP_CLIENT_FIX&&this.eventExec(t,this.__area,e.offsetX-a.right,e.offsetY-o.bottom,e,i),this.__area==EPointerAreaKind.TOP_RIGHT_FIX&&this.eventExec(t,this.__area,e.offsetX-d.right,e.offsetY-o.bottom,e,i)),l.isIn(e.offsetX,e.offsetY)&&(this.__area!=EPointerAreaKind.RIGHT_FIX&&(this.out(e,i),this.__area=EPointerAreaKind.RIGHT_FIX,this.over(e,i)),this.eventExec(t,this.__area,e.offsetX-d.right,e.offsetY-r.bottom,e,i)),h.isIn(e.offsetX,e.offsetY)&&(e.offsetX>=a.left&&e.offsetX<a.right?this.__area!=EPointerAreaKind.BOTTOM_LEFT_FIX&&(this.out(e,i),this.__area=EPointerAreaKind.BOTTOM_LEFT_FIX,this.over(e,i)):e.offsetX>=l.left&&e.offsetX<l.right?this.__area!=EPointerAreaKind.BOTTOM_RIGHT_FIX&&(this.out(e,i),this.__area=EPointerAreaKind.BOTTOM_RIGHT_FIX,this.over(e,i)):this.__area!=EPointerAreaKind.BOTTOM_CLIENT_FIX&&(this.out(e,i),this.__area=EPointerAreaKind.BOTTOM_CLIENT_FIX,this.over(e,i)),this.__area==EPointerAreaKind.BOTTOM_LEFT_FIX&&this.eventExec(t,this.__area,e.offsetX-s.width,e.offsetY-d.bottom,e,i),this.__area==EPointerAreaKind.BOTTOM_CLIENT_FIX&&this.eventExec(t,this.__area,e.offsetX-a.right,e.offsetY-d.bottom,e,i),this.__area==EPointerAreaKind.BOTTOM_RIGHT_FIX&&this.eventExec(t,this.__area,e.offsetX-d.right,e.offsetY-d.bottom,e,i)),d.isIn(e.offsetX,e.offsetY)&&(this.__area!=EPointerAreaKind.CLIENT&&(this.out(e,i),this.__area=EPointerAreaKind.CLIENT,this.over(e,i)),this.eventExec(t,this.__area,e.offsetX-a.right,e.offsetY-r.bottom,e,i))}eventExec(t,e,i,o,s,n){"down"==t&&this.doGridPointerDown(e,i,o,s,n),"move"==t&&this.doGridPointerMove(e,i,o,s,n),"up"==t&&this.doGridPointerUp(e,i,o,s,n)}doGridPointerDown(t,e,i,o,s){this.cellEventExec("down",t,e,i,o,s),null!=this.onGridPointerDown&&this.onGridPointerDown(this,t,e,i,o,s)}doGridPointerMove(t,e,i,o,s){this.cellEventExec("move",t,e,i,o,s),null!=this.onGridPointerMove&&this.onGridPointerMove(this,t,e,i,o,s)}doGridPointerUp(t,e,i,o,s){this.cellEventExec("up",t,e,i,o,s),null!=this.onGridPointerUp&&this.onGridPointerUp(this,t,e,i,o,s)}doGridPointerOver(t,e,i){null!=this.onGridPointerOver&&this.onGridPointerOver(this,t,e,i)}doGridPointerOut(t,e,i){this.__cellInfo.kind==EPointerAreaKind.NONE&&-1==this.__cellInfo.col&&-1==this.__cellInfo.row||this.doChangePointerCell(e,i,this.__cellInfo,{kind:EPointerAreaKind.NONE,col:-1,row:-1,x:-1,y:-1}),this.__cellInfo={kind:EPointerAreaKind.NONE,col:-1,row:-1,x:-1,y:-1},null!=this.onGridPointerOut&&this.onGridPointerOut(this,t,e,i)}cellEventExec(t,e,i,o,s,n){let a=-1,r=-1,l=-1,h=-1,d=!1,u=!1,c=0,g=0;function _(t){let e=t.xToColumn(t.scrollX+i);a=e.index;let o=t.getCellBounds(a,0);l=t.scrollX+i-o.left,d=e.isMargin,c=o.width-t.gridInfo.cellMargin}function C(t){let e=0;for(let o=0;o<t.gridInfo.fixLeft.length;o++){if(e<=i&&i<e+t.gridInfo.fixLeft.get(o)){l=i-e,a=o,c=t.gridInfo.fixLeft.get(o);break}e+=t.gridInfo.fixLeft.get(o)+t.gridInfo.cellMargin}}function p(t){let e=t.gridInfo.cellMargin;for(let o=0;o<t.gridInfo.fixRight.length;o++){if(e<=i&&i<e+t.gridInfo.fixRight.get(o)){l=i-e,a=o,c=t.gridInfo.fixRight.get(o);break}e+=t.gridInfo.fixRight.get(o)+t.gridInfo.cellMargin}}function m(t){let e=t.yToRow(t.scrollY+o);r=e.index;let i=t.getCellBounds(0,r);h=t.scrollY+o-i.top,u=e.isMargin,g=i.height-t.gridInfo.cellMargin}if(e==EPointerAreaKind.HEADER_BUTTON){let t=this.getBackgroundHeaderButtonBounds();i<t.width-this.gridInfo.cellMargin&&o<t.height-this.gridInfo.cellMargin&&(a=0,r=0,c=t.width-this.gridInfo.cellMargin,g=t.height-this.gridInfo.cellMargin,l=i,h=o)}if(e==EPointerAreaKind.HEADER_LEFT_FIX||e==EPointerAreaKind.HEADER_CLIENT||e==EPointerAreaKind.HEADER_RIGHT_FIX){let t=0;for(let e=0;e<this.gridInfo.headerCount;e++){if(t<=o&&o<t+this.gridInfo.headerRowHeight){h=o-t,r=e;break}t+=this.gridInfo.headerRowHeight+this.gridInfo.cellMargin}g=this.gridInfo.headerRowHeight,e==EPointerAreaKind.HEADER_LEFT_FIX&&C(this),e==EPointerAreaKind.HEADER_CLIENT&&_(this),e==EPointerAreaKind.HEADER_RIGHT_FIX&&p(this)}if(e==EPointerAreaKind.INDICATOR_TOP_FIX||e==EPointerAreaKind.INDICATOR_CLIENT||e==EPointerAreaKind.INDICATOR_BOTTOM_FIX){let t=this.getBackgroundIndicatorBounds();if(i<t.width-this.gridInfo.cellMargin&&(a=0,c=t.width-this.gridInfo.cellMargin,l=i),e==EPointerAreaKind.INDICATOR_TOP_FIX){let t=0;for(let e=0;e<this.gridInfo.fixTop.length;e++){if(t<=o&&o<t+this.gridInfo.fixTop.get(e)){h=o-t,r=e,g=this.gridInfo.fixTop.get(e);break}t+=this.gridInfo.fixTop.get(e)+this.gridInfo.cellMargin}}if(e==EPointerAreaKind.INDICATOR_CLIENT&&m(this),e==EPointerAreaKind.INDICATOR_BOTTOM_FIX){let t=this.gridInfo.cellMargin;for(let e=0;e<this.gridInfo.fixBottom.length;e++){if(t<=o&&o<t+this.gridInfo.fixBottom.get(e)){h=o-t,r=e,g=this.gridInfo.fixBottom.get(e);break}t+=this.gridInfo.fixBottom.get(e)+this.gridInfo.cellMargin}}}if(e==EPointerAreaKind.TOP_LEFT_FIX||e==EPointerAreaKind.TOP_CLIENT_FIX||e==EPointerAreaKind.TOP_RIGHT_FIX){let t=0;for(let e=0;e<this.gridInfo.fixTop.length;e++){if(t<=o&&o<t+this.gridInfo.fixTop.get(e)){h=o-t,r=e,g=this.gridInfo.fixTop.get(e);break}t+=this.gridInfo.fixTop.get(e)+this.gridInfo.cellMargin}e==EPointerAreaKind.TOP_LEFT_FIX&&C(this),e==EPointerAreaKind.TOP_CLIENT_FIX&&_(this),e==EPointerAreaKind.TOP_RIGHT_FIX&&p(this)}if(e==EPointerAreaKind.BOTTOM_LEFT_FIX||e==EPointerAreaKind.BOTTOM_CLIENT_FIX||e==EPointerAreaKind.BOTTOM_RIGHT_FIX){let t=this.gridInfo.cellMargin;for(let e=0;e<this.gridInfo.fixBottom.length;e++){if(t<=o&&o<t+this.gridInfo.fixBottom.get(e)){h=o-t,r=e,g=this.gridInfo.fixBottom.get(e);break}t+=this.gridInfo.fixBottom.get(e)+this.gridInfo.cellMargin}e==EPointerAreaKind.BOTTOM_LEFT_FIX&&C(this),e==EPointerAreaKind.BOTTOM_CLIENT_FIX&&_(this),e==EPointerAreaKind.BOTTOM_RIGHT_FIX&&p(this)}e==EPointerAreaKind.LEFT_FIX&&(C(this),m(this)),e==EPointerAreaKind.RIGHT_FIX&&(p(this),m(this)),e==EPointerAreaKind.CLIENT&&(_(this),m(this));let f=!0;e==EPointerAreaKind.CLIENT&&(a>=this.gridInfo.columnCount||r>=this.gridInfo.rowCount)&&(f=!1),e==EPointerAreaKind.HEADER_CLIENT&&a>=this.gridInfo.columnCount&&(f=!1),(e==EPointerAreaKind.BOTTOM_LEFT_FIX||e==EPointerAreaKind.TOP_LEFT_FIX||e==EPointerAreaKind.HEADER_LEFT_FIX||e==EPointerAreaKind.LEFT_FIX)&&a>=this.gridInfo.fixLeft.length&&(f=!1),(e==EPointerAreaKind.BOTTOM_RIGHT_FIX||e==EPointerAreaKind.TOP_RIGHT_FIX||e==EPointerAreaKind.HEADER_RIGHT_FIX||e==EPointerAreaKind.RIGHT_FIX)&&a>=this.gridInfo.fixRight.length&&(f=!1),e==EPointerAreaKind.INDICATOR_CLIENT&&r>=this.gridInfo.rowCount&&(f=!1),-1==a||-1==r||d||u||!f?(this.__cellInfo.kind==EPointerAreaKind.NONE&&-1==this.__cellInfo.col&&-1==this.__cellInfo.row||this.doChangePointerCell(s,n,this.__cellInfo,{kind:EPointerAreaKind.NONE,col:-1,row:-1,x:-1,y:-1}),this.__cellInfo={kind:EPointerAreaKind.NONE,col:-1,row:-1,x:-1,y:-1}):(this.__cellInfo.kind==e&&this.__cellInfo.col==a&&this.__cellInfo.row==r||this.doChangePointerCell(s,n,this.__cellInfo,{kind:e,col:a,row:r,x:l,y:h}),this.__cellInfo={kind:e,col:a,row:r,x:l,y:h},"down"==t&&this.doCellPointerDown(e,a,r,l,h,c,g,s,n),"move"==t&&this.doCellPointerMove(e,a,r,l,h,c,g,s,n),"up"==t&&this.doCellPointerUp(e,a,r,l,h,c,g,s,n))}doChangePointerCell(t,e,i,o){-1!=i.col&&-1!=i.row&&this.doCellPointerOut(i.kind,i.col,i.row,t,e),-1!=o.col&&-1!=o.row&&this.doCellPointerOver(o.kind,o.col,o.row,t,e)}doCellPointerDown(t,e,i,o,s,n,a,r,l){let h=!1,d=!1;h="col-resize"==this.scrollBox.background.cursor,d="row-resize"==this.scrollBox.background.cursor,"nwse-resize"==this.scrollBox.background.cursor&&(h=!0,d=!0),this.__downCellInfo={kind:t,col:e,row:i,width:n,height:a,resizeCol:h,resizeRow:d,offsetx:r.offsetX,offsety:r.offsetY},this.cellPressed=!0,null!=this.onCellPointerDown&&this.onCellPointerDown(this,t,e,i,o,s,n,a,r,l)}doCellPointerMove(t,e,i,o,s,n,a,r,l){if(t!=EPointerAreaKind.HEADER_CLIENT&&t!=EPointerAreaKind.HEADER_LEFT_FIX||!this.gridInfo.useResizeColumn||(o>=n-this.gridInfo.resizeGripLength&&o<n?this.scrollBox.background.cursor="col-resize":this.scrollBox.background.cursor="auto"),t==EPointerAreaKind.HEADER_RIGHT_FIX&&this.gridInfo.useResizeColumn&&(o>=0&&o<this.gridInfo.resizeGripLength?this.scrollBox.background.cursor="col-resize":this.scrollBox.background.cursor="auto"),t==EPointerAreaKind.INDICATOR_CLIENT&&(this.gridInfo.useResizeRow&&this.gridInfo.useResizeColumn&&s>=a-this.gridInfo.resizeGripLength&&s<a&&o>=n-this.gridInfo.resizeGripLength&&o<n?this.scrollBox.background.cursor="nwse-resize":this.gridInfo.useResizeColumn&&o>=n-this.gridInfo.resizeGripLength&&o<n?this.scrollBox.background.cursor="col-resize":this.gridInfo.useResizeRow&&s>=a-this.gridInfo.resizeGripLength&&s<a?this.scrollBox.background.cursor="row-resize":this.scrollBox.background.cursor="auto"),t==EPointerAreaKind.INDICATOR_TOP_FIX&&this.gridInfo.useResizeRow&&(s>=a-this.gridInfo.resizeGripLength&&s<a?this.scrollBox.background.cursor="row-resize":this.scrollBox.background.cursor="auto"),t==EPointerAreaKind.INDICATOR_BOTTOM_FIX&&this.gridInfo.useResizeRow&&(s>=0&&s<this.gridInfo.resizeGripLength?this.scrollBox.background.cursor="row-resize":this.scrollBox.background.cursor="auto"),t==EPointerAreaKind.CLIENT&&this.gridInfo.useResizeRow&&this.gridInfo.useResizeColumn&&(s>=a-this.gridInfo.resizeGripLength&&s<a&&o>=n-this.gridInfo.resizeGripLength&&o<n?this.scrollBox.background.cursor="nwse-resize":this.scrollBox.background.cursor="auto"),this.cellPressed&&this.__downCellInfo.resizeCol&&(this.__downCellInfo.kind!=EPointerAreaKind.HEADER_CLIENT&&this.__downCellInfo.kind!=EPointerAreaKind.CLIENT||this.gridInfo.diffColumnSize.set(this.__downCellInfo.col,this.__downCellInfo.width+(r.offsetX-this.__downCellInfo.offsetx)),this.__downCellInfo.kind==EPointerAreaKind.INDICATOR_CLIENT&&(this.gridInfo.indicatorWidth=this.__downCellInfo.width+(r.offsetX-this.__downCellInfo.offsetx)),this.__downCellInfo.kind==EPointerAreaKind.HEADER_LEFT_FIX&&this.gridInfo.fixLeft.set(this.__downCellInfo.col,this.__downCellInfo.width+(r.offsetX-this.__downCellInfo.offsetx)),this.__downCellInfo.kind==EPointerAreaKind.HEADER_RIGHT_FIX&&this.gridInfo.fixRight.set(this.__downCellInfo.col,this.__downCellInfo.width-(r.offsetX-this.__downCellInfo.offsetx))),this.cellPressed&&this.__downCellInfo.resizeRow&&(this.__downCellInfo.kind!=EPointerAreaKind.INDICATOR_CLIENT&&this.__downCellInfo.kind!=EPointerAreaKind.CLIENT||this.gridInfo.diffRowSize.set(this.__downCellInfo.row,this.__downCellInfo.height+(r.offsetY-this.__downCellInfo.offsety)),this.__downCellInfo.kind==EPointerAreaKind.INDICATOR_TOP_FIX&&this.gridInfo.fixTop.set(this.__downCellInfo.row,this.__downCellInfo.height+(r.offsetY-this.__downCellInfo.offsety)),this.__downCellInfo.kind==EPointerAreaKind.INDICATOR_BOTTOM_FIX&&this.gridInfo.fixBottom.set(this.__downCellInfo.row,this.__downCellInfo.height-(r.offsetY-this.__downCellInfo.offsety))),t==EPointerAreaKind.CLIENT&&this.cellPressed&&this.__downCellInfo.kind==EPointerAreaKind.CLIENT&&this.__downCellInfo.col>=0&&this.__downCellInfo.row>=0){let t=new CCellSelectInfo;t.startCell.x=this.__downCellInfo.col,t.startCell.y=this.__downCellInfo.row,t.stopCell.x=e,t.stopCell.y=i;let o=new CCellSelectInfo;o.startCell.x=CCalc.min(t.startCell.x,t.stopCell.x),o.startCell.y=CCalc.min(t.startCell.y,t.stopCell.y),o.stopCell.x=CCalc.max(t.startCell.x,t.stopCell.x),o.stopCell.y=CCalc.max(t.startCell.y,t.stopCell.y),this.doCellDrag(t,o,r,l)}null!=this.onCellPointerMove&&this.onCellPointerMove(this,t,e,i,o,s,n,a,r,l)}doCellPointerUp(t,e,i,o,s,n,a,r,l){this.__downCellInfo.kind==t&&this.__downCellInfo.col==e&&this.__downCellInfo.row==i&&this.doCellClick(t,e,i,o,s,n,a,r,l),null!=this.onCellPointerUp&&this.onCellPointerUp(this,t,e,i,o,s,n,a,r,l)}doCellPointerOver(t,e,i,o,s){null!=this.onCellPointerOver&&this.onCellPointerOver(this,t,e,i,o,s)}doCellPointerOut(t,e,i,o,s){this.gridInfo.useResizeColumn&&(this.scrollBox.background.cursor="auto"),this.gridInfo.useResizeRow&&(this.scrollBox.background.cursor="auto"),null!=this.onCellPointerOut&&this.onCellPointerOut(this,t,e,i,o,s)}doCellClick(t,e,i,o,s,n,a,r,l){CTime.now-this.__preClickTime<this.repeatClickTime&&this.doCellDblClick(t,e,i,r,l),this.__preClickTime=CTime.now,null!=this.onCellClick&&this.onCellClick(this,t,e,i,o,s,n,a,r,l)}doCellDblClick(t,e,i,o,s){null!=this.onCellDblClick&&this.onCellDblClick(this,t,e,i,o,s)}doCellDrag(t,e,i,o){}doSetContentSize(){this.scrollMinX=0,this.scrollMaxX=this.getContentWidth()-this.getBackgroundClientBounds().width,this.scrollBox.hScrollbar.enabled=this.getContentWidth()>this.getBackgroundClientBounds().width,this.scrollMinY=0,this.scrollMaxY=this.getContentHeight()-this.getBackgroundClientBounds().height,this.scrollBox.vScrollbar.enabled=this.getContentHeight()>this.getBackgroundClientBounds().height,this.scrollBox.useHScrollbar=!this.gridInfo.useFitWidth,null!=this.onSetContentSize&&this.onSetContentSize(this)}doSetInnerSize(){this.doSetContentSize(),super.doSetInnerSize()}doScrollBoxUpdate(){this.doSetBounds(),super.doScrollBoxUpdate()}doChangeGridInfo(t){this.doSetBounds(),this.doSetContentSize()}doSetBounds(){this.doSetHeaderBounds(this.getBackgroundHeaderBounds()),this.doSetIndicatorBounds(this.getBackgroundIndicatorBounds()),this.doSetTopFixBounds(this.getBackgroundTopFixBounds()),this.doSetBottomFixBounds(this.getBackgroundBottomFixBounds()),this.doSetLeftFixBounds(this.getBackgroundLeftFixBounds()),this.doSetRightFixBounds(this.getBackgroundRightFixBounds()),this.doSetClientFixBounds(this.getBackgroundClientBounds())}doSetHeaderBounds(t){null!=this.onSetHeaderBounds&&this.onSetHeaderBounds(this,t)}doSetIndicatorBounds(t){null!=this.onSetIndicatorBounds&&this.onSetIndicatorBounds(this,t)}doSetTopFixBounds(t){null!=this.onSetTopBounds&&this.onSetTopBounds(this,t)}doSetBottomFixBounds(t){null!=this.onSetBottomBounds&&this.onSetBottomBounds(this,t)}doSetLeftFixBounds(t){null!=this.onSetLeftBounds&&this.onSetLeftBounds(this,t)}doSetRightFixBounds(t){null!=this.onSetRightBounds&&this.onSetRightBounds(this,t)}doSetClientFixBounds(t){null!=this.onSetClientBounds&&this.onSetClientBounds(this,t)}doCellsBounds(){if(this.gridInfo.columnCount>0||this.gridInfo.rowCount>0){let t=this.getBackgroundColumns(),e=this.getBackgroundRows();this.gridInfo.rowCount>0&&this.doClientCellsBounds(t,e),this.gridInfo.rowCount>0&&this.doLeftCellsBounds(e),this.gridInfo.rowCount>0&&this.doRightCellsBounds(e),this.doTopCellsBounds(t),this.doBottomCellsBounds(t),this.gridInfo.useHeader&&this.gridInfo.columnCount>0&&this.doHeaderCellsBounds(t),this.gridInfo.useIndicator&&this.gridInfo.rowCount>0&&this.doIndicatorCellsBounds(e),this.doBeforeHeaderButtomCellBounds(this.getBackgroundHeaderButtonBounds());let i=this.getBackgroundHeaderButtonBounds();i.right-=this.gridInfo.cellMargin,i.bottom-=this.gridInfo.cellMargin,this.doHeaderButtonCellBounds(i)}}doBeforeHeaderButtomCellBounds(t){}doHeaderButtonCellBounds(t){}doBeforeHeaderLeftFixCellBounds(t){}doBeforeHeaderCellBounds(t){}doBeforeHeaderRightFixCellBounds(t){}doHeaderLeftFixCellBounds(t,e,i){}doHeaderCellBounds(t,e,i,o){}doHeaderRightFixCellBounds(t,e,i){}doHeaderCellsBounds(t){let e=this,i=this.getBackgroundHeaderBounds(),o=CRect.copyFrom(i);o.right=this.getBackgroundLeftFixBounds().right;let s=CRect.copyFrom(i);s.left=this.getBackgroundRightFixBounds().left;let n=CRect.copyFrom(i);n.left=o.right,n.right=s.left,this.doBeforeHeaderCellBounds(n);for(let i=0;i<t.area.length;i++)for(let o=0;o<this.gridInfo.headerCount;o++){let s=new CPoint(t.startIndex+i,o),r="none";for(let t=0;t<this.gridInfo.mergeHeaderCell.length;t++){let i=!1;function a(t){let o=e.gridInfo.mergeHeaderCell.get(t).startCell,s=e.gridInfo.mergeHeaderCell.get(t).stopCell,a=e.getHeaderCellBounds(o.x,o.y),r=e.getHeaderCellBounds(s.x,s.y);a.offset(-e.scrollX,0),r.offset(-e.scrollX,0),e.doHeaderCellBounds(e.gridInfo.mergeHeaderCell.get(t).startCell.x,e.gridInfo.mergeHeaderCell.get(t).startCell.y,new CRect(n.left+a.left,n.top+a.top,n.left+r.right-e.gridInfo.cellMargin,n.top+r.bottom-e.gridInfo.cellMargin),!0),i=!0}this.gridInfo.mergeHeaderCell.get(t).startCell.equal(s)?(r="first",a(t)):this.gridInfo.mergeHeaderCell.get(t).stopCell.equal(s)?(r="last",i||a(t)):this.gridInfo.mergeHeaderCell.get(t).isIn(s)&&(r="merge")}if("merge"!=r&&"first"!=r&&"last"!=r){let e=n.left-t.left+t.area[i].left,s=n.top+(this.gridInfo.headerRowHeight+this.gridInfo.cellMargin)*o,a=n.left-t.left+t.area[i].right-this.gridInfo.cellMargin,r=s+this.gridInfo.headerRowHeight;this.doHeaderCellBounds(t.startIndex+i,o,new CRect(e,s,a,r),!1)}}let r=0;this.doBeforeHeaderLeftFixCellBounds(o);for(let t=0;t<this.gridInfo.fixLeft.length;t++){let e=o.left+r,i=0,s=o.left+this.gridInfo.fixLeft.get(t)+r,n=i+(this.gridInfo.headerRowHeight+this.gridInfo.cellMargin)*this.gridInfo.headerCount-this.gridInfo.cellMargin;this.doHeaderLeftFixCellBounds(t,0,new CRect(e,i,s,n)),r+=this.gridInfo.fixLeft.get(t)+this.gridInfo.cellMargin}r=0,this.doBeforeHeaderRightFixCellBounds(s);for(let t=0;t<this.gridInfo.fixRight.length;t++){let e=s.left+r+this.gridInfo.cellMargin,i=0,o=s.left+this.gridInfo.fixRight.get(t)+r+this.gridInfo.cellMargin,n=i+(this.gridInfo.headerRowHeight+this.gridInfo.cellMargin)*this.gridInfo.headerCount-this.gridInfo.cellMargin;this.doHeaderRightFixCellBounds(t,0,new CRect(e,i,o,n)),r+=this.gridInfo.fixRight.get(t)+this.gridInfo.cellMargin}}doBeforeIndicatorTopFixCellBounds(t){}doBeforeIndicatorCellBounds(t){}doBeforeIndicatorBottomFixCellBounds(t){}doIndicatorTopFixCellBounds(t,e){}doIndicatorCellBounds(t,e){}doIndicatorBottomFixCellBounds(t,e){}doIndicatorCellsBounds(t){let e=this.getBackgroundIndicatorBounds(),i=CRect.copyFrom(e);i.bottom=this.getBackgroundTopFixBounds().bottom;let o=CRect.copyFrom(e);o.top=this.getBackgroundBottomFixBounds().top;let s=CRect.copyFrom(e);s.top=i.bottom,s.bottom=o.top,this.doBeforeIndicatorCellBounds(s);for(let e=0;e<t.area.length;e++){let i=s.left,o=s.top-t.top+t.area[e].top,n=s.right-this.gridInfo.cellMargin,a=s.top-t.top+t.area[e].bottom-this.gridInfo.cellMargin;this.doIndicatorCellBounds(t.startIndex+e,new CRect(i,o,n,a))}let n=0;this.doBeforeIndicatorTopFixCellBounds(i);for(let t=0;t<this.gridInfo.fixTop.length;t++){let e=i.left,o=i.top+n,s=i.right-this.gridInfo.cellMargin,a=i.top+n+this.gridInfo.fixTop.get(t);this.doIndicatorTopFixCellBounds(t,new CRect(e,o,s,a)),n+=this.gridInfo.fixTop.get(t)+this.gridInfo.cellMargin}n=0,this.doBeforeIndicatorBottomFixCellBounds(o);for(let t=0;t<this.gridInfo.fixBottom.length;t++){let e=o.left,i=o.top+n+this.gridInfo.cellMargin,s=o.right-this.gridInfo.cellMargin,a=o.top+n+this.gridInfo.fixBottom.get(t)+this.gridInfo.cellMargin;this.doIndicatorBottomFixCellBounds(t,new CRect(e,i,s,a)),n+=this.gridInfo.fixBottom.get(t)+this.gridInfo.cellMargin}}doBeforeTopLeftFixCellBounds(t){}doBeforeTopCellBounds(t){}doBeforeTopRightFixCellBounds(t){}doTopLeftFixCellBounds(t,e,i){}doTopCellBounds(t,e,i,o){}doTopRightFixCellBounds(t,e,i){}doTopCellsBounds(t){let e=this.getBackgroundTopFixBounds(),i=CRect.copyFrom(e);i.right=this.getBackgroundLeftFixBounds().right;let o=CRect.copyFrom(e);o.left=this.getBackgroundRightFixBounds().left;let s=CRect.copyFrom(e);s.left=i.right,s.right=o.left,this.doBeforeTopCellBounds(s);for(let e=0;e<t.area.length;e++){let i=0;for(let o=0;o<this.gridInfo.fixTop.length;o++){let n=s.left-t.left+t.area[e].left,a=s.top+i,r=s.left-t.left+t.area[e].right-this.gridInfo.cellMargin,l=s.top+i+this.gridInfo.fixTop.get(o);this.doTopCellBounds(t.startIndex+e,o,new CRect(n,a,r,l),!1),i+=this.gridInfo.fixTop.get(o)+this.gridInfo.cellMargin}}let n=0;this.doBeforeTopLeftFixCellBounds(i);for(let t=0;t<this.gridInfo.fixLeft.length;t++){let e=0;for(let o=0;o<this.gridInfo.fixTop.length;o++){let s=i.left+n,a=i.top+e,r=i.left+this.gridInfo.fixLeft.get(t)+n,l=i.top+e+this.gridInfo.fixTop.get(o);this.doTopLeftFixCellBounds(t,o,new CRect(s,a,r,l)),e+=this.gridInfo.fixTop.get(o)+this.gridInfo.cellMargin}n+=this.gridInfo.fixLeft.get(t)+this.gridInfo.cellMargin}n=0,this.doBeforeTopRightFixCellBounds(o);for(let t=0;t<this.gridInfo.fixRight.length;t++){let e=0;for(let i=0;i<this.gridInfo.fixTop.length;i++){let s=o.left+n+this.gridInfo.cellMargin,a=o.top+e,r=o.left+this.gridInfo.fixRight.get(t)+n+this.gridInfo.cellMargin,l=o.top+this.gridInfo.fixTop.get(i)+e;this.doTopRightFixCellBounds(t,i,new CRect(s,a,r,l)),e+=this.gridInfo.fixTop.get(i)+this.gridInfo.cellMargin}n+=this.gridInfo.fixRight.get(t)+this.gridInfo.cellMargin}}doBeforeBottomLeftFixCellBounds(t){}doBeforeBottomCellBounds(t){}doBeforeBottomRightFixCellBounds(t){}doBottomLeftFixCellBounds(t,e,i){}doBottomCellBounds(t,e,i,o){}doBottomRightFixCellBounds(t,e,i){}doBottomCellsBounds(t){let e=this.getBackgroundBottomFixBounds(),i=CRect.copyFrom(e);i.right=this.getBackgroundLeftFixBounds().right;let o=CRect.copyFrom(e);o.left=this.getBackgroundRightFixBounds().left;let s=CRect.copyFrom(e);s.left=i.right,s.right=o.left,this.doBeforeBottomCellBounds(s);for(let e=0;e<t.area.length;e++){let i=0;for(let o=0;o<this.gridInfo.fixBottom.length;o++){let n=s.left-t.left+t.area[e].left,a=s.top+i+this.gridInfo.cellMargin,r=s.left-t.left+t.area[e].right-this.gridInfo.cellMargin,l=s.top+i+this.gridInfo.fixBottom.get(o)+this.gridInfo.cellMargin;this.doBottomCellBounds(t.startIndex+e,o,new CRect(n,a,r,l),!1),i+=this.gridInfo.fixBottom.get(o)+this.gridInfo.cellMargin}}let n=0;this.doBeforeBottomLeftFixCellBounds(i);for(let t=0;t<this.gridInfo.fixLeft.length;t++){let e=0;for(let o=0;o<this.gridInfo.fixBottom.length;o++){let s=i.left+n,a=i.top+e+this.gridInfo.cellMargin,r=i.left+this.gridInfo.fixLeft.get(t)+n,l=i.top+e+this.gridInfo.fixBottom.get(o)+this.gridInfo.cellMargin;this.doBottomLeftFixCellBounds(t,o,new CRect(s,a,r,l)),e+=this.gridInfo.fixBottom.get(o)+this.gridInfo.cellMargin}n+=this.gridInfo.fixLeft.get(t)+this.gridInfo.cellMargin}n=0,this.doBeforeBottomRightFixCellBounds(o);for(let t=0;t<this.gridInfo.fixRight.length;t++){let e=0;for(let i=0;i<this.gridInfo.fixBottom.length;i++){let s=o.left+n+this.gridInfo.cellMargin,a=o.top+e+this.gridInfo.cellMargin,r=o.left+this.gridInfo.fixRight.get(t)+n+this.gridInfo.cellMargin,l=o.top+this.gridInfo.fixBottom.get(i)+e+this.gridInfo.cellMargin;this.doBottomRightFixCellBounds(t,i,new CRect(s,a,r,l)),e+=this.gridInfo.fixBottom.get(i)+this.gridInfo.cellMargin}n+=this.gridInfo.fixRight.get(t)+this.gridInfo.cellMargin}}doBeforeLeftCellBounds(t){}doLeftCellBounds(t,e,i){}doLeftCellsBounds(t){let e=this.getBackgroundLeftFixBounds();this.doBeforeLeftCellBounds(e);for(let i=0;i<t.area.length;i++){let o=0;for(let s=0;s<this.gridInfo.fixLeft.length;s++){let n=e.left+o,a=e.top-t.top+t.area[i].top,r=e.left+o+this.gridInfo.fixLeft.get(s),l=e.top-t.top+t.area[i].bottom-this.gridInfo.cellMargin;this.doLeftCellBounds(s,t.startIndex+i,new CRect(n,a,r,l)),o+=this.gridInfo.fixLeft.get(s)+this.gridInfo.cellMargin}}}doBeforeRightCellBounds(t){}doRightCellBounds(t,e,i){}doRightCellsBounds(t){let e=this.getBackgroundRightFixBounds();this.doBeforeRightCellBounds(e);for(let i=0;i<t.area.length;i++){let o=0;for(let s=0;s<this.gridInfo.fixRight.length;s++){let n=e.left+o+this.gridInfo.cellMargin,a=e.top-t.top+t.area[i].top,r=e.left+o+this.gridInfo.fixRight.get(s)+this.gridInfo.cellMargin,l=e.top-t.top+t.area[i].bottom-this.gridInfo.cellMargin;this.doRightCellBounds(s,t.startIndex+i,new CRect(n,a,r,l)),o+=this.gridInfo.fixRight.get(s)+this.gridInfo.cellMargin}}}doBeforeClientCellBounds(t){}doClientCellBounds(t,e,i,o){}doClientCellsBounds(t,e){let i=this.getBackgroundClientBounds(),o=this;this.doBeforeClientCellBounds(i);for(let n=0;n<t.area.length;n++)for(let a=0;a<e.area.length;a++){let r=new CPoint(t.startIndex+n,e.startIndex+a),l="none";for(let t=0;t<this.gridInfo.mergeCell.length;t++){let e=!1;function s(t){let s=o.gridInfo.mergeCell.get(t).startCell,n=o.gridInfo.mergeCell.get(t).stopCell,a=o.getCellBounds(s.x,s.y),r=o.getCellBounds(n.x,n.y);a.offset(-o.scrollX,-o.scrollY),r.offset(-o.scrollX,-o.scrollY),o.doClientCellBounds(o.gridInfo.mergeCell.get(t).startCell.x,o.gridInfo.mergeCell.get(t).startCell.y,new CRect(i.left+a.left,i.top+a.top,i.left+r.right-o.gridInfo.cellMargin,i.top+r.bottom-o.gridInfo.cellMargin),!0),e=!0}this.gridInfo.mergeCell.get(t).startCell.equal(r)?(l="first",s(t)):this.gridInfo.mergeCell.get(t).stopCell.equal(r)?(l="last",e||s(t)):this.gridInfo.mergeCell.get(t).isIn(r)&&(l="merge",e||s(t))}if("merge"!=l&&"first"!=l&&"last"!=l){let o=i.left-t.left+t.area[n].left,s=i.top-e.top+e.area[a].top,r=i.left-t.left+t.area[n].right-this.gridInfo.cellMargin,l=i.top-e.top+e.area[a].bottom-this.gridInfo.cellMargin;this.doClientCellBounds(t.startIndex+n,e.startIndex+a,new CRect(o,s,r,l),!1)}}}doKeyDown(t){super.doKeyDown(t),"End"==t.key&&(this.scrollY=this.scrollMaxY),"Home"==t.key&&(this.scrollY=this.scrollMinY),"PageDown"==t.key&&(this.scrollY+=this.getBackgroundClientBounds().height),"PageUp"==t.key&&(this.scrollY-=this.getBackgroundClientBounds().height)}getColumnArea(t){if(0==this.gridInfo.diffColumnSize.size)return{left:t*(this.gridInfo.defaultColumnWidth+this.gridInfo.cellMargin),right:(t+1)*(this.gridInfo.defaultColumnWidth+this.gridInfo.cellMargin)};{let e=this.getPreviousDiffColumns(t),i=this.gridInfo.defaultColumnWidth*(t+1-e.columns.length)+e.totalWidth+this.gridInfo.cellMargin*(t+1),o=this.gridInfo.diffColumnSize.get(t);return null!=o?{left:i-this.gridInfo.cellMargin-o,right:i}:{left:i-this.gridInfo.cellMargin-this.gridInfo.defaultColumnWidth,right:i}}}getRowArea(t){if(0==this.gridInfo.diffRowSize.size)return{top:t*(this.gridInfo.defaultRowHeight+this.gridInfo.cellMargin),bottom:(t+1)*(this.gridInfo.defaultRowHeight+this.gridInfo.cellMargin)};{let e=this.getPreviousDiffRows(t),i=this.gridInfo.defaultRowHeight*(t+1-e.rows.length)+e.totalHeight+this.gridInfo.cellMargin*(t+1),o=this.gridInfo.diffRowSize.get(t);return null!=o?{top:i-this.gridInfo.cellMargin-o,bottom:i}:{top:i-this.gridInfo.cellMargin-this.gridInfo.defaultRowHeight,bottom:i}}}xToColumn(t){if(t>=0){if(this.gridInfo.useFitWidth){let e=this.getBackgroundColumns(),i={index:-1,left:0,isMargin:!1};for(let o=0;o<e.area.length;o++){if(t>=e.area[o].left&&t<e.area[o].right-this.gridInfo.cellMargin){i.index=o,i.left=0,i.isMargin=!1;break}if(t>=e.area[o].right-this.gridInfo.cellMargin&&t<e.area[o].right){i.index=o,i.left=0,i.isMargin=!0;break}}return i}{let e=Math.floor(t/(this.gridInfo.defaultColumnWidth+this.gridInfo.cellMargin)),i=this.getColumnArea(e);if(0==this.gridInfo.diffColumnSize.size)return{index:e,left:t-i.left,isMargin:t>=i.right-this.gridInfo.cellMargin&&t<i.right};if(t<i.left){let i=e-1,o=0,s=!1;for(;;){let e=this.getColumnArea(i);if(t>=e.left&&t<e.right){o=t-e.left,s=t>=e.right-this.gridInfo.cellMargin&&t<e.right;break}i--}return{index:i,left:o,isMargin:s}}if(t>=i.right){let i=e+1,o=0,s=!1;for(;;){let e=this.getColumnArea(i);if(t>=e.left&&t<e.right){o=t-e.left,s=t>=e.right-this.gridInfo.cellMargin&&t<e.right;break}i++}return{index:i,left:o,isMargin:s}}return{index:e,left:t-i.left,isMargin:t>=i.right-this.gridInfo.cellMargin&&t<i.right}}}return{index:-1,left:0,isMargin:!1}}yToRow(t){if(t>=0){let e=Math.floor(t/(this.gridInfo.defaultRowHeight+this.gridInfo.cellMargin)),i=this.getRowArea(e);if(0==this.gridInfo.diffRowSize.size)return{index:e,top:t-i.top,isMargin:t>=i.bottom-this.gridInfo.cellMargin&&t<i.bottom};if(t<i.top){let i=e-1,o=0,s=!1;for(;;){let e=this.getRowArea(i);if(t>=e.top&&t<e.bottom){o=t-e.top,s=t>=e.bottom-this.gridInfo.cellMargin&&t<e.bottom;break}i--}return{index:i,top:o,isMargin:s}}if(t>=i.bottom){let i=e+1,o=0,s=!1;for(;;){let e=this.getRowArea(i);if(t>=e.top&&t<e.bottom){o=t-e.top,s=t>=e.bottom-this.gridInfo.cellMargin&&t<e.bottom;break}i++}return{index:i,top:o,isMargin:s}}return{index:e,top:t-i.top,isMargin:t>=i.bottom-this.gridInfo.cellMargin&&t<i.bottom}}return{index:-1,top:0,isMargin:!1}}yToHeaderRow(t){let e=Math.floor(t/(this.gridInfo.headerRowHeight+this.gridInfo.cellMargin)),i=e*(this.gridInfo.headerRowHeight+this.gridInfo.cellMargin),o=(e+1)*(this.gridInfo.headerRowHeight+this.gridInfo.cellMargin);return{index:e,top:t-i,isMargin:t>=o-this.gridInfo.cellMargin&&t<o}}getPreviousDiffColumns(t){let e={totalWidth:0,columns:new Array};return this.gridInfo.diffColumnSize.forEach(function(i,o){o<=t&&(e.totalWidth+=i,e.columns.push({index:o,width:i}))}),e}getPreviousDiffRows(t){let e={totalHeight:0,rows:new Array};return this.gridInfo.diffRowSize.forEach(function(i,o){o<=t&&(e.totalHeight+=i,e.rows.push({index:o,height:i}))}),e}getBackgroundHeaderButtonBounds(){return this.gridInfo.useHeader?this.gridInfo.useIndicator?new CRect(0,0,this.gridInfo.indicatorWidth+this.gridInfo.cellMargin,this.gridInfo.headerRowHeight*this.gridInfo.headerCount+this.gridInfo.cellMargin*this.gridInfo.headerCount):new CRect(0,0,this.gridInfo.cellMargin,this.gridInfo.headerRowHeight*this.gridInfo.headerCount+this.gridInfo.cellMargin*this.gridInfo.headerCount):new CRect(0,0,this.gridInfo.cellMargin,this.gridInfo.cellMargin)}getBackgroundHeaderBounds(){let t=0;return this.gridInfo.useIndicator&&(t=this.gridInfo.indicatorWidth+this.gridInfo.cellMargin),this.gridInfo.useHeader?new CRect(t,0,this.scrollBox.background.position.width,this.gridInfo.headerRowHeight*this.gridInfo.headerCount+this.gridInfo.cellMargin*this.gridInfo.headerCount):new CRect(t,0,this.scrollBox.background.position.width,this.gridInfo.cellMargin)}getBackgroundIndicatorBounds(){return this.gridInfo.useIndicator?new CRect(0,this.getBackgroundHeaderBounds().height,this.gridInfo.indicatorWidth+this.gridInfo.cellMargin,this.scrollBox.background.position.height):new CRect(0,this.getBackgroundHeaderBounds().height,this.gridInfo.cellMargin,this.scrollBox.background.position.height)}getBackgroundTopFixBounds(){let t=CRect.newEmpty();if(0==this.gridInfo.fixTop.length)t.left=this.getBackgroundIndicatorBounds().width,t.top=this.getBackgroundHeaderBounds().height,t.right=this.scrollBox.background.position.width,t.bottom=this.getBackgroundHeaderBounds().height;else{let e=0;for(let t=0;t<this.gridInfo.fixTop.length;t++)e+=this.gridInfo.fixTop.get(t);t.left=this.getBackgroundIndicatorBounds().width,t.top=this.getBackgroundHeaderBounds().height,t.right=this.scrollBox.background.position.width,t.bottom=this.getBackgroundHeaderBounds().height+e+this.gridInfo.cellMargin*this.gridInfo.fixTop.length}return t}getBackgroundLeftFixBounds(){let t=CRect.newEmpty();if(0==this.gridInfo.fixLeft.length)t.left=this.getBackgroundIndicatorBounds().width,t.top=this.getBackgroundHeaderBounds().height+this.getBackgroundTopFixBounds().height,t.right=this.getBackgroundIndicatorBounds().width,t.bottom=this.scrollBox.background.position.height-this.getBackgroundBottomFixBounds().height;else{let e=0;for(let t=0;t<this.gridInfo.fixLeft.length;t++)e+=this.gridInfo.fixLeft.get(t);t.left=this.getBackgroundIndicatorBounds().width,t.top=this.getBackgroundHeaderBounds().height+this.getBackgroundTopFixBounds().height,t.right=this.getBackgroundIndicatorBounds().width+e+this.gridInfo.cellMargin*this.gridInfo.fixLeft.length,t.bottom=this.scrollBox.background.position.height-this.getBackgroundBottomFixBounds().height}return t}getBackgroundRightFixBounds(){let t=CRect.newEmpty();if(0==this.gridInfo.fixRight.length)t.left=this.scrollBox.background.position.width,t.top=this.getBackgroundHeaderBounds().height+this.getBackgroundTopFixBounds().height,t.right=this.scrollBox.background.position.width,t.bottom=this.scrollBox.background.position.height-this.getBackgroundBottomFixBounds().height;else{let e=0;for(let t=0;t<this.gridInfo.fixRight.length;t++)e+=this.gridInfo.fixRight.get(t);t.left=this.scrollBox.background.position.width-e-this.gridInfo.cellMargin*this.gridInfo.fixRight.length,t.top=this.getBackgroundHeaderBounds().height+this.getBackgroundTopFixBounds().height,t.right=this.scrollBox.background.position.width,t.bottom=this.scrollBox.background.position.height-this.getBackgroundBottomFixBounds().height}return t}getBackgroundBottomFixBounds(){let t=CRect.newEmpty();if(0==this.gridInfo.fixBottom.length)t.left=this.getBackgroundIndicatorBounds().width,t.top=this.scrollBox.background.position.height,t.right=this.scrollBox.background.position.width,t.bottom=this.scrollBox.background.position.height;else{let e=0;for(let t=0;t<this.gridInfo.fixBottom.length;t++)e+=this.gridInfo.fixBottom.get(t);t.left=this.getBackgroundIndicatorBounds().width,t.top=this.scrollBox.background.position.height-e-this.gridInfo.cellMargin*this.gridInfo.fixBottom.length,t.right=this.scrollBox.background.position.width,t.bottom=this.scrollBox.background.position.height}return t}getBackgroundClientBounds(){return new CRect(this.getBackgroundLeftFixBounds().right,this.getBackgroundTopFixBounds().bottom,this.scrollBox.background.position.width-this.getBackgroundRightFixBounds().width,this.scrollBox.background.position.height-this.getBackgroundBottomFixBounds().height)}getBackgroundAllClientBounds(){let t=this.getBackgroundLeftFixBounds(),e=this.getBackgroundTopFixBounds(),i=this.getBackgroundRightFixBounds(),o=this.getBackgroundBottomFixBounds();return new CRect(t.left,e.top,i.right,o.bottom)}getContentWidth(){let t=this.getPreviousDiffColumns(this.gridInfo.columnCount-1);return this.gridInfo.defaultColumnWidth*(this.gridInfo.columnCount-t.columns.length)+t.totalWidth+this.gridInfo.cellMargin*this.gridInfo.columnCount-this.gridInfo.cellMargin}getContentHeight(){let t=this.getPreviousDiffRows(this.gridInfo.rowCount-1);return this.gridInfo.defaultRowHeight*(this.gridInfo.rowCount-t.rows.length)+t.totalHeight+this.gridInfo.cellMargin*this.gridInfo.rowCount-this.gridInfo.cellMargin}getCellBounds(t,e){let i=new CRect;if(t>=0&&e>=0){let o=this.getPreviousDiffColumns(t);if(this.gridInfo.useFitWidth){let e=this.getBackgroundColumns();i.left=e.area[t].left,i.right=e.area[t].right}else{i.right=this.gridInfo.defaultColumnWidth*(t+1-o.columns.length)+o.totalWidth+this.gridInfo.cellMargin*(t+1);let e=this.gridInfo.diffColumnSize.get(t);i.left=null==e?i.right-this.gridInfo.defaultColumnWidth-this.gridInfo.cellMargin:i.right-e-this.gridInfo.cellMargin}let s=this.getPreviousDiffRows(e);i.bottom=this.gridInfo.defaultRowHeight*(e+1-s.rows.length)+s.totalHeight+this.gridInfo.cellMargin*(e+1);let n=this.gridInfo.diffRowSize.get(e);i.top=null==n?i.bottom-this.gridInfo.defaultRowHeight-this.gridInfo.cellMargin:i.bottom-n-this.gridInfo.cellMargin}return i}getHeaderCellBounds(t,e){let i=new CRect,o=this.getPreviousDiffColumns(t);if(this.gridInfo.useFitWidth){let e=this.getBackgroundColumns();i.left=e.area[t].left,i.right=e.area[t].right}else{i.right=this.gridInfo.defaultColumnWidth*(t+1-o.columns.length)+o.totalWidth+this.gridInfo.cellMargin*(t+1);let e=this.gridInfo.diffColumnSize.get(t);i.left=null==e?i.right-this.gridInfo.defaultColumnWidth-this.gridInfo.cellMargin:i.right-e-this.gridInfo.cellMargin}return i.bottom=this.gridInfo.headerRowHeight*(e+1)+this.gridInfo.cellMargin*(e+1),i.top=i.bottom-this.gridInfo.headerRowHeight-this.gridInfo.cellMargin,i}getBackgroundColumns(){if(this.gridInfo.useFitWidth){let t=this.getPreviousDiffColumns(this.gridInfo.columnCount-1),e=this.getBackgroundClientBounds().width-t.totalWidth-this.gridInfo.cellMargin*(this.gridInfo.columnCount-1);e/=this.gridInfo.columnCount-t.columns.length;let i=new Array,o=0;for(let t=0;t<this.gridInfo.columnCount;t++){let s=this.gridInfo.diffColumnSize.get(t);null==s?(i.push({left:o,right:o+e+this.gridInfo.cellMargin}),o+=e+this.gridInfo.cellMargin):(i.push({left:o,right:o+s+this.gridInfo.cellMargin}),o+=s+this.gridInfo.cellMargin)}return{startIndex:0,left:0,area:i}}{let t=this.xToColumn(this.scrollX),e=t.index,i=0,o=0,s=new Array;for(;;){let n=this.gridInfo.diffColumnSize.get(e);if(i=null==n?this.gridInfo.defaultColumnWidth+this.gridInfo.cellMargin:n+this.gridInfo.cellMargin,s.push({left:o,right:o+i}),o+=i,this.getBackgroundClientBounds().width<o-t.left||this.gridInfo.columnCount-1<=e)break;e++}return{startIndex:t.index,left:t.left,area:s}}}getBackgroundRows(){let t=this.yToRow(this.scrollY),e=t.index,i=0,o=0,s=new Array;for(;;){let n=this.gridInfo.diffRowSize.get(e);if(i=null==n?this.gridInfo.defaultRowHeight+this.gridInfo.cellMargin:n+this.gridInfo.cellMargin,s.push({top:o,bottom:o+i}),o+=i,this.getBackgroundClientBounds().height<o-t.top||this.gridInfo.rowCount-1<=e)break;e++}return{startIndex:t.index,top:t.top,area:s}}clearDiffColumns(){this.gridInfo.diffColumnSize.clear()}clearDiffRows(){this.gridInfo.diffRowSize.clear()}clearDiff(){this.clearDiffColumns(),this.clearDiffRows()}getMergeCell(t,e){let i=t,o=e;for(let s=0;s<this.gridInfo.mergeCell.length;s++)if(this.gridInfo.mergeCell.get(s).isIn(new CPoint(t,e))){i=this.gridInfo.mergeCell.get(s).startCell.x,o=this.gridInfo.mergeCell.get(s).startCell.y;break}return{column:i,row:o}}getHeaderMergeCell(t,e){let i=t,o=e;for(let s=0;s<this.gridInfo.mergeHeaderCell.length;s++)if(this.gridInfo.mergeHeaderCell.get(s).isIn(new CPoint(t,e))){i=this.gridInfo.mergeHeaderCell.get(s).startCell.x,o=this.gridInfo.mergeHeaderCell.get(s).startCell.y;break}return{column:i,row:o}}addProperties(){let t=super.addProperties();return t.push({instance:this.scrollbarResource,propertyName:"scrollbarResource",readOnly:!1,enum:[]}),t.push({instance:this.scrollbarLength,propertyName:"scrollbarLength",readOnly:!1,enum:[]}),t}}!function(t){t[t.LEFT=0]="LEFT",t[t.CLIENT=1]="CLIENT",t[t.RIGHT=2]="RIGHT"}(ECellControlAlign||(ECellControlAlign={}));class CCellControl extends CNotifyChangeKindObject{constructor(){super(),this._canvasItemsData=new CCanvasItems,this._align=ECellControlAlign.RIGHT,this._width=30,this._margins=new CNotifyRect,this._controlCanvasItemsResource="",this._name="",this._text="",this._isOver=!1,this.col=-1,this.row=-1,this.bounds=new CRect;let t=this;this.margins.onChange=function(){t.doChange("margins")}}get canvasItemsData(){return this._canvasItemsData}get align(){return this._align}set align(t){this._align!=t&&(this._align=t,this.doChange("align"))}get margins(){return this._margins}get width(){return this._width}set width(t){this._width!=t&&(this._width=t,this.doChange("width"))}get controlCanvasItemsResource(){return this._controlCanvasItemsResource}set controlCanvasItemsResource(t){if(this._controlCanvasItemsResource!=t){this._controlCanvasItemsResource=t;let e=CSystem.resources.get(this._controlCanvasItemsResource);null!=e&&this.canvasItemsData.fromData(e),this.doChange("controlCanvasItemsResource")}}get text(){return this._text}set text(t){this._text!=t&&(this._text=t,this.doChange("text"))}get isOver(){return this._isOver}set isOver(t){this._isOver!=t&&(this._isOver=t,this.doChange("isOver"))}}class CCustumCanvasGrid extends CCustomGrid{constructor(t,e){super(t,e),this.isDraw=!0,this.__cellTopLeftFixData=new Array,this.__cellTopData=new Array,this.__cellTopRightFixData=new Array,this.__cellBottomLeftFixData=new Array,this.__cellBottomData=new Array,this.__cellBottomRightFixData=new Array,this.__cellLeftFixData=new Array,this.__cellRightFixData=new Array,this.__cellData=new Array,this.__headerLeftFixData=new Array,this.__headerData=new Array,this.__headerRightFixData=new Array,this.__indicatorTopFixData=new Array,this.__indicatorData=new Array,this.__indicatorBottomFixData=new Array,this.__headerButtonData=new CCanvasItems,this._cellTopLeftFixResource=new ArrayString,this._cellTopResource=new ArrayString,this._cellTopRightFixResource=new ArrayString,this._cellBottomLeftFixResource=new ArrayString,this._cellBottomResource=new ArrayString,this._cellBottomRightFixResource=new ArrayString,this._cellLeftFixResource=new ArrayString,this._cellRightFixResource=new ArrayString,this._cellResource=new ArrayString,this._headerLeftFixResource=new ArrayString,this._headerResource=new ArrayString,this._headerRightFixResource=new ArrayString,this._headerButtonResource="",this._indicatorTopFixResource=new ArrayString,this._indicatorResource=new ArrayString,this._indicatorBottomFixResource=new ArrayString,this._selectItems=new CStringSet,this._multiSelect=!1,this._rowSelect=!0,this.specificCellCanvasItemsResources=new CMap,this.specificCell=new CMap,this.specificColumn=new CMap,this.specificRow=new CMap,this.cellControls=new CMap,this.columnControl=new CMap;let i=this;this.__itemsLayer=this.scrollBox.layers.addLayer(),CSystem.elementBrintToFront(this.__itemsLayer.canvas),this.__itemsLayer.onDraw=function(t,e){i.doItemLayerDraw(e),i.scrollBox.doScroll()},this._selectItems.onChange=function(){i.itemLayerDraw()},this.cellControls.onChange=function(t,e,o,s){if(null!=s){let t=e.split(",");s.onChange=function(){for(let e=0;e<s.length;e++)s.get(e).onChange=function(){i.doChangeCellControl(parseInt(t[0]),parseInt(t[1]),parseInt(t[2]),s.get(e)),i.itemLayerDraw()};i.itemLayerDraw()};for(let e=0;e<s.length;e++)s.get(e).onChange=function(){i.doChangeCellControl(parseInt(t[0]),parseInt(t[1]),parseInt(t[2]),s.get(e)),i.itemLayerDraw()}}i.itemLayerDraw()},this.columnControl.onChange=function(t,e,o,s){if(null!=s){let t=e.split(",");s.onChange=function(){for(let e=0;e<s.length;e++)s.get(e).onChange=function(){i.doChangeCellControl(parseInt(t[0]),parseInt(t[1]),parseInt(t[2]),s.get(e)),i.itemLayerDraw()};i.itemLayerDraw()};for(let e=0;e<s.length;e++)s.get(e).onChange=function(){i.doChangeCellControl(parseInt(t[0]),parseInt(t[1]),parseInt(t[2]),s.get(e)),i.itemLayerDraw()}}i.itemLayerDraw()},this.specificCellCanvasItemsResources.onChange=function(t,e,o,s){i.itemLayerDraw()},this.specificCell.onChange=function(){i.itemLayerDraw()},this.specificColumn.onChange=function(){i.itemLayerDraw()},this.specificRow.onChange=function(){i.itemLayerDraw()}}get cellTopLeftFixResource(){return this._cellTopLeftFixResource}set cellTopLeftFixResource(t){this._cellTopLeftFixResource=t,this.__cellTopLeftFixData=[];for(let e=0;e<t.length;e++){let i=CSystem.resources.get(t[e]);if(null!=i){let t=new CCanvasItems;t.fromData(i),this.__cellTopLeftFixData.push(t)}}this.itemLayerDraw()}get cellTopResource(){return this._cellTopResource}set cellTopResource(t){this._cellTopResource=t,this.__cellTopData=[];for(let e=0;e<t.length;e++){let i=CSystem.resources.get(t[e]);if(null!=i){let t=new CCanvasItems;t.fromData(i),this.__cellTopData.push(t)}}this.itemLayerDraw()}get cellTopRightFixResource(){return this._cellTopRightFixResource}set cellTopRightFixResource(t){this._cellTopRightFixResource=t,this.__cellTopRightFixData=[];for(let e=0;e<t.length;e++){let i=CSystem.resources.get(t[e]);if(null!=i){let t=new CCanvasItems;t.fromData(i),this.__cellTopRightFixData.push(t)}}this.itemLayerDraw()}get cellBottomLeftFixResource(){return this._cellBottomLeftFixResource}set cellBottomLeftFixResource(t){this._cellBottomLeftFixResource=t,this.__cellBottomLeftFixData=[];for(let e=0;e<t.length;e++){let i=CSystem.resources.get(t[e]);if(null!=i){let t=new CCanvasItems;t.fromData(i),this.__cellBottomLeftFixData.push(t)}}this.itemLayerDraw()}get cellBottomResource(){return this._cellBottomResource}set cellBottomResource(t){this._cellBottomResource=t,this.__cellBottomData=[];for(let e=0;e<t.length;e++){let i=CSystem.resources.get(t[e]);if(null!=i){let t=new CCanvasItems;t.fromData(i),this.__cellBottomData.push(t)}}this.itemLayerDraw()}get cellBottomRightFixResource(){return this._cellBottomRightFixResource}set cellBottomRightFixResource(t){this._cellBottomRightFixResource=t,this.__cellBottomRightFixData=[];for(let e=0;e<t.length;e++){let i=CSystem.resources.get(t[e]);if(null!=i){let t=new CCanvasItems;t.fromData(i),this.__cellBottomRightFixData.push(t)}}this.itemLayerDraw()}get cellLeftFixResource(){return this._cellLeftFixResource}set cellLeftFixResource(t){this._cellLeftFixResource=t,this.__cellLeftFixData=[];for(let e=0;e<t.length;e++){let i=CSystem.resources.get(t[e]);if(null!=i){let t=new CCanvasItems;t.fromData(i),this.__cellLeftFixData.push(t)}}this.itemLayerDraw()}get cellRightFixResource(){return this._cellRightFixResource}set cellRightFixResource(t){this._cellRightFixResource=t,this.__cellRightFixData=[];for(let e=0;e<t.length;e++){let i=CSystem.resources.get(t[e]);if(null!=i){let t=new CCanvasItems;t.fromData(i),this.__cellRightFixData.push(t)}}this.itemLayerDraw()}get cellResource(){return this._cellResource}set cellResource(t){this._cellResource=t,this.__cellData=[];for(let e=0;e<t.length;e++){let i=CSystem.resources.get(t[e]);if(null!=i){let t=new CCanvasItems;t.fromData(i),this.__cellData.push(t)}}this.itemLayerDraw()}get headerLeftFixResource(){return this._headerLeftFixResource}set headerLeftFixResource(t){this._headerLeftFixResource=t,this.__headerLeftFixData=[];for(let e=0;e<t.length;e++){let i=CSystem.resources.get(t[e]);if(null!=i){let t=new CCanvasItems;t.fromData(i),this.__headerLeftFixData.push(t)}}this.itemLayerDraw()}get headerResource(){return this._headerResource}set headerResource(t){this._headerResource=t,this.__headerData=[];for(let e=0;e<t.length;e++){let i=CSystem.resources.get(t[e]);if(null!=i){let t=new CCanvasItems;t.fromData(i),this.__headerData.push(t)}}this.itemLayerDraw()}get headerRightFixResource(){return this._headerRightFixResource}set headerRightFixResource(t){this._headerRightFixResource=t,this.__headerRightFixData=[];for(let e=0;e<t.length;e++){let i=CSystem.resources.get(t[e]);if(null!=i){let t=new CCanvasItems;t.fromData(i),this.__headerRightFixData.push(t)}}this.itemLayerDraw()}get indicatorTopFixResource(){return this._indicatorTopFixResource}set indicatorTopFixResource(t){this._indicatorTopFixResource=t,this.__indicatorTopFixData=[];for(let e=0;e<t.length;e++){let i=CSystem.resources.get(t[e]);if(null!=i){let t=new CCanvasItems;t.fromData(i),this.__indicatorTopFixData.push(t)}}this.itemLayerDraw()}get indicatorResource(){return this._indicatorResource}set indicatorResource(t){this._indicatorResource=t,this.__indicatorData=[];for(let e=0;e<t.length;e++){let i=CSystem.resources.get(t[e]);if(null!=i){let t=new CCanvasItems;t.fromData(i),this.__indicatorData.push(t)}}this.itemLayerDraw()}get indicatorBottomFixResource(){return this._indicatorBottomFixResource}set indicatorBottomFixResource(t){this._indicatorBottomFixResource=t,this.__indicatorBottomFixData=[];for(let e=0;e<t.length;e++){let i=CSystem.resources.get(t[e]);if(null!=i){let t=new CCanvasItems;t.fromData(i),this.__indicatorBottomFixData.push(t)}}this.itemLayerDraw()}get headerButtonResource(){return this._headerButtonResource}set headerButtonResource(t){if(this._headerButtonResource!=t){this._headerButtonResource=t;let e=CSystem.resources.get(t);null!=e&&this.__headerButtonData.fromData(e),this.itemLayerDraw()}}get selectItems(){return this._selectItems}doToData(t){super.doToData(t),CDataClass.putData(t,"cellTopLeftFixResource",this.cellTopLeftFixResource,[],!0),CDataClass.putData(t,"cellTopResource",this.cellTopResource,[],!0),CDataClass.putData(t,"cellTopRightFixResource",this.cellTopRightFixResource,[],!0),CDataClass.putData(t,"cellBottomLeftFixResource",this.cellBottomLeftFixResource,[],!0),CDataClass.putData(t,"cellBottomResource",this.cellBottomResource,[],!0),CDataClass.putData(t,"cellBottomRightFixResource",this.cellBottomRightFixResource,[],!0),CDataClass.putData(t,"cellLeftFixResource",this.cellLeftFixResource,[],!0),CDataClass.putData(t,"cellRightFixResource",this.cellRightFixResource,[],!0),CDataClass.putData(t,"cellResource",this.cellResource,[],!0),CDataClass.putData(t,"headerLeftFixResource",this.headerLeftFixResource,[],!0),CDataClass.putData(t,"headerResource",this.headerResource,[],!0),CDataClass.putData(t,"headerRightFixResource",this.headerRightFixResource,[],!0),CDataClass.putData(t,"headerButtonResource",this.headerButtonResource,""),CDataClass.putData(t,"indicatorTopFixResource",this.indicatorTopFixResource,[],!0),CDataClass.putData(t,"indicatorResource",this.indicatorResource,[],!0),CDataClass.putData(t,"indicatorBottomFixResource",this.indicatorBottomFixResource,[],!0)}doFromData(t){super.doFromData(t),this.cellTopLeftFixResource=CDataClass.getData(t,"cellTopLeftFixResource",[],!0),this.cellTopResource=CDataClass.getData(t,"cellTopResource",[],!0),this.cellTopRightFixResource=CDataClass.getData(t,"cellTopRightFixResource",[],!0),this.cellBottomLeftFixResource=CDataClass.getData(t,"cellBottomLeftFixResource",[],!0),this.cellBottomResource=CDataClass.getData(t,"cellBottomResource",[],!0),this.cellBottomRightFixResource=CDataClass.getData(t,"cellBottomRightFixResource",[],!0),this.cellLeftFixResource=CDataClass.getData(t,"cellLeftFixResource",[],!0),this.cellRightFixResource=CDataClass.getData(t,"cellRightFixResource",[],!0),this.cellResource=CDataClass.getData(t,"cellResource",[],!0),this.headerLeftFixResource=CDataClass.getData(t,"headerLeftFixResource",[],!0),this.headerResource=CDataClass.getData(t,"headerResource",[],!0),this.headerRightFixResource=CDataClass.getData(t,"headerRightFixResource",[],!0),this.headerButtonResource=CDataClass.getData(t,"headerButtonResource",""),this.indicatorTopFixResource=CDataClass.getData(t,"indicatorTopFixResource",[],!0),this.indicatorResource=CDataClass.getData(t,"indicatorResource",[],!0),this.indicatorBottomFixResource=CDataClass.getData(t,"indicatorBottomFixResource",[],!0)}clearBounds(t){let e=this.__itemsLayer.context;null!=e&&e.clearRect(t.left,t.top,t.width,t.height)}drawBounds(t,e,i,o,s){let n=this.__itemsLayer.context;if(null!=n){let a=o;if(this.specificRow.has(t+","+i)){let e=this.specificRow.get(t+","+i);if(null!=e){let t=this.specificCellCanvasItemsResources.get(e);if(null!=t){let e=new CCanvasItems;e.fromData(t),a=e}}}if(this.specificColumn.has(t+","+e)){let i=this.specificColumn.get(t+","+e);if(null!=i){let t=this.specificCellCanvasItemsResources.get(i);if(null!=t){let e=new CCanvasItems;e.fromData(t),a=e}}}if(this.specificCell.has(t+","+e+","+i)){let o=this.specificColumn.get(t+","+e+","+i);if(null!=o){let t=this.specificCellCanvasItemsResources.get(o);if(null!=t){let e=new CCanvasItems;e.fromData(t),a=e}}}let r=this.doBeforeCellDraw(t,e,i,a,s);null!=r&&(a=r);let l=a.getItem("over");for(let o=0;o<l.length;o++)if(t==EPointerAreaKind.HEADER_CLIENT){let s=this.getHeaderMergeCell(this.__cellInfo.col,this.__cellInfo.row);l[o].visible=this.__cellInfo.kind==t&&e==s.column&&i==s.row}else if(t==EPointerAreaKind.CLIENT){let s=this.getMergeCell(this.__cellInfo.col,this.__cellInfo.row);l[o].visible=this.__cellInfo.kind==t&&e==s.column&&i==s.row}else l[o].visible=this.__cellInfo.kind==t&&this.__cellInfo.col==e&&this.__cellInfo.row==i;let h=a.getItem("select");for(let t=0;t<h.length;t++)this._rowSelect?h[t].visible=this._selectItems.has(i+""):h[t].visible=this._selectItems.has(e+","+i);this.doCellDraw(n,t,e,i,a,s)}}cellControlBounds(t,e,i,o){let s;if(null==(s=this.cellControls.get(t+","+e+","+i))&&(s=this.columnControl.get(t+","+e)),null!=s){let t=new Array;for(let e=0;e<s.length;e++){let i=s.get(e),n=new CRect;switch(i.align){case ECellControlAlign.LEFT:n.left=o.left+i.margins.left,n.top=o.top+i.margins.top,n.width=i.width,n.height=o.height-(i.margins.bottom+i.margins.top);break;case ECellControlAlign.CLIENT:n.left=o.left+i.margins.left,n.top=o.top+i.margins.top,n.width=o.width-(i.margins.right+i.margins.left),n.height=o.height-(i.margins.bottom+i.margins.top);break;case ECellControlAlign.RIGHT:n.left=o.right-i.width-i.margins.right,n.top=o.top+i.margins.top,n.width=i.width,n.height=o.height-(i.margins.bottom+i.margins.top)}i.bounds=n,t.push(i)}return t}}getCellControls(t,e,i){let o;if(null==(o=this.cellControls.get(t+","+e+","+i))&&(o=this.columnControl.get(t+","+e)),null!=o){let t=new Array;for(let e=0;e<o.length;e++){let i=o.get(e);t.push(i)}return t}}doBeforeCellDraw(t,e,i,o,s){if(null!=this.onBeforeCellDraw)return this.onBeforeCellDraw(this,t,e,i,o,s)}doCellDraw(t,e,i,o,s,n){s.draw(t,n,this.__itemsLayer.offset,CSystem.bufferingContext,1,1);let a=this.cellControlBounds(e,i,o,n);if(null!=a)for(let e=0;e<a.length;e++){let s=a[e],n=s.canvasItemsData.getItem("over");for(let t=0;t<n.length;t++)n[t].visible=s.isOver&&s.col==i&&s.row==o;let r=s.canvasItemsData.getItem("text");for(let t=0;t<r.length;t++)r[t].text=s.text;s.canvasItemsData.draw(t,s.bounds,this.__itemsLayer.offset,CSystem.bufferingContext,1,1)}null!=this.onCellDraw&&this.onCellDraw(this,t,e,i,o,s,n)}doCellPointerMove(t,e,i,o,s,n,a,r,l){super.doCellPointerMove(t,e,i,o,s,n,a,r,l);let h=this.getCellControls(t,e,i);if(null!=h)for(let t=0;t<h.length;t++){let r=!1;switch(h[t].align){case ECellControlAlign.LEFT:r=o>=h[t].margins.left&&o<h[t].margins.left+h[t].width&&s>=h[t].margins.top&&s<a-h[t].margins.bottom;break;case ECellControlAlign.CLIENT:r=o>=h[t].margins.left&&o<n-h[t].margins.right&&s>=h[t].margins.top&&s<a-h[t].margins.bottom;break;case ECellControlAlign.RIGHT:r=o>=n-(h[t].width+h[t].margins.right)&&o<n-h[t].margins.right&&s>=h[t].margins.top&&s<a-h[t].margins.bottom}h[t].isOver!=r&&(h[t].isOver=r,h[t].col=e,h[t].row=i,this.itemLayerDraw())}}doCellPointerOver(t,e,i,o,s){super.doCellPointerOver(t,e,i,o,s),this.itemLayerDraw()}doCellPointerOut(t,e,i,o,s){super.doCellPointerOut(t,e,i,o,s);let n=this.getCellControls(t,e,i);if(null!=n)for(let t=0;t<n.length;t++)0!=n[t].isOver&&(n[t].isOver=!1,this.itemLayerDraw());this.itemLayerDraw()}doCellClick(t,e,i,o,s,n,a,r,l){super.doCellClick(t,e,i,o,s,n,a,r,l);let h=this.getCellControls(t,e,i);if(null!=h)for(let d=0;d<h.length;d++){let u=!1;switch(h[d].align){case ECellControlAlign.LEFT:u=o>=h[d].margins.left&&o<h[d].margins.left+h[d].width&&s>=h[d].margins.top&&s<a-h[d].margins.bottom;break;case ECellControlAlign.CLIENT:u=o>=h[d].margins.left&&o<n-h[d].margins.right&&s>=h[d].margins.top&&s<a-h[d].margins.bottom;break;case ECellControlAlign.RIGHT:u=o>=n-(h[d].width+h[d].margins.right)&&o<n-h[d].margins.right&&s>=h[d].margins.top&&s<a-h[d].margins.bottom}u&&this.doCellControlClick(t,e,i,d,h[d],o,s,n,a,r,l)}}doCellControlClick(t,e,i,o,s,n,a,r,l,h,d){null!=this.onCellControlClick&&this.onCellControlClick(this,t,e,i,o,s,n,a,r,l,h,d)}doSetBounds(){this.itemLayerDraw(),super.doSetBounds()}doItemLayerDraw(t){this.isDraw&&(t.clearRect(0,0,this.__itemsLayer.canvas.width,this.__itemsLayer.canvas.height),this.doCellsBounds())}doBeforeHeaderButtomCellBounds(t){this.clearBounds(t)}doHeaderButtonCellBounds(t){this.__headerButtonData.length>0?this.drawBounds(EPointerAreaKind.HEADER_BUTTON,0,0,this.__headerButtonData,t):this.__headerData.length>0?this.drawBounds(EPointerAreaKind.HEADER_BUTTON,0,0,this.__headerData[0],t):this.__cellData.length>0&&this.drawBounds(EPointerAreaKind.HEADER_BUTTON,0,0,this.__cellData[0],t)}doBeforeHeaderLeftFixCellBounds(t){this.clearBounds(t)}doBeforeHeaderCellBounds(t){this.clearBounds(t)}doBeforeHeaderRightFixCellBounds(t){this.clearBounds(t)}doHeaderLeftFixCellBounds(t,e,i){this.__headerLeftFixData.length>0?this.drawBounds(EPointerAreaKind.HEADER_LEFT_FIX,t,e,this.__headerLeftFixData[e%this.__headerLeftFixData.length],i):this.__headerRightFixData.length>0?this.drawBounds(EPointerAreaKind.HEADER_LEFT_FIX,t,e,this.__headerRightFixData[e%this.__headerRightFixData.length],i):this.__headerData.length>0?this.drawBounds(EPointerAreaKind.HEADER_LEFT_FIX,t,e,this.__headerData[e%this.__headerData.length],i):this.__cellData.length>0&&this.drawBounds(EPointerAreaKind.HEADER_LEFT_FIX,t,e,this.__cellData[e%this.__cellData.length],i)}doHeaderCellBounds(t,e,i,o){this.__headerData.length>0?this.drawBounds(EPointerAreaKind.HEADER_CLIENT,t,e,this.__headerData[e%this.__headerData.length],i):this.__cellData.length>0&&this.drawBounds(EPointerAreaKind.HEADER_CLIENT,t,e,this.__cellData[e%this.__cellData.length],i)}doHeaderRightFixCellBounds(t,e,i){this.__headerRightFixData.length>0?this.drawBounds(EPointerAreaKind.HEADER_RIGHT_FIX,t,e,this.__headerRightFixData[e%this.__headerRightFixData.length],i):this.__headerLeftFixData.length>0?this.drawBounds(EPointerAreaKind.HEADER_RIGHT_FIX,t,e,this.__headerLeftFixData[e%this.__headerLeftFixData.length],i):this.__headerData.length>0?this.drawBounds(EPointerAreaKind.HEADER_RIGHT_FIX,t,e,this.__headerData[e%this.__headerData.length],i):this.__cellData.length>0&&this.drawBounds(EPointerAreaKind.HEADER_RIGHT_FIX,t,e,this.__cellData[e%this.__cellData.length],i)}doBeforeIndicatorTopFixCellBounds(t){this.clearBounds(t)}doBeforeIndicatorCellBounds(t){this.clearBounds(t)}doBeforeIndicatorBottomFixCellBounds(t){this.clearBounds(t)}doIndicatorTopFixCellBounds(t,e){this.__indicatorTopFixData.length>0?this.drawBounds(EPointerAreaKind.INDICATOR_TOP_FIX,0,t,this.__indicatorTopFixData[t%this.__indicatorTopFixData.length],e):this.__indicatorBottomFixData.length>0?this.drawBounds(EPointerAreaKind.INDICATOR_TOP_FIX,0,t,this.__indicatorBottomFixData[t%this.__indicatorBottomFixData.length],e):this.__indicatorData.length>0?this.drawBounds(EPointerAreaKind.INDICATOR_TOP_FIX,0,t,this.__indicatorData[t%this.__indicatorData.length],e):this.__cellData.length>0&&this.drawBounds(EPointerAreaKind.INDICATOR_TOP_FIX,0,t,this.__cellData[t%this.__cellData.length],e)}doIndicatorCellBounds(t,e){this.__indicatorData.length>0?this.drawBounds(EPointerAreaKind.INDICATOR_CLIENT,0,t,this.__indicatorData[t%this.__indicatorData.length],e):this.__cellData.length>0&&this.drawBounds(EPointerAreaKind.INDICATOR_CLIENT,0,t,this.__cellData[t%this.__cellData.length],e)}doIndicatorBottomFixCellBounds(t,e){this.__indicatorBottomFixData.length>0?this.drawBounds(EPointerAreaKind.INDICATOR_BOTTOM_FIX,0,t,this.__indicatorBottomFixData[t%this.__indicatorBottomFixData.length],e):this.__indicatorTopFixData.length>0?this.drawBounds(EPointerAreaKind.INDICATOR_BOTTOM_FIX,0,t,this.__indicatorTopFixData[t%this.__indicatorTopFixData.length],e):this.__indicatorData.length>0?this.drawBounds(EPointerAreaKind.INDICATOR_BOTTOM_FIX,0,t,this.__indicatorData[t%this.__indicatorData.length],e):this.__cellData.length>0&&this.drawBounds(EPointerAreaKind.INDICATOR_BOTTOM_FIX,0,0,this.__cellData[t%this.__cellData.length],e)}doBeforeTopLeftFixCellBounds(t){this.clearBounds(t)}doBeforeTopCellBounds(t){this.clearBounds(t)}doBeforeTopRightFixCellBounds(t){this.clearBounds(t)}doTopLeftFixCellBounds(t,e,i){this.__cellTopLeftFixData.length>0?this.drawBounds(EPointerAreaKind.TOP_LEFT_FIX,t,e,this.__cellTopLeftFixData[e%this.__cellTopLeftFixData.length],i):this.__cellTopRightFixData.length>0?this.drawBounds(EPointerAreaKind.TOP_LEFT_FIX,t,e,this.__cellTopRightFixData[e%this.__cellTopRightFixData.length],i):this.__cellTopData.length>0?this.drawBounds(EPointerAreaKind.TOP_LEFT_FIX,t,e,this.__cellTopData[e%this.__cellTopData.length],i):this.__cellData.length>0&&this.drawBounds(EPointerAreaKind.TOP_LEFT_FIX,t,e,this.__cellData[e%this.__cellData.length],i)}doTopCellBounds(t,e,i,o){this.__cellTopData.length>0?this.drawBounds(EPointerAreaKind.TOP_CLIENT_FIX,t,e,this.__cellTopData[e%this.__cellTopData.length],i):this.__cellData.length>0&&this.drawBounds(EPointerAreaKind.TOP_CLIENT_FIX,t,e,this.__cellData[e%this.__cellData.length],i)}doTopRightFixCellBounds(t,e,i){this.__cellTopRightFixData.length>0?this.drawBounds(EPointerAreaKind.TOP_RIGHT_FIX,t,e,this.__cellTopRightFixData[e%this.__cellTopRightFixData.length],i):this.__cellTopLeftFixData.length>0?this.drawBounds(EPointerAreaKind.TOP_RIGHT_FIX,t,e,this.__cellTopLeftFixData[e%this.__cellTopLeftFixData.length],i):this.__cellTopData.length>0?this.drawBounds(EPointerAreaKind.TOP_RIGHT_FIX,t,e,this.__cellTopData[e%this.__cellTopData.length],i):this.__cellData.length>0&&this.drawBounds(EPointerAreaKind.TOP_RIGHT_FIX,t,e,this.__cellData[e%this.__cellData.length],i)}doBeforeBottomLeftFixCellBounds(t){this.clearBounds(t)}doBeforeBottomCellBounds(t){this.clearBounds(t)}doBeforeBottomRightFixCellBounds(t){this.clearBounds(t)}doBottomLeftFixCellBounds(t,e,i){this.__cellBottomLeftFixData.length>0?this.drawBounds(EPointerAreaKind.BOTTOM_LEFT_FIX,t,e,this.__cellBottomLeftFixData[e%this.__cellBottomLeftFixData.length],i):this.__cellBottomRightFixData.length>0?this.drawBounds(EPointerAreaKind.BOTTOM_LEFT_FIX,t,e,this.__cellBottomRightFixData[e%this.__cellBottomRightFixData.length],i):this.__cellBottomData.length>0?this.drawBounds(EPointerAreaKind.BOTTOM_LEFT_FIX,t,e,this.__cellBottomData[e%this.__cellBottomData.length],i):this.__cellData.length>0&&this.drawBounds(EPointerAreaKind.BOTTOM_LEFT_FIX,t,e,this.__cellData[e%this.__cellData.length],i)}doBottomCellBounds(t,e,i,o){this.__cellBottomData.length>0?this.drawBounds(EPointerAreaKind.BOTTOM_CLIENT_FIX,t,e,this.__cellBottomData[e%this.__cellBottomData.length],i):this.__cellData.length>0&&this.drawBounds(EPointerAreaKind.BOTTOM_CLIENT_FIX,t,e,this.__cellData[e%this.__cellData.length],i)}doBottomRightFixCellBounds(t,e,i){this.__cellBottomRightFixData.length>0?this.drawBounds(EPointerAreaKind.BOTTOM_RIGHT_FIX,t,e,this.__cellBottomRightFixData[e%this.__cellBottomRightFixData.length],i):this.__cellBottomLeftFixData.length>0?this.drawBounds(EPointerAreaKind.BOTTOM_RIGHT_FIX,t,e,this.__cellBottomLeftFixData[e%this.__cellBottomLeftFixData.length],i):this.__cellBottomData.length>0?this.drawBounds(EPointerAreaKind.BOTTOM_RIGHT_FIX,t,e,this.__cellBottomData[e%this.__cellBottomData.length],i):this.__cellData.length>0&&this.drawBounds(EPointerAreaKind.BOTTOM_RIGHT_FIX,t,e,this.__cellData[e%this.__cellData.length],i)}doBeforeLeftCellBounds(t){this.clearBounds(t)}doLeftCellBounds(t,e,i){this.__cellLeftFixData.length>0?this.drawBounds(EPointerAreaKind.LEFT_FIX,t,e,this.__cellLeftFixData[e%this.__cellLeftFixData.length],i):this.__cellRightFixData.length>0?this.drawBounds(EPointerAreaKind.LEFT_FIX,t,e,this.__cellRightFixData[e%this.__cellRightFixData.length],i):this.__cellData.length>0&&this.drawBounds(EPointerAreaKind.LEFT_FIX,t,e,this.__cellData[e%this.__cellData.length],i)}doBeforeRightCellBounds(t){this.clearBounds(t)}doRightCellBounds(t,e,i){this.__cellRightFixData.length>0?this.drawBounds(EPointerAreaKind.RIGHT_FIX,t,e,this.__cellRightFixData[e%this.__cellRightFixData.length],i):this.__cellLeftFixData.length>0?this.drawBounds(EPointerAreaKind.RIGHT_FIX,t,e,this.__cellLeftFixData[e%this.__cellLeftFixData.length],i):this.__cellData.length>0&&this.drawBounds(EPointerAreaKind.RIGHT_FIX,t,e,this.__cellData[e%this.__cellData.length],i)}doClientCellBounds(t,e,i,o){this.__cellData.length>0&&this.drawBounds(EPointerAreaKind.CLIENT,t,e,this.__cellData[e%this.__cellData.length],i)}doChangeCellControl(t,e,i,o){this.itemLayerDraw()}itemLayerDraw(){this.isDraw&&this.__itemsLayer.draw()}addSelectItem(t,e){this._multiSelect||this._selectItems.clear(),this._rowSelect?this._selectItems.add(e+""):this._selectItems.add(t+","+e)}deleteSelectItem(t,e){this._rowSelect?this._selectItems.delete(e+""):this._selectItems.delete(t+","+e)}clearSelectItem(){this._selectItems.clear()}clearCellControl(){this.cellControls.clear(),this.columnControl.clear()}getSelectItems(){let t=new Array,e=this;return this._selectItems.forEach(function(i){if(e._rowSelect)t.push({column:-1,row:parseInt(i)});else{let e=i.split(",");t.push({column:parseInt(e[0]),row:parseInt(e[1])})}}),t}columnToScrollX(t,e){let i=this.getCellBounds(t,0);return"left"==e?i.left:i.left-this.getBackgroundClientBounds().width+i.width-this.gridInfo.cellMargin}scrollXToColumn(t,e){this.scrollX=this.columnToScrollX(t,e)}rowToScrollY(t,e){let i=this.getCellBounds(0,t);return"top"==e?i.top:i.top-this.getBackgroundClientBounds().height+i.height-this.gridInfo.cellMargin}scrollYToRow(t,e){this.scrollY=this.rowToScrollY(t,e)}addCellControl(t,e,i,o,s,n,a,r){let l=new CCellControl;l.align=o,l.width=s,n.length>0&&(l.margins.left=n[0]),n.length>1&&(l.margins.top=n[1]),n.length>2&&(l.margins.right=n[2]),n.length>3&&(l.margins.bottom=n[3]),l.controlCanvasItemsResource=a,l.text=r;let h=this.cellControls.get(t+","+e+","+i);return null==h?((h=new CList).add(l),this.cellControls.set(t+","+e+","+i,h)):h.add(l),l}addSpecificCellCanvasItemsResource(t){let e=CSystem.resources.get(t);return null!=e&&(this.specificCellCanvasItemsResources.set(t,e),!0)}addSpecificCell(t,e,i,o){if(this.specificCellCanvasItemsResources.has(t))this.specificCell.set(e+","+i+","+o,t);else{this.addSpecificCellCanvasItemsResource(t)&&this.specificCell.set(e+","+i+","+o,t)}}addSpecificColumn(t,e,i){if(this.specificCellCanvasItemsResources.has(t))this.specificColumn.set(e+","+i,t);else{this.addSpecificCellCanvasItemsResource(t)&&this.specificColumn.set(e+","+i,t)}}addSpecificRow(t,e,i){if(this.specificCellCanvasItemsResources.has(t))this.specificRow.set(e+","+i,t);else{this.addSpecificCellCanvasItemsResource(t)&&this.specificRow.set(e+","+i,t)}}}!function(t){t[t.CLICK=0]="CLICK",t[t.DOUBLE_CLICK=1]="DOUBLE_CLICK",t[t.F2_KEY=2]="F2_KEY"}(EEditorShowKind||(EEditorShowKind={}));class CCustomDataGrid extends CCustumCanvasGrid{constructor(t,e){super(t,e),this._topFixHeaders=new CStringList,this._topFixHeight=20,this._bottomFixHeaders=new CStringList,this._bottomFixHeight=20,this._leftFixHeaders=new CStringList,this._leftFixWidth=100,this._rightFixHeaders=new CStringList,this._rightFixWidth=100,this._headerText=new CSSMap,this._topIndicatorText=new CStringList,this._indicatorText=new CStringList,this._bottomIndicatorText=new CStringList,this._leftHeaderText=new CStringList,this._rightHeaderText=new CStringList,this._column=-1,this._row=-1,this.readOnlyCell=new Set,this.readOnlyColumn=new Set,this.readOnlyRow=new Set,this.useEditorEnter=!1,this.editorShowSet=new Set;let i=this;this.gridInfo.cellMargin=1,this.gridInfo.columnCount=0,this.gridInfo.rowCount=0,this.gridInfo.headerRowHeight=25,this._topFixHeaders.onChange=function(){i.doTopFixCreateData()},this._bottomFixHeaders.onChange=function(){i.doBottomFixCreateData()},this._leftFixHeaders.onChange=function(){i.doLeftFixCreateData()},this._rightFixHeaders.onChange=function(){i.doRightFixCreateData()}}get headerText(){return this._headerText}get topFixHeaders(){return this._topFixHeaders}get topFixData(){return this.__topFixData}get topFixHeight(){return this._topFixHeight}set topFixHeight(t){this._topFixHeight=t,this.isDraw=!1;for(let e=0;e<this.gridInfo.fixTop.length;e++)this.gridInfo.fixTop.set(e,t);this.isDraw=!0,this.itemLayerDraw()}get bottomFixHeaders(){return this._bottomFixHeaders}get bottomFixData(){return this.__bottomFixData}get bottomFixHeight(){return this._bottomFixHeight}set bottomFixHeight(t){this._bottomFixHeight=t,this.isDraw=!1;for(let e=0;e<this.gridInfo.fixBottom.length;e++)this.gridInfo.fixBottom.set(e,t);this.isDraw=!0,this.itemLayerDraw()}get leftFixHeaders(){return this._leftFixHeaders}get leftFixData(){return this.__leftFixData}get leftFixWidth(){return this._leftFixWidth}set leftFixWidth(t){this._leftFixWidth=t,this.isDraw=!1;for(let e=0;e<this.gridInfo.fixLeft.length;e++)this.gridInfo.fixLeft.set(e,t);this.isDraw=!0,this.itemLayerDraw()}get rightFixHeaders(){return this._rightFixHeaders}get rightFixData(){return this.__rightFixData}get rightFixWidth(){return this._rightFixWidth}set rightFixWidth(t){this._rightFixWidth=t,this.isDraw=!1;for(let e=0;e<this.gridInfo.fixRight.length;e++)this.gridInfo.fixRight.set(e,t);this.isDraw=!0,this.itemLayerDraw()}get topIndicatorText(){return this._topIndicatorText}get indicatorText(){return this._indicatorText}get bottomIndicatorText(){return this._bottomIndicatorText}get leftHeaderText(){return this._leftHeaderText}get rightHeaderText(){return this._rightHeaderText}get column(){return this._column}set column(t){this._column!=t&&(this._column=t)}get row(){return this._row}set row(t){this._row!=t&&(this._row=t)}isEditableCell(t,e){if(!this.editable)return!1;let i=this.readOnlyCell.has(t+","+e),o=this.readOnlyColumn.has(t),s=this.readOnlyRow.has(e);return!i&&!o&&!s}doToData(t){super.doToData(t),CDataClass.putData(t,"topFixHeaders",this.topFixHeaders.toData(),[],!0),CDataClass.putData(t,"topFixHeight",this.topFixHeight,20),CDataClass.putData(t,"bottomFixHeaders",this.bottomFixHeaders.toData(),[],!0),CDataClass.putData(t,"bottomFixHeight",this.bottomFixHeight,20),CDataClass.putData(t,"leftFixHeaders",this.leftFixHeaders.toData(),[],!0),CDataClass.putData(t,"leftFixWidth",this.leftFixWidth,100),CDataClass.putData(t,"rightFixHeaders",this.rightFixHeaders.toData(),[],!0),CDataClass.putData(t,"rightFixWidth",this.rightFixWidth,100),CDataClass.putData(t,"topIndicatorText",this.topIndicatorText.toData(),[],!0),CDataClass.putData(t,"indicatorText",this.indicatorText.toData(),[],!0),CDataClass.putData(t,"bottomIndicatorText",this.bottomIndicatorText.toData(),[],!0),CDataClass.putData(t,"leftHeaderText",this.leftHeaderText.toData(),[],!0),CDataClass.putData(t,"rightHeaderText",this.rightHeaderText.toData(),[],!0),CDataClass.putData(t,"headerText",this.headerText.toData(),[],!0),CDataClass.putData(t,"editorShowSet",CSystem.setToArray(this.editorShowSet),[],!0),CDataClass.putData(t,"readOnlyCell",CSystem.setToArray(this.readOnlyCell),[],!0),CDataClass.putData(t,"readOnlyColumn",CSystem.setToArray(this.readOnlyColumn),[],!0),CDataClass.putData(t,"readOnlyRow",CSystem.setToArray(this.readOnlyRow),[],!0)}doFromData(t){super.doFromData(t),this.topFixHeaders.fromData(CDataClass.getData(t,"topFixHeaders",[],!0)),this.topFixHeight=CDataClass.getData(t,"topFixHeight",20),this.bottomFixHeaders.fromData(CDataClass.getData(t,"bottomFixHeaders",[],!0)),this.bottomFixHeight=CDataClass.getData(t,"bottomFixHeight",20),this.leftFixHeaders.fromData(CDataClass.getData(t,"leftFixHeaders",[],!0)),this.leftFixWidth=CDataClass.getData(t,"leftFixWidth",100),this.rightFixHeaders.fromData(CDataClass.getData(t,"rightFixHeaders",[],!0)),this.rightFixWidth=CDataClass.getData(t,"rightFixWidth",100),this.topIndicatorText.fromData(CDataClass.getData(t,"topIndicatorText",[],!0)),this.indicatorText.fromData(CDataClass.getData(t,"indicatorText",[],!0)),this.bottomIndicatorText.fromData(CDataClass.getData(t,"bottomIndicatorText",[],!0)),this.leftHeaderText.fromData(CDataClass.getData(t,"leftHeaderText",[],!0)),this.rightHeaderText.fromData(CDataClass.getData(t,"rightHeaderText",[],!0)),this.headerText.fromData(CDataClass.getData(t,"headerText",[],!0)),CSystem.setFromArray(this.editorShowSet,CDataClass.getData(t,"editorShowSet",[],!0)),CSystem.setFromArray(this.readOnlyCell,CDataClass.getData(t,"readOnlyCell",[],!0)),CSystem.setFromArray(this.readOnlyColumn,CDataClass.getData(t,"readOnlyColumn",[],!0)),CSystem.setFromArray(this.readOnlyRow,CDataClass.getData(t,"readOnlyRow",[],!0))}doRemove(){null!=this.__editor&&this.__editor.remove(),null!=this.__topFixData&&this.__topFixData.remove(),null!=this.__bottomFixData&&this.__bottomFixData.remove(),null!=this.__leftFixData&&this.__leftFixData.remove(),null!=this.__rightFixData&&this.__rightFixData.remove(),this._topFixHeaders.remove(),this._bottomFixHeaders.remove(),this._leftFixHeaders.remove(),this._rightFixHeaders.remove(),this._headerText.remove(),this._topIndicatorText.remove(),this._indicatorText.remove(),this._bottomIndicatorText.remove(),this._leftHeaderText.remove(),this._rightHeaderText.remove(),this.readOnlyCell.clear(),this.readOnlyColumn.clear(),this.readOnlyRow.clear(),this.editorShowSet.clear(),super.doRemove()}doCellDraw(t,e,i,o,s,n){if(e==EPointerAreaKind.CLIENT){let t=s.getItem("cell");for(let e=0;e<t.length;e++){let s=this.getMergeCell(this.column,this.row);t[e].visible=s.column==i&&s.row==o}}super.doCellDraw(t,e,i,o,s,n)}doShowEditor(){let t=this,e=this.getCellBounds(this.column,this.row),i=this.getBackgroundClientBounds();e.offset(i.left-this.scrollX,i.top-this.scrollY),e.left<i.left&&(e.left=i.left),e.right>i.right&&(e.right=i.right),e.top<i.top&&(e.top=i.top),e.bottom>i.bottom&&(e.bottom=i.bottom),this.__editor=new CTextArea,this.__editor.onResource=function(){null!=t.__editor&&(t.__editor.hasFocus=!0)},this.__editor.parent=this.scrollBox,this.__editor.resource="textboxDarkEditor.control",this.__editor.stopPropagation.down=!0,this.__editor.stopPropagation.move=!0,this.__editor.stopPropagation.up=!0,this.__editor.stopPropagation.cancel=!0,this.__editor.stopPropagation.over=!0,this.__editor.stopPropagation.out=!0,this.__editor.stopPropagation.enter=!0,this.__editor.stopPropagation.leave=!0,this.__editor.stopPropagation.keyboard=!0,this.__editor.position.left=e.left,this.__editor.position.top=e.top,this.__editor.position.width=e.width,this.__editor.position.height=e.height,this.__editor.scrollbarLength=10,this.__editor.useEnter=!1,this.__editor.useHScrollbar=!1,this.__editor.useVScrollbar=!1,this.__editor.elementMargins.top=0,this.__editor.elementMargins.bottom=0,this.__editor.bringToFront(),this.__editor.visible=!0,this.__editor.text=this.cell(this.column,this.row),this.__editor.element.focus(),this.__editor.element.select(),this.__editor.flag=!0,this.__editor.element.addEventListener("blur",function(e){null!=t.__editor&&null!=t.__editor.element&&t.__editor.flag&&t.doEditorApply(t.column,t.row,t.__editor.text)}),this.__editor.onShow=function(){null!=t.__editor&&t.__editor.element.select()},this.__editor.element.addEventListener("keydown",function(e){if(null!=t.__editor){if("ArrowRight"==e.key&&e.ctrlKey){t.doEditorApply(t.column,t.row,t.__editor.text),t.column++;let e=t.columnToScrollX(t.column,"right");e>t.scrollX&&(t.scrollX=e),t.isEditableCell(t.column,t.row)&&t.doShowEditor()}if("ArrowLeft"==e.key&&e.ctrlKey){t.doEditorApply(t.column,t.row,t.__editor.text),t.column--;let e=t.columnToScrollX(t.column,"left");e<t.scrollX&&(t.scrollX=e),t.isEditableCell(t.column,t.row)&&t.doShowEditor()}if("ArrowDown"==e.key&&e.ctrlKey){t.doEditorApply(t.column,t.row,t.__editor.text),t.row++;let e=t.rowToScrollY(t.row,"bottom");e>t.scrollY&&(t.scrollY=e),t.isEditableCell(t.column,t.row)&&t.doShowEditor()}if("ArrowUp"==e.key&&e.ctrlKey){t.doEditorApply(t.column,t.row,t.__editor.text),t.row--;let e=t.rowToScrollY(t.row,"top");e<t.scrollY&&(t.scrollY=e),t.isEditableCell(t.column,t.row)&&t.doShowEditor()}"Escape"==e.key&&t.doEditorCancel(),t.useEditorEnter||"Enter"!=e.key||(t.doEditorApply(t.column,t.row,t.__editor.text),e.preventDefault()),e.ctrlKey&&"Enter"==e.key&&(t.doEditorApply(t.column,t.row,t.__editor.text),e.preventDefault())}}),null!=this.onShowEditor&&this.onShowEditor(this,this.column,this.row,this.__editor)}doBeforeEditorApply(t,e,i){null!=this.onBeforeEditorApply&&this.onBeforeEditorApply(this,t,e,this.cell(t,e),i)}doEditorApply(t,e,i){if(null!=this.__editor){this.doBeforeEditorApply(t,e,i),this.setCell(this.column,this.row,this.__editor.text),null!=this.onEditorApply&&this.onEditorApply(this,this.column,this.row,this.__editor.text),this.__editor.flag=!1;let o=this.__editor;if(this.__editor=void 0,null!=o.visibleAnimationTrigger){let t=this;o.onHide=function(){o.remove(),null==t.__editor&&(t.focused=!0)},o.visible=!1}else o.remove(),this.focused=!0}}doEditorCancel(){if(null!=this.__editor){this.__editor.flag=!1;let t=this.__editor;if(this.__editor=void 0,null!=t.visibleAnimationTrigger){let e=this;t.onHide=function(){t.remove(),null==e.__editor&&(e.focused=!0)},t.visible=!1}else t.remove(),this.focused=!0;null!=this.onEditorCancel&&this.onEditorCancel(this)}}doWheel(t){super.doWheel(t),this.doEditorCancel()}doCellClick(t,e,i,o,s,n,a,r,l){super.doCellClick(t,e,i,o,s,n,a,r,l),this.isEditableCell(e,i)&&this.editorShowSet.has(EEditorShowKind.CLICK)&&t==EPointerAreaKind.CLIENT&&this.doShowEditor()}doCellDblClick(t,e,i,o,s){super.doCellDblClick(t,e,i,o,s),this.isEditableCell(e,i)&&this.editorShowSet.has(EEditorShowKind.DOUBLE_CLICK)&&t==EPointerAreaKind.CLIENT&&this.doShowEditor()}doKeyDown(t){super.doKeyDown(t),this.isEditableCell(this.column,this.row)&&"F2"==t.key&&this.editorShowSet.has(EEditorShowKind.F2_KEY)&&this.doShowEditor()}doTopFixCreateData(){this.__topFixData=new CTableData(this._topFixHeaders.array,[]);let t=this;this.__topFixData.onChange=function(e,i,o,s){t.doTopFixDataChange(i,o,s)}}doBottomFixCreateData(){this.__bottomFixData=new CTableData(this._topFixHeaders.array,[]);let t=this;this.__bottomFixData.onChange=function(e,i,o,s){t.doBottomFixDataChange(i,o,s)}}doLeftFixCreateData(){this.__leftFixData=new CTableData(this._leftFixHeaders.array,[]);let t=this;this.__leftFixData.onChange=function(e,i,o,s){t.doLeftFixDataChange(i,o,s)}}doRightFixCreateData(){this.__rightFixData=new CTableData(this._rightFixHeaders.array,[]);let t=this;this.__rightFixData.onChange=function(e,i,o,s){t.doRightFixDataChange(i,o,s)}}doTopFixDataChange(t,e,i){if(null!=this.__topFixData){this.isDraw=!1,this.gridInfo.fixTop.clear();for(let t=0;t<this.__topFixData.length;t++)this.gridInfo.fixTop.add(this._topFixHeight);this.isDraw=!0}}doBottomFixDataChange(t,e,i){if(null!=this.__bottomFixData){this.isDraw=!1,this.gridInfo.fixBottom.clear();for(let t=0;t<this.__bottomFixData.length;t++)this.gridInfo.fixBottom.add(this._bottomFixHeight);this.isDraw=!0}}doLeftFixDataChange(t,e,i){if(null!=this.__leftFixData){this.isDraw=!1,this.gridInfo.fixLeft.clear();for(let t=0;t<this.__leftFixData.columnCount;t++)this.gridInfo.fixLeft.add(this._leftFixWidth);this.isDraw=!0}}doRightFixDataChange(t,e,i){if(null!=this.__rightFixData){this.isDraw=!1,this.gridInfo.fixRight.clear();for(let t=0;t<this.__rightFixData.columnCount;t++)this.gridInfo.fixRight.add(this._rightFixWidth);this.isDraw=!0}}doBeforeCellDraw(t,e,i,o,s){if(t!=EPointerAreaKind.TOP_LEFT_FIX&&t!=EPointerAreaKind.TOP_RIGHT_FIX&&t!=EPointerAreaKind.BOTTOM_LEFT_FIX&&t!=EPointerAreaKind.BOTTOM_RIGHT_FIX||o.setText("text",""),t==EPointerAreaKind.LEFT_FIX&&null!=this.__leftFixData&&(this.__leftFixData.length>i&&this.__leftFixData.columnCount>e?o.setText("text",this.__leftFixData.getRow(i).get(e).asString):o.setText("text","")),t==EPointerAreaKind.RIGHT_FIX&&null!=this.__rightFixData&&(this.__rightFixData.length>i&&this.__rightFixData.columnCount>e?o.setText("text",this.__rightFixData.getRow(i).get(e).asString):o.setText("text","")),t==EPointerAreaKind.TOP_CLIENT_FIX&&null!=this.__topFixData&&(this.__topFixData.length>i&&this.__topFixData.columnCount>e?o.setText("text",this.__topFixData.getRow(i).get(e).asString):o.setText("text","")),t==EPointerAreaKind.BOTTOM_CLIENT_FIX&&null!=this.__bottomFixData&&(this.__bottomFixData.length>i&&this.__bottomFixData.columnCount>e?o.setText("text",this.__bottomFixData.getRow(i).get(e).asString):o.setText("text","")),t==EPointerAreaKind.INDICATOR_TOP_FIX&&(i<this._topIndicatorText.length?o.setText("text",this._topIndicatorText.get(i)):o.setText("text","T"+(i+1))),t==EPointerAreaKind.INDICATOR_CLIENT&&(i<this._indicatorText.length?o.setText("text",this._indicatorText.get(i)):o.setText("text",i+1+"")),t==EPointerAreaKind.INDICATOR_BOTTOM_FIX&&(i<this._bottomIndicatorText.length?o.setText("text",this._bottomIndicatorText.get(i)):o.setText("text","B"+(i+1))),t==EPointerAreaKind.HEADER_LEFT_FIX&&(e<this._leftHeaderText.length?o.setText("text",this._leftHeaderText.get(e)):o.setText("text","")),t==EPointerAreaKind.HEADER_CLIENT){let t=this._headerText.get(e+","+i);null!=t&&o.setText("text",t)}return t==EPointerAreaKind.HEADER_RIGHT_FIX&&(e<this._rightHeaderText.length?o.setText("text",this._rightHeaderText.get(e)):o.setText("text","")),super.doBeforeCellDraw(t,e,i,o,s)}cell(t,e){}setCell(t,e,i){}}class CDataGrid extends CCustomDataGrid{constructor(t,e){super(t,e),this._headers=new CStringList,this._indexColumns=new CStringList;let i=this;this.hasFocus=!0,this._headers.onChange=function(){i.doCreateData()},this._indexColumns.onChange=function(){i.doCreateData()}}get datas(){let t=new Array;if(null!=this.__data)for(let e=0;e<this.__data.length;e++){let i=new Array;for(let t=0;t<this.__data.getRow(e).length;t++)i.push(this.__data.getRow(e).get(t).asString);t.push(i)}return t}set datas(t){if(null!=this.__data){this.__data.clear();for(let e=0;e<t.length;e++)this.__data.add(t[e])}}get multiSelect(){return this._multiSelect}set multiSelect(t){this._multiSelect!=t&&(this._multiSelect=t,t||this._selectItems.clear())}get rowSelect(){return this._rowSelect}set rowSelect(t){this._rowSelect!=t&&(this._selectItems.clear(),this._rowSelect=t)}get headers(){return this._headers}get indexColumns(){return this._indexColumns}get column(){return this._column}set column(t){let e=t;null!=this.__data&&this.__data.columnCount<=e&&(e=this.__data.columnCount-1),e<0&&(e=0),this._column!=e&&(this._column=e,this.itemLayerDraw())}get row(){return this._row}set row(t){let e=t;null!=this.__data&&this.__data.length<=e&&(e=this.__data.length-1),e<0&&(e=0),this._row!=e&&(this._row=e,this.itemLayerDraw())}get length(){return null!=this.__data?this.__data.length:0}doToData(t){super.doToData(t),CDataClass.putData(t,"headers",this.headers.toData(),[],!0),CDataClass.putData(t,"indexColumns",this.indexColumns.toData(),[],!0),CDataClass.putData(t,"multiSelect",this.multiSelect,!1),CDataClass.putData(t,"rowSelect",this.rowSelect,!0)}doFromData(t){super.doFromData(t),this.headers.fromData(CDataClass.getData(t,"headers",[],!0)),this.indexColumns.fromData(CDataClass.getData(t,"indexColumns",[],!0)),this.multiSelect=CDataClass.getData(t,"multiSelect",!1),this.rowSelect=CDataClass.getData(t,"rowSelect",!0)}doRemove(){this._indexColumns.remove(),this._headers.remove(),null!=this.__data&&this.__data.remove(),super.doRemove()}doKeyDown(t){if(super.doKeyDown(t),"ArrowLeft"==t.key){this.column--;let e=this.columnToScrollX(this.column,"left"),i=this.columnToScrollX(this.column,"right");e<this.scrollX?this.scrollX=e:i>this.scrollX&&(this.scrollX=i),this.multiSelect&&t.ctrlKey||this.doSelectItem(this.column,this.row,!1)}if("ArrowUp"==t.key){this.row--;let e=this.rowToScrollY(this.row,"top"),i=this.rowToScrollY(this.row,"bottom");e<this.scrollY?this.scrollY=e:i>this.scrollY&&(this.scrollY=i),this.multiSelect&&t.ctrlKey||this.doSelectItem(this.column,this.row,!1)}if("ArrowRight"==t.key){this.column++;let e=this.columnToScrollX(this.column,"left"),i=this.columnToScrollX(this.column,"right");i>this.scrollX?this.scrollX=i:e<this.scrollX&&(this.scrollX=e),this.multiSelect&&t.ctrlKey||this.doSelectItem(this.column,this.row,!1)}if("ArrowDown"==t.key){this.row++;let e=this.rowToScrollY(this.row,"top"),i=this.rowToScrollY(this.row,"bottom");i>this.scrollY?this.scrollY=i:e<this.scrollY&&(this.scrollY=e),this.multiSelect&&t.ctrlKey||this.doSelectItem(this.column,this.row,!1)}if("Enter"!=t.key&&" "!=t.key||(this.multiSelect&&t.ctrlKey?this.doSelectItem(this.column,this.row,!0):this.doCellClick(EPointerAreaKind.CLIENT,this.column,this.row,0,0,0,0,new PointerEvent(""),this.__pressedThisPoints)),t.ctrlKey&&"A"==t.key.toUpperCase()&&null!=this.__data&&this.multiSelect)if(this.clearSelectItem(),this.rowSelect)for(let t=0;t<this.__data.length;t++)this.addSelectItem(-1,t);else for(let t=0;t<this.__data.length;t++)for(let e=0;e<this.__data.columnCount;e++)this.addSelectItem(e,t)}doCreateData(){this.__data=new CTableData(this._headers.array,this._indexColumns.array),this.gridInfo.columnCount=this._headers.length;let t=this;this.__data.onChange=function(e,i,o,s){t.doDataChange(i,o,s),t.itemLayerDraw()}}doDataChange(t,e,i){null!=this.__data&&(this.gridInfo.rowCount=this.__data.length)}doBeforeCellDraw(t,e,i,o,s){return t==EPointerAreaKind.CLIENT&&null!=this.__data&&(this.__data.length>i&&this.__data.columnCount>e?"object"==this.__data.getRow(i).get(e).type?o.setObject(this.__data.getRow(i).get(e).asObject):o.setText("text",this.__data.getRow(i).get(e).asString):o.setText("text","")),super.doBeforeCellDraw(t,e,i,o,s)}doSelectItem(t,e,i){i?this.rowSelect?this._selectItems.has(e+"")?this.deleteSelectItem(t,e):this.addSelectItem(t,e):this._selectItems.has(t+","+e)?this.deleteSelectItem(t,e):this.addSelectItem(t,e):(this.clearSelectItem(),this.addSelectItem(t,e)),null!=this.onSelectItem&&this.onSelectItem(this,t,e)}doCellClick(t,e,i,o,s,n,a,r,l){t==EPointerAreaKind.CLIENT&&(this.column=e,this.row=i,this.doSelectItem(e,i,r.ctrlKey)),super.doCellClick(t,e,i,o,s,n,a,r,l)}doCellDrag(t,e,i,o){if(super.doCellDrag(t,e,i,o),this.clearSelectItem(),this.multiSelect&&"mouse"==i.pointerType)if(this.rowSelect)for(let t=e.startCell.y;t<=e.stopCell.y;t++)this.addSelectItem(-1,t);else for(let t=e.startCell.x;t<=e.stopCell.x;t++)for(let i=e.startCell.y;i<=e.stopCell.y;i++)this.addSelectItem(t,i)}doAddData(t){if(null!=this.__data)return this.__data.add(t)}doInsertData(t,e){if(null!=this.__data)return this.__data.insert(t,e)}doDeleteData(t){null!=this.__data&&this.__data.delete(t)}doClear(){null!=this.__data&&this.__data.clear()}add(t){return this.doAddData(t)}insert(t,e){return this.doInsertData(t,e)}delete(t){this.doDeleteData(t)}clear(){this.doClear()}cell(t,e){if(null!=this.__data&&this.__data.length>e&&this.__data.getRow(e).length>t)return this.__data.getRow(e).get(t).value}setCell(t,e,i){null!=this.__data&&(this.__data.getRow(e).get(t).asString=i)}autoFitColumnWidth(t){if(null!=this.__data){let e=0;e=CStringUtil.getTextWidth(this.__headerData[0].get(0).textSet,this._headers.get(t))+10;for(let i=0;i<this.__data.length;i++)e=CCalc.max(e,CStringUtil.getTextWidth(this.__cellData[0].get(0).textSet,this.cell(t,i))+10);this.gridInfo.diffColumnSize.set(t,e)}}autoFitColumnWidthAll(){for(let t=0;t<this._headers.length;t++)this.autoFitColumnWidth(t)}autoFitRowHeight(t){if(null!=this.__data){let e=0;for(let i=0;i<this.__data.columnCount;i++)e=CCalc.max(e,CStringUtil.getTextHeight(this.__cellData[0].get(0).textSet,this.cell(i,t))+10);this.gridInfo.diffRowSize.set(t,e)}}autoFitRowHeightAll(){if(null!=this.__data)for(let t=0;t<this.__data.length;t++)this.autoFitRowHeight(t)}autoFitAll(){this.autoFitColumnWidthAll(),this.autoFitRowHeightAll()}addProperties(){let t=super.addProperties();return t.push({instance:this.datas,propertyName:"datas",readOnly:!1,enum:[]}),t}}class CSpreadSheetSelector extends CPanel{}class CSpreadSheet extends CCustomDataGrid{}!function(t){t[t.ALIGN=0]="ALIGN",t[t.AUTO_SIZE=1]="AUTO_SIZE"}(ETabButtonKind||(ETabButtonKind={}));class CTabButton extends CPanel{constructor(t,e){super(t,e),this.__scrollInterval=0,this.__buttons=new Array,this._scrollBox=new CScrollBox(this),this._leftButton=new CButton(this),this._deleteButton=new CButton(this),this._addButton=new CButton(this),this._rightButton=new CButton(this),this._tabs=new CStringList,this._index=-1,this._tabButtonResource="",this._leftButtonResource="",this._rightButtonResource="",this._addButtonResource="",this._deleteButtonResource="",this._kind=ETabButtonKind.ALIGN,this._managementButtonLength=30,this._tabButtonMargin=0,this._useArrowButton=!1,this._useAddButton=!1,this._useDeleteButton=!1,this._leftButtonText="",this._rightButtonText="",this._addButtonText="",this._deleteButtonText="",this.defaultTabName="Tab";let i=this;this._scrollBox.position.align=EPositionAlign.CLIENT,this._scrollBox.onChangeSize=function(){i.doSetButtions()},this._scrollBox.useHScrollbar=!1,this._scrollBox.useVScrollbar=!1,this._rightButton.position.align=EPositionAlign.RIGHT,this._rightButton.onResource=function(){i._rightButton.position.align=EPositionAlign.RIGHT,i._rightButton.usePointerCapture=!0,i._rightButton.text=i._rightButtonText},this._rightButton.onThisPointerDown=function(){0==i.__scrollInterval&&(i.__scrollInterval=setInterval(function(){i.doTabButtonContentScroll(10)},16))},this._rightButton.onThisPointerUp=function(){clearInterval(i.__scrollInterval),i.__scrollInterval=0},this._addButton.position.align=EPositionAlign.RIGHT,this._addButton.onClick=function(){i.doAddTab(CSequence.getSequence(i.defaultTabName))},this._addButton.onResource=function(){i._addButton.position.align=EPositionAlign.RIGHT,i._addButton.text=i._addButtonText},this._deleteButton.position.align=EPositionAlign.RIGHT,this._deleteButton.onClick=function(){i.doDeleteTab()},this._deleteButton.onResource=function(){i._deleteButton.position.align=EPositionAlign.RIGHT,i._deleteButton.text=i._deleteButtonText},this._leftButton.position.align=EPositionAlign.LEFT,this._leftButton.onResource=function(){i._leftButton.position.align=EPositionAlign.LEFT,i._leftButton.usePointerCapture=!0,i._leftButton.text=i._leftButtonText},this._leftButton.onThisPointerDown=function(){0==i.__scrollInterval&&(i.__scrollInterval=setInterval(function(){i.doTabButtonContentScroll(-10)},16))},this._leftButton.onThisPointerUp=function(){clearInterval(i.__scrollInterval),i.__scrollInterval=0},this._tabs.onChange=function(){i.doChangeTabs()}}get tabs(){return this._tabs}get buttons(){return this.__buttons}get scrollBox(){return this._scrollBox}get leftButton(){return this._leftButton}get rightButton(){return this._rightButton}get addButton(){return this._addButton}get deleteButton(){return this._deleteButton}get index(){return this._index}set index(t){t!=this._index&&(this._index=t,this.doChangeIndex())}get tabButtonResource(){return this._tabButtonResource}set tabButtonResource(t){if(t!=this._tabButtonResource){this._tabButtonResource=t;for(let e=0;e<this.__buttons.length;e++)this.__buttons[e].resource=t}}get leftButtonResource(){return this._leftButtonResource}set leftButtonResource(t){t!=this._leftButtonResource&&(this._leftButtonResource=t,this._leftButton.resource=t)}get rightButtonResource(){return this._rightButtonResource}set rightButtonResource(t){t!=this._rightButtonResource&&(this._rightButtonResource=t,this._rightButton.resource=t)}get addButtonResource(){return this._addButtonResource}set addButtonResource(t){t!=this._addButtonResource&&(this._addButtonResource=t,this._addButton.resource=t)}get deleteButtonResource(){return this._deleteButtonResource}set deleteButtonResource(t){t!=this._deleteButtonResource&&(this._deleteButtonResource=t,this._deleteButton.resource=t)}get kind(){return this._kind}set kind(t){t!=this._kind&&(this._kind=t,this.doSetButtions())}get managementButtonLength(){return this._managementButtonLength}set managementButtonLength(t){t!=this._managementButtonLength&&(this._managementButtonLength=t,this.doSetButtions())}get tabButtonMargin(){return this._tabButtonMargin}set tabButtonMargin(t){t!=this._tabButtonMargin&&(this._tabButtonMargin=t,this.doSetButtions())}get useAddButton(){return this._useAddButton}set useAddButton(t){t!=this._useAddButton&&(this._useAddButton=t,this.doSetButtions())}get useDeleteButton(){return this._useDeleteButton}set useDeleteButton(t){t!=this._useDeleteButton&&(this._useDeleteButton=t,this.doSetButtions())}get useArrowButton(){return this._useArrowButton}set useArrowButton(t){t!=this._useArrowButton&&(this._useArrowButton=t,this.doSetButtions())}get leftButtonText(){return this._leftButtonText}set leftButtonText(t){t!=this._leftButtonText&&(this._leftButtonText=t,this._leftButton.text=t)}get rightButtonText(){return this._rightButtonText}set rightButtonText(t){t!=this._rightButtonText&&(this._rightButtonText=t,this._rightButton.text=t)}get addButtonText(){return this._addButtonText}set addButtonText(t){t!=this._addButtonText&&(this._addButtonText=t,this._addButton.text=t)}get deleteButtonText(){return this._deleteButtonText}set deleteButtonText(t){t!=this._deleteButtonText&&(this._deleteButtonText=t,this._deleteButton.text=t)}doToData(t){super.doToData(t),CDataClass.putData(t,"tabs",this.tabs.toData(),[],!0),CDataClass.putData(t,"tabButtonResource",this.tabButtonResource,""),CDataClass.putData(t,"leftButtonResource",this.leftButtonResource,""),CDataClass.putData(t,"rightButtonResource",this.rightButtonResource,""),CDataClass.putData(t,"addButtonResource",this.addButtonResource,""),CDataClass.putData(t,"deleteButtonResource",this.deleteButtonResource,""),CDataClass.putData(t,"kind",this.kind,ETabButtonKind.ALIGN),CDataClass.putData(t,"useArrowButton",this.useArrowButton,!1),CDataClass.putData(t,"useAddButton",this.useAddButton,!1),CDataClass.putData(t,"useDeleteButton",this.useDeleteButton,!1),CDataClass.putData(t,"managementButtonLength",this.managementButtonLength,30),CDataClass.putData(t,"tabButtonMargin",this.tabButtonMargin,0),CDataClass.putData(t,"defaultTabName",this.defaultTabName,"Tab"),CDataClass.putData(t,"leftButtonText",this.leftButtonText,""),CDataClass.putData(t,"rightButtonText",this.rightButtonText,""),CDataClass.putData(t,"addButtonText",this.addButtonText,""),CDataClass.putData(t,"deleteButtonText",this.deleteButtonText,"")}doFromData(t){super.doFromData(t),this.tabs.fromData(CDataClass.getData(t,"tabs",[],!0)),this.tabButtonResource=CDataClass.getData(t,"tabButtonResource",""),this.leftButtonResource=CDataClass.getData(t,"leftButtonResource",""),this.rightButtonResource=CDataClass.getData(t,"rightButtonResource",""),this.addButtonResource=CDataClass.getData(t,"addButtonResource",""),this.deleteButtonResource=CDataClass.getData(t,"deleteButtonResource",""),this.kind=CDataClass.getData(t,"kind",ETabButtonKind.ALIGN),this.useArrowButton=CDataClass.getData(t,"useArrowButton",!1),this.useAddButton=CDataClass.getData(t,"useAddButton",!1),this.useDeleteButton=CDataClass.getData(t,"useDeleteButton",!1),this.managementButtonLength=CDataClass.getData(t,"managementButtonLength",30),this.tabButtonMargin=CDataClass.getData(t,"tabButtonMargin",0),this.defaultTabName=CDataClass.getData(t,"defaultTabName","Tab"),this.leftButtonText=CDataClass.getData(t,"leftButtonText",""),this.rightButtonText=CDataClass.getData(t,"rightButtonText",""),this.addButtonText=CDataClass.getData(t,"addButtonText",""),this.deleteButtonText=CDataClass.getData(t,"deleteButtonText","")}doRemove(){this.tabs.clear(),super.doRemove()}doChangeIndex(){for(let t=0;t<this.__buttons.length;t++)this.__buttons[t].selected=this.index==t;null!=this.onChangeIndex&&this.onChangeIndex(this)}doAddTab(t){this.tabs.add(t),null!=this.onAddTab&&this.onAddTab(this,this.tabs.length-1)}doBeforeDeleteTab(t){null!=this.onBeforeDeleteTab&&this.onBeforeDeleteTab(this,t)}doDeleteTab(t){if(null!=t)this.doBeforeDeleteTab(t),this.tabs.delete(t),this.tabs.length<=t?this.index=this.tabs.length-1:this.doChangeIndex();else if(-1!=this.index){let t=this.index;this.doBeforeDeleteTab(t),this.tabs.delete(this.index),this.tabs.length<=t?this.index=this.tabs.length-1:this.doChangeIndex()}null!=this.onDeleteTab&&this.onDeleteTab(this)}doTabButtonContentScroll(t){this.scrollBox.scrollLeft+=t}doTabButtonClick(t){this.index=t,null!=this.onTabButtonClick&&this.onTabButtonClick(this,t)}doChangeTabs(){this.doSetButtions(),null!=this.onChangeTabs&&this.onChangeTabs(this)}doSetButtions(){let t=this;if(this.__buttons.length>this._tabs.length)for(let t=0;t<this.__buttons.length-this._tabs.length;t++)this.__buttons[this.__buttons.length-1].remove(),this.__buttons.splice(this.__buttons.length-1,1);if(this.__buttons.length<this._tabs.length)for(let e=0;e<this._tabs.length-this.__buttons.length;e++){let e=new CButton(this.scrollBox.content);e.onResource=function(){e.useAutoSize=!0},e.resource=this._tabButtonResource;let i=this.__buttons.length;e.onClick=function(){t.doTabButtonClick(i)},this.__buttons.push(e),this.doCreateTabButton(e)}for(let t=0;t<this._tabs.length;t++)this.__buttons[t].text=this._tabs.get(t);if(this.kind==ETabButtonKind.ALIGN){this.scrollBox.contentHeight=this.scrollBox.position.height,this.scrollBox.contentWidth=this.scrollBox.position.width;let t=(this.scrollBox.position.width-this.tabButtonMargin*(this.__buttons.length-1))/this.__buttons.length,e=0;for(let i=0;i<this.__buttons.length;i++)this.__buttons[i].useAutoSize=!1,this.__buttons[i].position.top=0,this.__buttons[i].position.left=e,this.__buttons[i].position.height=this.scrollBox.position.height,this.__buttons[i].position.width=t,e+=this.__buttons[i].position.width+this._tabButtonMargin}else{let t=0;for(let e=0;e<this.__buttons.length;e++)this.__buttons[e].useAutoSize=!0,this.__buttons[e].position.top=0,this.__buttons[e].position.left=t,this.__buttons[e].position.height=this.scrollBox.position.height,t+=this.__buttons[e].position.width+this._tabButtonMargin;this.scrollBox.contentHeight=this.scrollBox.position.height,this.scrollBox.contentWidth=t}this._leftButton.visible=this.useArrowButton&&this.kind==ETabButtonKind.AUTO_SIZE,this._rightButton.visible=this.useArrowButton&&this.kind==ETabButtonKind.AUTO_SIZE,this._addButton.visible=this.useAddButton&&this.kind==ETabButtonKind.AUTO_SIZE,this._deleteButton.visible=this.useDeleteButton&&this.kind==ETabButtonKind.AUTO_SIZE,this._leftButton.position.width=this._managementButtonLength,this._rightButton.position.width=this._managementButtonLength,this._addButton.position.width=this._managementButtonLength,this._deleteButton.position.width=this._managementButtonLength,null!=this.onSetButtons&&this.onSetButtons(this)}doCreateTabButton(t){null!=this.onCreateTabButton&&this.onCreateTabButton(this,t)}addTab(t){this.doAddTab(t)}deleteTab(t){this.doDeleteTab(t)}clear(){this.tabs.clear()}scrollToLeft(){this._scrollBox.scrollToLeft()}scrollToRight(){this._scrollBox.scrollToRight()}addProperties(){let t=new Array;for(let e=0;e<this.__buttons.length;e++)t.push({instance:this.__buttons[e],propertyName:"buttons["+e+"]",readOnly:!1,enum:[]});return t}}class CTab extends CPanel{constructor(t,e){super(t,e),this._tab=new CTabButton(this),this._tabSheets=new CList,this._tabButtonResource="",this._tabSheetResource="",this._body=new CPanel(this),this._tabHeight=30;let i=this;this._tab.position.align=EPositionAlign.TOP,this._tab.position.height=this._tabHeight,this._tab.onResource=function(){i._tab.position.align=EPositionAlign.TOP,i._tab.position.height=i._tabHeight},this._tab.onChangeIndex=function(){i.doChangeIndex()},this._tab.onAddTab=function(t,e){i.doAddTab(e)},this._tab.onBeforeDeleteTab=function(t,e){i.doBeforeDeleteTab(e)},this._tab.onDeleteTab=function(){i.doDeleteTab()},this._tab.onTabButtonClick=function(t,e){i.doTabButtonClick(e)},this._tab.onChangeTabs=function(){i.doChangeTabs()},this._body.position.align=EPositionAlign.CLIENT,this._body.onResource=function(){i._body.position.align=EPositionAlign.CLIENT},this._body.propertyName="body",this._body.propertyDataKind="reserveControl,_body"}get body(){return this._body}get tabs(){return this._tab.tabs}get tabButtons(){return this._tab}get tabSheets(){return this._tabSheets}get index(){return this._tab.index}set index(t){this._tab.index=t}get tabButtonResource(){return this._tabButtonResource}set tabButtonResource(t){this._tabButtonResource!=t&&(this._tabButtonResource=t,this._tab.tabButtonResource=t,this._tab.doSetButtions())}get leftButtonResource(){return this._tab.leftButtonResource}set leftButtonResource(t){this._tab.leftButtonResource=t}get rightButtonResource(){return this._tab.rightButtonResource}set rightButtonResource(t){this._tab.rightButtonResource=t}get addButtonResource(){return this._tab.addButtonResource}set addButtonResource(t){this._tab.addButtonResource=t}get deleteButtonResource(){return this._tab.deleteButtonResource}set deleteButtonResource(t){this._tab.deleteButtonResource=t}get kind(){return this._tab.kind}set kind(t){this._tab.kind=t}get useAddButton(){return this._tab.useAddButton}set useAddButton(t){this._tab.useAddButton=t}get useDeleteButton(){return this._tab.useDeleteButton}set useDeleteButton(t){this._tab.useDeleteButton=t}get useArrowButton(){return this._tab.useArrowButton}set useArrowButton(t){this._tab.useArrowButton=t}get managementButtonLength(){return this._tab.managementButtonLength}set managementButtonLength(t){this._tab.managementButtonLength=t}get tabButtonMargin(){return this._tab.tabButtonMargin}set tabButtonMargin(t){this._tab.tabButtonMargin=t}get tabResource(){return this._tab.resource}set tabResource(t){this._tab.resource=t}get tabHeight(){return this._tabHeight}set tabHeight(t){this._tabHeight!=t&&(this._tabHeight=t,this._tab.position.height=t)}get tabSheetResource(){return this._tabSheetResource}set tabSheetResource(t){if(this._tabSheetResource!=t){this._tabSheetResource=t;for(let e=0;e<this.tabSheets.length;e++)this.tabSheets.get(e).resource=t}}get tabBodyResource(){return this._body.resource}set tabBodyResource(t){this._body.resource=t}get defaultTabName(){return this._tab.defaultTabName}set defaultTabName(t){this._tab.defaultTabName=t}get leftButtonText(){return this.tabButtons.leftButtonText}set leftButtonText(t){this.tabButtons.leftButtonText=t}get rightButtonText(){return this.tabButtons.rightButtonText}set rightButtonText(t){this.tabButtons.rightButtonText=t}get addButtonText(){return this.tabButtons.addButtonText}set addButtonText(t){this.tabButtons.addButtonText=t}get deleteButtonText(){return this.tabButtons.deleteButtonText}set deleteButtonText(t){this.tabButtons.deleteButtonText=t}doToData(t){super.doToData(t),CDataClass.putData(t,"tabs",this.tabs.toData(),[],!0),CDataClass.putData(t,"tabButtonResource",this.tabButtonResource,""),CDataClass.putData(t,"leftButtonResource",this.leftButtonResource,""),CDataClass.putData(t,"rightButtonResource",this.rightButtonResource,""),CDataClass.putData(t,"addButtonResource",this.addButtonResource,""),CDataClass.putData(t,"deleteButtonResource",this.deleteButtonResource,""),CDataClass.putData(t,"kind",this.kind,ETabButtonKind.ALIGN),CDataClass.putData(t,"useArrowButton",this.useArrowButton,!1),CDataClass.putData(t,"useAddButton",this.useAddButton,!1),CDataClass.putData(t,"useDeleteButton",this.useDeleteButton,!1),CDataClass.putData(t,"managementButtonLength",this.managementButtonLength,30),CDataClass.putData(t,"tabButtonMargin",this.tabButtonMargin,0),CDataClass.putData(t,"defaultTabName",this.defaultTabName,"Tab"),CDataClass.putData(t,"tabResource",this.tabResource,""),CDataClass.putData(t,"tabBodyResource",this.tabBodyResource,""),CDataClass.putData(t,"tabSheetResource",this.tabSheetResource,""),CDataClass.putData(t,"leftButtonText",this.leftButtonText,""),CDataClass.putData(t,"rightButtonText",this.rightButtonText,""),CDataClass.putData(t,"addButtonText",this.addButtonText,""),CDataClass.putData(t,"deleteButtonText",this.deleteButtonText,""),CDataClass.putData(t,"tabHeight",this.tabHeight,30);let e=new Array;for(let t=0;t<this.tabs.length;t++)e.push({button:this.tabButtons.buttons[t].toData(),sheet:this.tabSheets.get(t).toData()});CDataClass.putData(t,"buttonSheet",e,[],!0)}doFromData(t){super.doFromData(t),this.tabButtonResource=CDataClass.getData(t,"tabButtonResource",""),this.leftButtonResource=CDataClass.getData(t,"leftButtonResource",""),this.rightButtonResource=CDataClass.getData(t,"rightButtonResource",""),this.addButtonResource=CDataClass.getData(t,"addButtonResource",""),this.deleteButtonResource=CDataClass.getData(t,"deleteButtonResource",""),this.kind=CDataClass.getData(t,"kind",ETabButtonKind.ALIGN),this.useArrowButton=CDataClass.getData(t,"useArrowButton",!1),this.useAddButton=CDataClass.getData(t,"useAddButton",!1),this.useDeleteButton=CDataClass.getData(t,"useDeleteButton",!1),this.managementButtonLength=CDataClass.getData(t,"managementButtonLength",30),this.tabButtonMargin=CDataClass.getData(t,"tabButtonMargin",0),this.defaultTabName=CDataClass.getData(t,"defaultTabName","Tab"),this.tabResource=CDataClass.getData(t,"tabResource",""),this.tabBodyResource=CDataClass.getData(t,"tabBodyResource",""),this.tabSheetResource=CDataClass.getData(t,"tabSheetResource",""),this.leftButtonText=CDataClass.getData(t,"leftButtonText",""),this.rightButtonText=CDataClass.getData(t,"rightButtonText",""),this.addButtonText=CDataClass.getData(t,"addButtonText",""),this.deleteButtonText=CDataClass.getData(t,"deleteButtonText",""),this.tabHeight=CDataClass.getData(t,"tabHeight",30),this.clear(),this.tabs.fromData(CDataClass.getData(t,"tabs",[],!0));let e=CDataClass.getData(t,"buttonSheet",[],!0);for(let t=0;t<e.length;t++)this.tabButtons.buttons[t].fromData(e[t].button),this.tabSheets.get(t).fromData(e[t].sheet)}doChangeIndex(){for(let t=0;t<this.tabSheets.length;t++){let e=t==this.index;this.tabSheets.get(t).visible!=e&&(this.tabSheets.get(t).visible=e)}null!=this.onChangeIndex&&this.onChangeIndex(this)}doAddTab(t){null!=this.onAddTab&&this.onAddTab(this)}doBeforeDeleteTab(t){this.tabSheets.get(t).remove(),this.tabSheets.delete(t),null!=this.onBeforeDeleteTab&&this.onBeforeDeleteTab(this,t)}doDeleteTab(){null!=this.onDeleteTab&&this.onDeleteTab(this)}doTabButtonClick(t){null!=this.onTabButtonClick&&this.onTabButtonClick(this,t)}doChangeTabs(){this.tabSheets.length=this.tabs.length;for(let t=0;t<this.tabSheets.length;t++)if(null==this.tabSheets.get(t)){let e=new CPanel(this._body);e.position.align=EPositionAlign.CLIENT,e.visible=!1,e.onResource=function(){e.position.align=EPositionAlign.CLIENT,e.visible=!1},e.resource=this.tabSheetResource,this.tabSheets.set(t,e),e.propertyName="sheet"+t,e.propertyDataKind="reserveControl,parent.tabSheets.get("+t+")",this.doCreateSheet(t,e)}null!=this.onChangeTabs&&this.onChangeTabs(this)}doCreateSheet(t,e){null!=this.onCreateTabSheet&&this.onCreateTabSheet(this,t,e)}addTab(t){this.tabButtons.addTab(t),this.index=this.tabs.length-1,this.tabButtons.scrollToRight()}deleteTab(t){if("string"==typeof t)for(let e=this.tabs.length-1;e>=0;e--)this.tabs.get(e)==t&&this.tabButtons.deleteTab(e);else this.tabButtons.deleteTab(t)}clear(){for(let t=this.tabs.length-1;t>=0;t--)this.tabButtons.deleteTab(t)}addProperties(){let t=new Array;return t.push({instance:this.tabs,propertyName:"tabs",readOnly:!1,enum:[]}),t.push({instance:this.leftButtonResource,propertyName:"leftButtonResource",readOnly:!1,enum:[]}),t.push({instance:this.rightButtonResource,propertyName:"rightButtonResource",readOnly:!1,enum:[]}),t.push({instance:this.addButtonResource,propertyName:"addButtonResource",readOnly:!1,enum:[]}),t.push({instance:this.deleteButtonResource,propertyName:"deleteButtonResource",readOnly:!1,enum:[]}),t.push({instance:this.tabButtons,propertyName:"tabButtons",readOnly:!1,enum:[]}),t.push({instance:this.kind,propertyName:"kind",readOnly:!1,enum:["ALIGN","AUTO_SIZE"]}),t.push({instance:this.useArrowButton,propertyName:"useArrowButton",readOnly:!1,enum:[]}),t.push({instance:this.useAddButton,propertyName:"useAddButton",readOnly:!1,enum:[]}),t.push({instance:this.useDeleteButton,propertyName:"useDeleteButton",readOnly:!1,enum:[]}),t.push({instance:this.leftButtonText,propertyName:"leftButtonText",readOnly:!1,enum:[]}),t.push({instance:this.rightButtonText,propertyName:"rightButtonText",readOnly:!1,enum:[]}),t.push({instance:this.addButtonText,propertyName:"addButtonText",readOnly:!1,enum:[]}),t.push({instance:this.deleteButtonText,propertyName:"deleteButtonText",readOnly:!1,enum:[]}),t.push({instance:this.index,propertyName:"index",readOnly:!1,enum:[]}),t}}!function(t){t[t.PREVIOUS_MONTH=0]="PREVIOUS_MONTH",t[t.NOW_MONTH=1]="NOW_MONTH",t[t.NEXT_MONTH=2]="NEXT_MONTH"}(ECalendarDateKind||(ECalendarDateKind={}));class CCalendarDaySheet extends CPanel{constructor(){super(...arguments),this.date=new Date,this.dateKind=ECalendarDateKind.NOW_MONTH}}class CCalendarPickup extends CPanel{constructor(t,e){super(t,e),this.pickupYearFrom=1900,this.pickupYearTo=2100;let i=new CPanel(this),o=new CPanel(this),s=this;this.onResource=function(){s.position.padding.all=5},i.position.width=100,i.position.align=EPositionAlign.LEFT,o.position.align=EPositionAlign.CLIENT,o.position.margins.left=5,this._labelYear=new CPanel(i),this._labelYear.position.align=EPositionAlign.TOP,this._labelYear.position.height=20,this._labelYear.text="Year",this._labelYear.onResource=function(){s._labelYear.position.align=EPositionAlign.TOP,s._labelYear.position.height=20,s._labelYear.text="Year"},this._labelMonth=new CPanel(o),this._labelMonth.position.align=EPositionAlign.TOP,this._labelMonth.position.height=20,this._labelMonth.text="Month",this._labelMonth.onResource=function(){s._labelMonth.position.align=EPositionAlign.TOP,s._labelMonth.position.height=20,s._labelMonth.text="Month"},this._listYear=new CListBox(i),this._listYear.position.align=EPositionAlign.CLIENT,this._listYear.scrollBox.useVScrollbar=!1,this._listYear.hasFocus=!0,this._listYear.onResource=function(){s._listYear.position.align=EPositionAlign.CLIENT,s._listYear.scrollBox.useVScrollbar=!1,s._listYear.hasFocus=!0},this._listMonth=new CListBox(o),this._listMonth.position.align=EPositionAlign.CLIENT,this._listMonth.scrollBox.useVScrollbar=!1,this._listMonth.hasFocus=!0,this._listMonth.onResource=function(){s._listMonth.position.align=EPositionAlign.CLIENT,s._listMonth.scrollBox.useVScrollbar=!1,s._listMonth.hasFocus=!0};for(let t=this.pickupYearFrom;t<=this.pickupYearTo;t++)this._listYear.items.add(t+"");for(let t=1;t<=12;t++)this._listMonth.items.add(t+"")}get listYear(){return this._listYear}get listMonth(){return this._listMonth}get listYearResource(){return this._listYear.resource}set listYearResource(t){this._listYear.resource=t}get listYearListItemResource(){return this._listYear.listItemResource}set listYearListItemResource(t){this._listYear.listItemResource=t}get listMonthResource(){return this._listMonth.resource}set listMonthResource(t){this._listMonth.resource=t}get listMonthListItemResource(){return this._listMonth.listItemResource}set listMonthListItemResource(t){this._listMonth.listItemResource=t}get labelYearResource(){return this._labelYear.resource}set labelYearResource(t){this._labelYear.resource=t}get labelMonthResource(){return this._labelMonth.resource}set labelMonthResource(t){this._labelMonth.resource=t}setList(t,e){for(let e=0;e<this._listYear.length;e++)if(parseInt(this._listYear.items.get(e))==t){this._listYear.itemIndex=e,this._listYear.scrollToIndex(e);break}for(let t=0;t<this._listMonth.length;t++)if(parseInt(this._listMonth.items.get(t))==e){this._listMonth.itemIndex=t,this._listMonth.scrollToIndex(t);break}}}class CCalendar extends CPanel{constructor(t,e){super(t,e),this._calendarHeader=new CPanel(this),this._calendarDayOfWeek=new CPanel(this),this._calendarBody=new CPanel(this),this._buttonPrevious=new CButton(this._calendarHeader),this._buttonNext=new CButton(this._calendarHeader),this._buttonNow=new CButton(this._calendarHeader),this._buttonPick=new CButton(this._calendarHeader),this._dayOfWeekSheets=new Array(7),this._daySheets=new Array,this._daySheetResource="",this._dayOfWeekSheetResource="",this._dayOfWeekText=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],this.pickupResource="",this.pickupListYearResource="",this.pickupListMonthResource="",this.pickupListYearListItemResource=[],this.pickupListMonthListItemResource=[],this.pickupLabelMonthResource="",this.pickupLabelYearResource="",this.pickupYearFrom=1900,this.pickupYearTo=2100;let i=this;this._calendarHeader.position.align=EPositionAlign.TOP,this._calendarHeader.position.height=30,this._calendarHeader.position.parentAlignInfo.gridColumnCount=7,this._calendarHeader.position.parentAlignInfo.gridRowCount=1,this._calendarHeader.propertyName="header",this._calendarHeader.propertyDataKind="reserveControl,_calendarHeader",this._calendarHeader.onResource=function(){i._calendarHeader.position.align=EPositionAlign.TOP,i._calendarHeader.position.height=30,i._calendarHeader.position.parentAlignInfo.gridColumnCount=7,i._calendarHeader.position.parentAlignInfo.gridRowCount=1,i._calendarHeader.text=i.date.getFullYear()+"-"+CStringUtil.lpad(i.date.getMonth()+1+"","0",2)+"-"+CStringUtil.lpad(i.date.getDate()+"","0",2),i._calendarHeader.propertyName="header",i._calendarHeader.propertyDataKind="reserveControl,_calendarHeader"},this._calendarDayOfWeek.position.align=EPositionAlign.TOP,this._calendarDayOfWeek.position.height=30,this._calendarDayOfWeek.position.parentAlignInfo.gridColumnCount=7,this._calendarDayOfWeek.position.parentAlignInfo.gridRowCount=1,this._calendarDayOfWeek.propertyName="dayOfWeek",this._calendarDayOfWeek.propertyDataKind="reserveControl,_calendarDayOfWeek",this._calendarDayOfWeek.onResource=function(){i._calendarDayOfWeek.position.align=EPositionAlign.TOP,i._calendarDayOfWeek.position.height=30,i._calendarDayOfWeek.position.parentAlignInfo.gridColumnCount=7,i._calendarDayOfWeek.position.parentAlignInfo.gridRowCount=1,i._calendarDayOfWeek.propertyName="dayOfWeek",i._calendarDayOfWeek.propertyDataKind="reserveControl,_calendarDayOfWeek"},this._calendarBody.position.align=EPositionAlign.CLIENT,this._calendarBody.position.parentAlignInfo.gridColumnCount=7,this._calendarBody.position.parentAlignInfo.gridRowCount=6,this._calendarBody.propertyName="body",this._calendarBody.propertyDataKind="reserveControl,_calendarBody",this._calendarBody.onResource=function(){i._calendarBody.position.align=EPositionAlign.CLIENT,i._calendarBody.position.parentAlignInfo.gridColumnCount=7,i._calendarBody.position.parentAlignInfo.gridRowCount=6,i._calendarBody.propertyName="body",i._calendarBody.propertyDataKind="reserveControl,_calendarBody"},this._buttonPrevious.position.align=EPositionAlign.LEFT,this._buttonPrevious.onResource=function(){i._buttonPrevious.position.align=EPositionAlign.LEFT},this._buttonPrevious.onClick=function(){i.date=new Date(i.date.getFullYear(),i.date.getMonth()-1,1)},this._buttonNext.position.align=EPositionAlign.RIGHT,this._buttonNext.onResource=function(){i._buttonNext.position.align=EPositionAlign.RIGHT},this._buttonNext.onClick=function(){i.date=new Date(i.date.getFullYear(),i.date.getMonth()+1,1)},this._buttonNow.position.align=EPositionAlign.LEFT,this._buttonNow.onResource=function(){i._buttonNow.position.align=EPositionAlign.LEFT},this._buttonNow.onClick=function(){i.date=new Date},i.calendarHeader.bringToFront(),this._buttonPick.position.align=EPositionAlign.RIGHT,this._buttonPick.pickupResource="controlbutton",this._buttonPick.onResource=function(){i._buttonPick.position.align=EPositionAlign.RIGHT},this._buttonPick.onBeforePickupShow=function(t,e){let o=new CCalendarPickup(e,"pick");o.resource=i.pickupResource,o.listYearResource=i.pickupListYearResource,o.listYearListItemResource=i.pickupListYearListItemResource,o.listMonthResource=i.pickupListMonthResource,o.listMonthListItemResource=i.pickupListMonthListItemResource,o.labelMonthResource=i.pickupLabelMonthResource,o.labelYearResource=i.pickupLabelYearResource,o.listYear.rowHeight=20,o.listMonth.rowHeight=20,o.position.align=EPositionAlign.CLIENT,o.setList(i.date.getFullYear(),i.date.getMonth()+1),o.listYear.onChangeItemIndex=function(){-1!=o.listYear.itemIndex&&(i.date=new Date(parseInt(o.listYear.items.get(o.listYear.itemIndex)),o.listMonth.itemIndex,1))},o.listMonth.onChangeItemIndex=function(){-1!=o.listMonth.itemIndex&&(i.date=new Date(parseInt(o.listYear.items.get(o.listYear.itemIndex)),o.listMonth.itemIndex,1))},o.filter.filterSet.shadow=!0,o.filter.shadowX=0,o.filter.shadowY=0};for(let t=0;t<7;t++){let e=new CPanel(this._calendarDayOfWeek);e.onResource=function(){e.position.alignInfo.gridColumn=t,e.position.alignInfo.gridRow=0,e.position.align=EPositionAlign.GRID,e.propertyName="dayOfWeek"+t,e.propertyDataKind="reserveControl,parent._dayOfWeekSheets["+t+"]"},e.position.alignInfo.gridColumn=t,e.position.alignInfo.gridRow=0,e.position.align=EPositionAlign.GRID,e.propertyName="dayOfWeek"+t,e.propertyDataKind="reserveControl,parent._dayOfWeekSheets["+t+"]",this._dayOfWeekSheets[t]=e}this._daySheets.length=7;for(let t=0;t<7;t++){let e=new Array(6);this._daySheets[t]=e;for(let e=0;e<6;e++){let o=new CCalendarDaySheet(this._calendarBody);o.onResource=function(){o.position.alignInfo.gridColumn=t,o.position.alignInfo.gridRow=e,o.position.align=EPositionAlign.GRID,o.propertyName="dayOfWeek_"+e+"_"+t,o.propertyDataKind="reserveControl,parent._daySheets["+t+"]["+e+"]"},o.position.alignInfo.gridColumn=t,o.position.alignInfo.gridRow=e,o.position.align=EPositionAlign.GRID,o.onClick=function(){i.doSelectDate(o)},o.propertyName="dayOfWeek_"+e+"_"+t,o.propertyDataKind="reserveControl,parent._daySheets["+t+"]["+e+"]",this._daySheets[t][e]=o}}this._date=new Date,this.doChangeDate()}get calendarHeader(){return this._calendarHeader}get calendarDayOfWeek(){return this._calendarDayOfWeek}get calendarBody(){return this._calendarBody}get buttonPrevious(){return this._buttonPrevious}get buttonNext(){return this._buttonNext}get buttonNow(){return this._buttonNow}get buttonPick(){return this._buttonPick}get dayOfWeekSheets(){return this._dayOfWeekSheets}get daySheets(){return this._daySheets}get calendarHeaderResource(){return this._calendarHeader.resource}set calendarHeaderResource(t){this._calendarHeader.resource=t}get calendarDayOfWeekResource(){return this._calendarDayOfWeek.resource}set calendarDayOfWeekResource(t){this._calendarDayOfWeek.resource=t}get calendarBodyResource(){return this._calendarBody.resource}set calendarBodyResource(t){this._calendarBody.resource=t}get buttonPreviousResource(){return this._buttonPrevious.resource}set buttonPreviousResource(t){this._buttonPrevious.resource=t}get buttonNextResource(){return this._buttonNext.resource}set buttonNextResource(t){this._buttonNext.resource=t}get buttonNowResource(){return this._buttonNow.resource}set buttonNowResource(t){this._buttonNow.resource=t}get buttonPickResource(){return this._buttonPick.resource}set buttonPickResource(t){this._buttonPick.resource=t}get dayOfWeekSheetResource(){return this._dayOfWeekSheetResource}set dayOfWeekSheetResource(t){if(this._dayOfWeekSheetResource!=t){this._dayOfWeekSheetResource=t;for(let e=0;e<this._dayOfWeekSheets.length;e++)this._dayOfWeekSheets[e].resource=t;this.doSetDayOfWeek()}}get daySheetResource(){return this._daySheetResource}set daySheetResource(t){if(this._daySheetResource!=t){this._daySheetResource=t;for(let e=0;e<this._daySheets.length;e++)for(let i=0;i<this._daySheets[e].length;i++)this._daySheets[e][i].resource=t;this.doSetDate()}}get date(){return this._date}set date(t){t.getTime()!=this._date.getTime()&&(this._date=t,this.doChangeDate())}get dayOfWeekText(){return this._dayOfWeekText}set dayOfWeekText(t){this._dayOfWeekText!=t&&(this._dayOfWeekText=t,this.doSetDayOfWeek())}get year(){return this._date.getFullYear()}get month(){return this._date.getMonth()+1}get day(){return this._date.getDate()}get dayOfWeek(){return this._date.getDay()}get yearString(){return this.year+""}get monthString(){return CStringUtil.lpad(this.month+"","0",2)}get dayString(){return CStringUtil.lpad(this.day+"","0",2)}get dayOfWeekString(){if(this._dayOfWeekText.length>this.dayOfWeek)return this._dayOfWeekText[this.dayOfWeek];return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][this.dayOfWeek]}doToData(t){super.doToData(t),CDataClass.putData(t,"daySheetResource",this.daySheetResource,""),CDataClass.putData(t,"dayOfWeekSheetResource",this.dayOfWeekSheetResource,""),CDataClass.putData(t,"date",this.date.getTime()),CDataClass.putData(t,"dayOfWeekText",this.dayOfWeekText,[],!0),CDataClass.putData(t,"pickupResource",this.pickupResource,""),CDataClass.putData(t,"pickupListYearResource",this.pickupListYearResource,""),CDataClass.putData(t,"pickupListMonthResource",this.pickupListMonthResource,""),CDataClass.putData(t,"pickupListYearListItemResource",this.pickupListYearListItemResource,[],!0),CDataClass.putData(t,"pickupListMonthListItemResource",this.pickupListMonthListItemResource,[],!0),CDataClass.putData(t,"pickupLabelMonthResource",this.pickupLabelMonthResource,""),CDataClass.putData(t,"pickupLabelYearResource",this.pickupLabelYearResource,""),CDataClass.putData(t,"pickupYearFrom",this.pickupYearFrom,1900),CDataClass.putData(t,"pickupYearTo",this.pickupYearTo,2100),CDataClass.putData(t,"calendarHeaderResource",this.calendarHeaderResource,""),CDataClass.putData(t,"calendarDayOfWeekResource",this.calendarDayOfWeekResource,""),CDataClass.putData(t,"calendarBodyResource",this.calendarBodyResource,""),CDataClass.putData(t,"buttonPreviousResource",this.buttonPreviousResource,""),CDataClass.putData(t,"buttonNextResource",this.buttonNextResource,""),CDataClass.putData(t,"buttonNowResource",this.buttonNowResource,""),CDataClass.putData(t,"buttonPickResource",this.buttonPickResource,""),CDataClass.putData(t,"dayOfWeekSheetResource",this.dayOfWeekSheetResource,""),CDataClass.putData(t,"daySheetResource",this.daySheetResource,"")}doFromData(t){super.doFromData(t),this.daySheetResource=CDataClass.getData(t,"daySheetResource",""),this.dayOfWeekSheetResource=CDataClass.getData(t,"dayOfWeekSheetResource",""),this.date=new Date(CDataClass.getData(t,"date")),this.dayOfWeekText=CDataClass.getData(t,"dayOfWeekText",[],!0),this.pickupResource=CDataClass.getData(t,"pickupResource",""),this.pickupListYearResource=CDataClass.getData(t,"pickupListYearResource",""),this.pickupListMonthResource=CDataClass.getData(t,"pickupListMonthResource",""),this.pickupListYearListItemResource=CDataClass.getData(t,"pickupListYearListItemResource",[],!0),this.pickupListMonthListItemResource=CDataClass.getData(t,"pickupListMonthListItemResource",[],!0),this.pickupLabelMonthResource=CDataClass.getData(t,"pickupLabelMonthResource",""),this.pickupLabelYearResource=CDataClass.getData(t,"pickupLabelYearResource",""),this.pickupYearFrom=CDataClass.getData(t,"pickupYearFrom",1900),this.pickupYearTo=CDataClass.getData(t,"pickupYearTo",2100),this.calendarHeaderResource=CDataClass.getData(t,"calendarHeaderResource",""),this.calendarDayOfWeekResource=CDataClass.getData(t,"calendarDayOfWeekResource",""),this.calendarBodyResource=CDataClass.getData(t,"calendarBodyResource",""),this.buttonPreviousResource=CDataClass.getData(t,"buttonPreviousResource",""),this.buttonNextResource=CDataClass.getData(t,"buttonNextResource",""),this.buttonNowResource=CDataClass.getData(t,"buttonNowResource",""),this.buttonPickResource=CDataClass.getData(t,"buttonPickResource",""),this.dayOfWeekSheetResource=CDataClass.getData(t,"dayOfWeekSheetResource",""),this.daySheetResource=CDataClass.getData(t,"daySheetResource","")}doSelectDate(t){this.date=t.date,null!=this.onSelectDate&&this.onSelectDate(this)}doChangeDate(){this.doSetDate(),this._calendarHeader.text=this.date.getFullYear()+"-"+CStringUtil.lpad(this.date.getMonth()+1+"","0",2)+"-"+CStringUtil.lpad(this.date.getDate()+"","0",2),null!=this.onChangeDate&&this.onChangeDate(this)}doSetDate(){let t=new CDatetime(this._date.getTime()),e=t.getFirstDayDate().getDay(),i=t.getLastDay();for(let o=0;o<this._daySheets.length;o++)for(let s=0;s<this._daySheets[o].length;s++){let n=o+7*s;this._daySheets[o][s].date=new Date(t.year,t.month-1,n-e+1),this._daySheets[o][s].text=this._daySheets[o][s].date.getDate()+"",this._daySheets[o][s].selected=!1,CDatetime.dateToYYYYMMDD(this._daySheets[o][s].date)==CDatetime.dateToYYYYMMDD(this.date)&&(this._daySheets[o][s].selected=!0,this._daySheets[o][s].focused=!0),n<e?(this._daySheets[o][s].opacity=.5,this._daySheets[o][s].dateKind=ECalendarDateKind.PREVIOUS_MONTH):n>=e&&n<e+i?(this._daySheets[o][s].opacity=1,this._daySheets[o][s].dateKind=ECalendarDateKind.NOW_MONTH):(this._daySheets[o][s].opacity=.5,this._daySheets[o][s].dateKind=ECalendarDateKind.NEXT_MONTH),this.doSetDaySheet(o,s,this._daySheets[o][s])}null!=this.onSetDate&&this.onSetDate(this)}doSetDaySheet(t,e,i){null!=this.onSetDaySheet&&this.onSetDaySheet(this,t,e,i)}doSetDayOfWeek(){for(let t=0;t<this._dayOfWeekSheets.length;t++)this._dayOfWeekText.length>t&&(this._dayOfWeekSheets[t].text=this._dayOfWeekText[t]);null!=this.onSetDayOfWeek&&this.onSetDayOfWeek(this)}}class CClock extends CPanel{constructor(t,e){super(t,e),this.__editIsAm=!1,this.__tick=0,this.__hourDown=new CPoint(0,0),this.__minDown=new CPoint(0,0),this.__secDown=new CPoint(0,0),this._hourAngle=0,this._minuteAngle=0,this._secondAngle=0,this._date=new Date,this._hourHandle=new CPanel(this),this._minuteHandle=new CPanel(this),this._secondHandle=new CPanel(this),this._useEdit=!1,this._amPmText=["AM","PM"],this._addHour=0,this._addMinute=0,this._addSecond=0,this._hourCanvasItemName="hour",this._minuteCanvasItemName="minute",this._secondCanvasItemName="second",this._labelCanvasItemName="label",this._amPmCanvasItemName="ampm",this._handleResource="",this.interval=100;let i=this;this._hourHandle.visible=!1,this._hourHandle.usePointerCapture=!0,this._hourHandle.onResource=function(){i._hourHandle.visible=!1,i._hourHandle.usePointerCapture=!0,i._hourHandle.text="H",i._hourHandle.useMove=!0,i._hourHandle.resizeAreaLength=0,i._hourHandle.moveAreaLength=100},this._hourHandle.onThisPointerDown=function(t,e,o){i.__secDown=new CPoint(i._hourHandle.position.left+i._hourHandle.position.width/2,i._hourHandle.position.top+i._hourHandle.position.height/2)},this._hourHandle.onPointerUp=function(){i.setHandle()},this._hourHandle.onThisPointerMove=function(t,e,o){if(i._hourHandle.isPress){let t=CPoint.getAngleFromTwoPoint(new CPoint(i.position.width/2,i.position.height/2),new CPoint(i._hourHandle.position.left+i._hourHandle.position.width/2,i._hourHandle.position.top+i._hourHandle.position.height/2));if(i.__editIsAm){let e=CCalc.crRange2Value(0,360,t,3,15);e>12&&(e-=12),i.date=new Date(i.date.getFullYear(),i.date.getMonth()-1,i.date.getDate(),e,i.date.getMinutes(),i.date.getSeconds())}else{let e=CCalc.crRange2Value(0,360,t,15,27);e>24&&(e-=12),i.date=new Date(i.date.getFullYear(),i.date.getMonth()-1,i.date.getDate(),e,i.date.getMinutes(),i.date.getSeconds())}}},this._minuteHandle.visible=!1,this._minuteHandle.usePointerCapture=!0,this._minuteHandle.onResource=function(){i._minuteHandle.visible=!1,i._minuteHandle.usePointerCapture=!0,i._minuteHandle.text="M",i._minuteHandle.useMove=!0,i._minuteHandle.resizeAreaLength=0,i._minuteHandle.moveAreaLength=100},this._minuteHandle.onThisPointerDown=function(t,e,o){i.__secDown=new CPoint(i._minuteHandle.position.left+i._minuteHandle.position.width/2,i._minuteHandle.position.top+i._minuteHandle.position.height/2)},this._minuteHandle.onThisPointerMove=function(t,e,o){if(i._minuteHandle.isPress){let t=CPoint.getAngleFromTwoPoint(new CPoint(i.position.width/2,i.position.height/2),new CPoint(i._minuteHandle.position.left+i._minuteHandle.position.width/2,i._minuteHandle.position.top+i._minuteHandle.position.height/2)),e=CCalc.crRange2Value(0,360,t,15,75);e>60&&(e-=60),i.date=new Date(i.date.getFullYear(),i.date.getMonth()-1,i.date.getDate(),i.date.getHours(),e,i.date.getSeconds())}},this._minuteHandle.onPointerUp=function(){i.setHandle()},this._secondHandle.visible=!1,this._secondHandle.usePointerCapture=!0,this._secondHandle.text="S",this._secondHandle.onResource=function(){i._secondHandle.visible=!1,i._secondHandle.usePointerCapture=!0,i._secondHandle.text="S",i._secondHandle.useMove=!0,i._secondHandle.resizeAreaLength=0,i._secondHandle.moveAreaLength=100},this._secondHandle.onThisPointerDown=function(t,e,o){i.__secDown=new CPoint(i._secondHandle.position.left+i._secondHandle.position.width/2,i._secondHandle.position.top+i._secondHandle.position.height/2)},this._secondHandle.onThisPointerMove=function(t,e,o){if(i._secondHandle.isPress){let t=CPoint.getAngleFromTwoPoint(new CPoint(i.position.width/2,i.position.height/2),new CPoint(i._secondHandle.position.left+i._secondHandle.position.width/2,i._secondHandle.position.top+i._secondHandle.position.height/2)),e=CCalc.crRange2Value(0,360,t,15,75);e>60&&(e-=60),i.date=new Date(i.date.getFullYear(),i.date.getMonth()-1,i.date.getDate(),i.date.getHours(),i.date.getMinutes(),e)}},this._secondHandle.onPointerUp=function(){i.setHandle()}}get hourAngle(){return this._hourAngle}get minuteAngle(){return this._minuteAngle}get secondAngle(){return this._secondAngle}get date(){return this._date}set date(t){this._date.getTime()!=t.getTime()&&(this._date=t,this.doChangeDate())}get hourHandle(){return this._hourHandle}get minuteHandle(){return this._minuteHandle}get secondHandle(){return this._secondHandle}get useEdit(){return this._useEdit}set useEdit(t){this._useEdit!=t&&(this._useEdit=t,this.doChangeEdit(t))}get amPmText(){return this._amPmText}set amPmText(t){this._amPmText=t,this.doSetTime()}get addHour(){return this._addHour}set addHour(t){this._addHour=t,this.doSetTime()}get addMinute(){return this._addMinute}set addMinute(t){this._addMinute=t,this.doSetTime()}get addSecond(){return this._addSecond}set addSecond(t){this._addSecond=t,this.doSetTime()}get hourCanvasItemName(){return this._hourCanvasItemName}set hourCanvasItemName(t){this._hourCanvasItemName=t,this.doSetTime()}get minuteCanvasItemName(){return this._minuteCanvasItemName}set minuteCanvasItemName(t){this._minuteCanvasItemName=t,this.doSetTime()}get secondCanvasItemName(){return this._secondCanvasItemName}set secondCanvasItemName(t){this._secondCanvasItemName=t,this.doSetTime()}get labelCanvasItemName(){return this._labelCanvasItemName}set labelCanvasItemName(t){this._labelCanvasItemName=t,this.doSetTime()}get amPmCanvasItemName(){return this._amPmCanvasItemName}set amPmCanvasItemName(t){this._amPmCanvasItemName=t,this.doSetTime()}get handleResource(){return this._handleResource}set handleResource(t){this._handleResource=t,this._hourHandle.resource=t,this._minuteHandle.resource=t,this._secondHandle.resource=t}setHandle(){let t=this.position.width/10,e=4*t-t/2,i=3*t-t/2,o=2*t-t/2;if(!this._hourHandle.isPress){let e=CPoint.getAngleToPoint(new CPoint(this.position.width/2,this.position.height/2),o,o,this._hourAngle-90);this._hourHandle.position.left=e.x-t/2,this._hourHandle.position.top=e.y-t/2,this._hourHandle.position.width=t,this._hourHandle.position.height=t}if(!this._minuteHandle.isPress){let e=CPoint.getAngleToPoint(new CPoint(this.position.width/2,this.position.height/2),i,i,this._minuteAngle-90);this._minuteHandle.position.left=e.x-t/2,this._minuteHandle.position.top=e.y-t/2,this._minuteHandle.position.width=t,this._minuteHandle.position.height=t}if(!this._secondHandle.isPress){let i=CPoint.getAngleToPoint(new CPoint(this.position.width/2,this.position.height/2),e,e,this._secondAngle-90);this._secondHandle.position.left=i.x-t/2,this._secondHandle.position.top=i.y-t/2,this._secondHandle.position.width=t,this._secondHandle.position.height=t}}doToData(t){super.doToData(t),CDataClass.putData(t,"date",this._date.getTime()),CDataClass.putData(t,"amPmText",this.amPmText,["AM","PM"],!0),CDataClass.putData(t,"addHour",this.addHour,0),CDataClass.putData(t,"addMinute",this.addMinute,0),CDataClass.putData(t,"addSecond",this.addSecond,0),CDataClass.putData(t,"hourCanvasItemName",this.hourCanvasItemName,"hour"),CDataClass.putData(t,"minuteCanvasItemName",this.minuteCanvasItemName,"minute"),CDataClass.putData(t,"secondCanvasItemName",this.secondCanvasItemName,"second"),CDataClass.putData(t,"labelCanvasItemName",this.labelCanvasItemName,"label"),CDataClass.putData(t,"amPmCanvasItemName",this.amPmCanvasItemName,"ampm"),CDataClass.putData(t,"handleResource",this.handleResource,"")}doFromData(t){super.doFromData(t),this.date=new Date(CDataClass.getData(t,"date")),this.amPmText=CDataClass.getData(t,"amPmText",["AM","PM"],!0),this.addHour=CDataClass.getData(t,"addHour",0),this.addMinute=CDataClass.getData(t,"addMinute",0),this.addSecond=CDataClass.getData(t,"addSecond",0),this.hourCanvasItemName=CDataClass.getData(t,"hourCanvasItemName","hour"),this.minuteCanvasItemName=CDataClass.getData(t,"minuteCanvasItemName","minute"),this.secondCanvasItemName=CDataClass.getData(t,"secondCanvasItemName","second"),this.labelCanvasItemName=CDataClass.getData(t,"labelCanvasItemName","label"),this.amPmCanvasItemName=CDataClass.getData(t,"amPmCanvasItemName","ampm"),this.handleResource=CDataClass.getData(t,"handleResource","")}doClick(t){super.doClick(t),this.useEdit&&(this.__editIsAm=!this.__editIsAm,this.doSetTime(),this.draw())}doChangeEdit(t){this._hourHandle.visible=t,this._minuteHandle.visible=t,this._secondHandle.visible=t,this.__editIsAm=!(this.date.getHours()>12),this.setHandle()}doChangeDate(){this.doSetTime()}doSetTime(){let t=this.date,e=60*(t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours()+this._addHour,t.getMinutes()+this._addMinute,t.getSeconds()+this._addSecond,t.getMilliseconds())).getHours()*60*1e3+60*t.getMinutes()*1e3+1e3*t.getSeconds()+t.getMilliseconds();this._hourAngle=CCalc.cr(864e5,e,720,0,4);let i=60*t.getMinutes()*1e3+1e3*t.getSeconds()+t.getMilliseconds();this._minuteAngle=CCalc.cr(36e5,i,360,0,4);let o=1e3*t.getSeconds()+t.getMilliseconds();this._secondAngle=CCalc.cr(6e4,o,360,0,4);let s=this.layers.getCanvasItems(this._hourCanvasItemName);for(let t=0;t<s.length;t++)s[t].rotationAngle=this._hourAngle-90;let n=this.layers.getCanvasItems(this._minuteCanvasItemName);for(let t=0;t<n.length;t++)n[t].rotationAngle=this._minuteAngle-90;let a=this.layers.getCanvasItems(this._secondCanvasItemName);for(let t=0;t<a.length;t++)a[t].rotationAngle=this._secondAngle-90;let r=this.layers.getCanvasItems(this._labelCanvasItemName);for(let e=0;e<r.length;e++)r[e].text=CStringUtil.lpad(t.getHours()+"","0",2)+" : "+CStringUtil.lpad(t.getMinutes()+"","0",2)+" : "+CStringUtil.lpad(t.getSeconds()+"","0",2);if(this.useEdit){let t=this.layers.getCanvasItems(this._amPmCanvasItemName);for(let e=0;e<t.length;e++)this.__editIsAm?this.amPmText.length>=2&&(t[e].text=this.amPmText[0]):this.amPmText.length>=2&&(t[e].text=this.amPmText[1])}else{let e=this.layers.getCanvasItems(this._amPmCanvasItemName);for(let i=0;i<e.length;i++)t.getHours()>12?this.amPmText.length>=2&&(e[i].text=this.amPmText[1]):this.amPmText.length>=2&&(e[i].text=this.amPmText[0])}this.useEdit&&this.setHandle()}on(){if(0==this.__tick){this.useEdit=!1;let t=this;this.__tick=setInterval(function(){t.date=new Date},this.interval)}}off(){0!=this.__tick&&(clearInterval(this.__tick),this.__tick=0)}}class CFrameModel extends CPanel{}class CWindowModel extends CFrameModel{constructor(t,e){super(t,e),this.__orgPadding=new CRect,this.__orgPosition=new CPosition,this.__state="none",this.caption=new CPanel(this),this.icon=new CPanel(this.caption),this.btnClose=new CButton(this.caption),this.btnMaximize=new CButton(this.caption),this.btnCustomAlign=new CButton(this.caption),this.btnMinimize=new CButton(this.caption),this.btnSendToBack=new CButton(this.caption),this.body=new CPanel(this),this.alignCover=new CCover(this.body),this.customAlign=new CPanel(this.alignCover),this.btnAlignLeftTop=new CButton(this.customAlign),this.btnAlignMiddleTop=new CButton(this.customAlign),this.btnAlignRightTop=new CButton(this.customAlign),this.btnAlignLeftMiddle=new CButton(this.customAlign),this.btnAlignRightMiddle=new CButton(this.customAlign),this.btnAlignLeftBottom=new CButton(this.customAlign),this.btnAlignMiddleBottom=new CButton(this.customAlign),this.btnAlignRightBottom=new CButton(this.customAlign),this.btnAlignCenter=new CButton(this.customAlign),this.cover=new CCover(this.body),this.closeAction="remove";let i=this;function o(){i.__orgPosition.left=i.position.left,i.__orgPosition.top=i.position.top,i.__orgPosition.width=i.position.width,i.__orgPosition.height=i.position.height}this.propertyName="CWindowModel",this.caption.propertyName="caption",this.caption.propertyDataKind="reserveControl,caption",this.btnClose.propertyName="btnClose",this.btnClose.propertyDataKind="reserveControl,parent.btnClose",this.btnMaximize.propertyName="btnMaximize",this.btnMaximize.propertyDataKind="reserveControl,parent.btnMaximize",this.btnCustomAlign.propertyName="btnCustomAlign",this.btnCustomAlign.propertyDataKind="reserveControl,parent.btnCustomAlign",this.btnMinimize.propertyName="btnMinimize",this.btnMinimize.propertyDataKind="reserveControl,parent.btnMinimize",this.body.propertyName="body",this.body.propertyDataKind="reserveControl,body",this.alignCover.propertyName="alignCover",this.alignCover.propertyDataKind="reserveControl,parent.alignCover",this.customAlign.propertyName="customAlign",this.customAlign.propertyDataKind="reserveControl,parent.parent.customAlign",this.btnAlignLeftTop.propertyName="btnAlignLeftTop",this.btnAlignLeftTop.propertyDataKind="reserveControl,parent.parent.parent.btnAlignLeftTop",this.btnAlignMiddleTop.propertyName="btnAlignMiddleTop",this.btnAlignMiddleTop.propertyDataKind="reserveControl,parent.parent.parent.btnAlignMiddleTop",this.btnAlignRightTop.propertyName="btnAlignRightTop",this.btnAlignRightTop.propertyDataKind="reserveControl,parent.parent.parent.btnAlignRightTop",this.btnAlignLeftMiddle.propertyName="btnAlignLeftMiddle",this.btnAlignLeftMiddle.propertyDataKind="reserveControl,parent.parent.parent.btnAlignLeftMiddle",this.btnAlignRightMiddle.propertyName="btnAlignRightMiddle",this.btnAlignRightMiddle.propertyDataKind="reserveControl,parent.parent.parent.btnAlignRightMiddle",this.btnAlignLeftBottom.propertyName="btnAlignLeftBottom",this.btnAlignLeftBottom.propertyDataKind="reserveControl,parent.parent.parent.btnAlignLeftBottom",this.btnAlignMiddleBottom.propertyName="btnAlignMiddleBottom",this.btnAlignMiddleBottom.propertyDataKind="reserveControl,parent.parent.parent.btnAlignMiddleBottom",this.btnAlignRightBottom.propertyName="btnAlignRightBottom",this.btnAlignRightBottom.propertyDataKind="reserveControl,parent.parent.parent.btnAlignRightBottom",this.btnAlignCenter.propertyName="btnAlignCenter",this.btnAlignCenter.propertyDataKind="reserveControl,parent.parent.parent.btnAlignCenter",this.body.onChangeSize=function(){i.cover.position.width=i.body.position.width,i.cover.position.height=i.body.position.height,i.alignCover.position.width=i.body.position.width,i.alignCover.position.height=i.body.position.height},this.btnCustomAlign.onClick=function(){i.alignCover.visible?i.alignCover.hideCover():i.alignCover.showCover()},this.btnClose.onClick=function(){i.close()},this.btnMinimize.onClick=function(){i.minimize()},this.btnMaximize.onClick=function(){i.maximize()},this.btnSendToBack.onClick=function(){i.doSendToBack()},this.btnAlignLeftTop.onClick=function(){null!=i.parent&&(o(),i.position.left=0,i.position.top=0,i.position.width=i.parent.position.width/2,i.position.height=i.parent.position.height/2,i.alignCover.hideCover())},this.btnAlignMiddleTop.onClick=function(){null!=i.parent&&(o(),i.position.left=0,i.position.top=0,i.position.width=i.parent.position.width,i.position.height=i.parent.position.height/2,i.alignCover.hideCover())},this.btnAlignRightTop.onClick=function(){null!=i.parent&&(o(),i.position.left=i.parent.position.width/2,i.position.top=0,i.position.width=i.parent.position.width/2,i.position.height=i.parent.position.height/2,i.alignCover.hideCover())},this.btnAlignLeftMiddle.onClick=function(){null!=i.parent&&(o(),i.position.left=0,i.position.top=0,i.position.width=i.parent.position.width/2,i.position.height=i.parent.position.height,i.alignCover.hideCover())},this.btnAlignCenter.onClick=function(){i.position.left=i.__orgPosition.left,i.position.top=i.__orgPosition.top,i.position.width=i.__orgPosition.width,i.position.height=i.__orgPosition.height,i.alignCover.hideCover()},this.btnAlignRightMiddle.onClick=function(){null!=i.parent&&(o(),i.position.left=i.parent.position.width/2,i.position.top=0,i.position.width=i.parent.position.width/2,i.position.height=i.parent.position.height,i.alignCover.hideCover())},this.btnAlignLeftBottom.onClick=function(){null!=i.parent&&(o(),i.position.left=0,i.position.top=i.parent.position.height/2,i.position.width=i.parent.position.width/2,i.position.height=i.parent.position.height/2,i.alignCover.hideCover())},this.btnAlignMiddleBottom.onClick=function(){null!=i.parent&&(o(),i.position.left=0,i.position.top=i.parent.position.height/2,i.position.width=i.parent.position.width,i.position.height=i.parent.position.height/2,i.alignCover.hideCover())},this.btnAlignRightBottom.onClick=function(){null!=i.parent&&(o(),i.position.left=i.parent.position.width/2,i.position.top=i.parent.position.height/2,i.position.width=i.parent.position.width/2,i.position.height=i.parent.position.height/2,i.alignCover.hideCover())}}get title(){return this.caption.text}set title(t){this.caption.text=t}get state(){return this.__state}setActivate(){null!=CWindowModel.activateWindow?CWindowModel.activateWindow!=this&&(CWindowModel.activateWindow.doDeactivate(),CWindowModel.activateWindow=this,this.doActivate()):(CWindowModel.activateWindow=this,this.doActivate())}doToData(t){super.doToData(t),CDataClass.putData(t,"caption",this.caption.toData(),{},!0),CDataClass.putData(t,"icon",this.icon.toData(),{},!0),CDataClass.putData(t,"btnClose",this.btnClose.toData(),{},!0),CDataClass.putData(t,"btnMaximize",this.btnMaximize.toData(),{},!0),CDataClass.putData(t,"btnCustomAlign",this.btnCustomAlign.toData(),{},!0),CDataClass.putData(t,"btnMinimize",this.btnMinimize.toData(),{},!0),CDataClass.putData(t,"btnSendToBack",this.btnSendToBack.toData(),{},!0),CDataClass.putData(t,"body",this.body.toData(),{},!0),CDataClass.putData(t,"alignCover",this.alignCover.toData(),{},!0),CDataClass.putData(t,"customAlign",this.customAlign.toData(),{},!0),CDataClass.putData(t,"btnAlignLeftTop",this.btnAlignLeftTop.toData(),{},!0),CDataClass.putData(t,"btnAlignMiddleTop",this.btnAlignMiddleTop.toData(),{},!0),CDataClass.putData(t,"btnAlignRightTop",this.btnAlignRightTop.toData(),{},!0),CDataClass.putData(t,"btnAlignLeftMiddle",this.btnAlignLeftMiddle.toData(),{},!0),CDataClass.putData(t,"btnAlignRightMiddle",this.btnAlignRightMiddle.toData(),{},!0),CDataClass.putData(t,"btnAlignLeftBottom",this.btnAlignLeftBottom.toData(),{},!0),CDataClass.putData(t,"btnAlignMiddleBottom",this.btnAlignMiddleBottom.toData(),{},!0),CDataClass.putData(t,"btnAlignRightBottom",this.btnAlignRightBottom.toData(),{},!0),CDataClass.putData(t,"btnAlignCenter",this.btnAlignCenter.toData(),{},!0),CDataClass.putData(t,"closeAction",this.closeAction,"remove"),CDataClass.putData(t,"cover",this.cover.toData(),{},!0),null!=this.showAnimationTrigger&&CDataClass.putData(t,"showAnimationTrigger",this.showAnimationTrigger.toData(),{},!0),null!=this.hideAnimationTrigger&&CDataClass.putData(t,"hideAnimationTrigger",this.hideAnimationTrigger.toData(),{},!0),null!=this.activateAnimationTrigger&&CDataClass.putData(t,"activateAnimationTrigger",this.activateAnimationTrigger.toData(),{},!0),null!=this.maximizeAnimationTrigger&&CDataClass.putData(t,"maximizeAnimationTrigger",this.maximizeAnimationTrigger.toData(),{},!0),null!=this.minimizeAnimationTrigger&&CDataClass.putData(t,"minimizeAnimationTrigger",this.minimizeAnimationTrigger.toData(),{},!0),null!=this.customAlignAnimationTrigger&&CDataClass.putData(t,"customAlignAnimationTrigger",this.customAlignAnimationTrigger.toData(),{},!0)}doFromData(t){super.doFromData(t),this.caption.fromData(CDataClass.getData(t,"caption",{},!0)),this.icon.fromData(CDataClass.getData(t,"icon",{},!0)),this.btnClose.fromData(CDataClass.getData(t,"btnClose",{},!0)),this.btnMaximize.fromData(CDataClass.getData(t,"btnMaximize",{},!0)),this.btnCustomAlign.fromData(CDataClass.getData(t,"btnCustomAlign",{},!0)),this.btnMinimize.fromData(CDataClass.getData(t,"btnMinimize",{},!0)),this.btnSendToBack.fromData(CDataClass.getData(t,"btnSendToBack",{},!0)),this.body.fromData(CDataClass.getData(t,"body",{},!0)),this.alignCover.fromData(CDataClass.getData(t,"alignCover",{},!0)),this.customAlign.fromData(CDataClass.getData(t,"customAlign",{},!0)),this.btnAlignLeftTop.fromData(CDataClass.getData(t,"btnAlignLeftTop",{},!0)),this.btnAlignMiddleTop.fromData(CDataClass.getData(t,"btnAlignMiddleTop",{},!0)),this.btnAlignRightTop.fromData(CDataClass.getData(t,"btnAlignRightTop",{},!0)),this.btnAlignLeftMiddle.fromData(CDataClass.getData(t,"btnAlignLeftMiddle",{},!0)),this.btnAlignRightMiddle.fromData(CDataClass.getData(t,"btnAlignRightMiddle",{},!0)),this.btnAlignLeftBottom.fromData(CDataClass.getData(t,"btnAlignLeftBottom",{},!0)),this.btnAlignMiddleBottom.fromData(CDataClass.getData(t,"btnAlignMiddleBottom",{},!0)),this.btnAlignRightBottom.fromData(CDataClass.getData(t,"btnAlignRightBottom",{},!0)),this.btnAlignCenter.fromData(CDataClass.getData(t,"btnAlignCenter",{},!0)),this.closeAction=CDataClass.getData(t,"closeAction",""),this.cover.fromData(CDataClass.getData(t,"cover",{},!0)),CAnimator.fromAnimatorData(t,this,"showAnimationTrigger"),CAnimator.fromAnimatorData(t,this,"hideAnimationTrigger"),CAnimator.fromAnimatorData(t,this,"activateAnimationTrigger"),CAnimator.fromAnimatorData(t,this,"maximizeAnimationTrigger"),CAnimator.fromAnimatorData(t,this,"minimizeAnimationTrigger"),CAnimator.fromAnimatorData(t,this,"customAlignAnimationTrigger")}doPointerDown(t){this.setActivate(),super.doPointerDown(t)}doClose(){if("remove"==this.closeAction)if(null!=this.hideAnimationTrigger){let t=this;this.hideAnimationTrigger.onAfterAnimation=function(){t.remove()},this.hideAnimationTrigger.start()}else this.remove();else this.hide()}doActivate(){this.bringToFront();let t=this;if(0!=this.transform.translateZ){let e=this.transform.translateZ,i=this.transform.rotateY,o=this.filter.blurValue;CAnimation.graphAnimate(200,["acc_head_10000.graph"],function(s,n,a,r,l){t.transform.translateZ=e-e*l,t.transform.rotateY=i-i*l,t.filter.blurValue=o-o*l})}null!=this.activateAnimationTrigger&&this.triggerTrue(this.activateAnimationTrigger),null!=this.onActivate&&this.onActivate(this)}doDeactivate(){null!=this.activateAnimationTrigger&&this.triggerFalse(this.activateAnimationTrigger),null!=this.onDectivate&&this.onDectivate(this)}doMinimize(){"none"==this.__state?(this.__orgPosition.fromData(this.position.toData()),this.doHidePadding(),this.body.visible=!1,this.position.height=this.caption.position.height,this.btnMaximize.visible=!1,this.__state="minimize"):(this.doShowPadding(),this.body.visible=!0,this.btnMaximize.visible=!0,this.position.height=this.__orgPosition.height,this.__state="none")}doMaximize(){"none"==this.__state?(this.__orgPosition.fromData(this.position.toData()),this.doHidePadding(),this.position.align=EPositionAlign.CLIENT,this.btnMinimize.visible=!1,this.__state="maximize"):(this.position.align=EPositionAlign.NONE,this.position.fromData(this.__orgPosition.toData()),this.btnMinimize.visible=!0,this.__state="none")}doSendToBack(){let t=this;0==this.transform.translateZ&&(this.filter.filterSet.blur||(this.filter.filterSet.blur=!0),CAnimation.graphAnimate(200,["acc_head_10000.graph"],function(e,i,o,s,n){t.transform.translateZ=-1e4*n,t.transform.rotateY=45*n,t.filter.blurValue=10*n},void 0,void 0,void 0,void 0,void 0,void 0,function(){t.sendToBack()}))}doShowPadding(){this.position.padding.left=this.__orgPadding.left,this.position.padding.top=this.__orgPadding.top,this.position.padding.right=this.__orgPadding.right,this.position.padding.bottom=this.__orgPadding.bottom}doHidePadding(){this.__orgPadding.left=this.position.padding.left,this.__orgPadding.top=this.position.padding.top,this.__orgPadding.right=this.position.padding.right,this.__orgPadding.bottom=this.position.padding.bottom,this.position.padding.all=0}doShowWindow(){if(null!=this.onBeforeShow&&this.onBeforeShow(this),this.setActivate(),this.visible=!0,null!=this.showAnimationTrigger){let t=this;this.showAnimationTrigger.onAfterAnimation=function(){null!=t.onShow&&t.onShow(t)},this.showAnimationTrigger.start()}else null!=this.onShow&&this.onShow(this)}doHideWindow(){if(null!=this.onBeforeHide&&this.onBeforeHide(this),null!=this.hideAnimationTrigger){let t=this;this.hideAnimationTrigger.onAfterAnimation=function(){t.visible=!1,null!=t.onHide&&t.onHide(t)},this.hideAnimationTrigger.start()}else this.visible=!1,null!=this.onHide&&this.onHide(this)}close(){this.doClose()}minimize(){this.doMinimize()}maximize(){this.doMaximize()}show(t,e,i,o,s,n){null!=t&&(this.position.left=t),null!=e&&(this.position.top=e),null!=i&&(this.position.width=i),null!=o&&(this.position.height=o),null!=s&&(this.title=s),null!=n&&(this.closeAction=n),this.doShowWindow()}showCenter(t,e,i,o){null!=this.parent&&(this.position.width=t,this.position.height=e,this.position.left=Math.round((this.parent.position.width-this.position.width)/2),this.position.top=Math.round((this.parent.position.height-this.position.height)/2)),null!=i&&(this.title=i),null!=o&&(this.closeAction=o),this.doShowWindow()}hide(){this.doHideWindow()}addProperties(){let t=super.addProperties();return t.push({instance:this.title,propertyName:"title",readOnly:!1,enum:[]}),t.push({instance:this.showAnimationTrigger,propertyName:"showAnimationTrigger",readOnly:!1,enum:[]}),t.push({instance:this.hideAnimationTrigger,propertyName:"hideAnimationTrigger",readOnly:!1,enum:[]}),t.push({instance:this.activateAnimationTrigger,propertyName:"activateAnimationTrigger",readOnly:!1,enum:[]}),t.push({instance:this.maximizeAnimationTrigger,propertyName:"maximizeAnimationTrigger",readOnly:!1,enum:[]}),t.push({instance:this.minimizeAnimationTrigger,propertyName:"minimizeAnimationTrigger",readOnly:!1,enum:[]}),t.push({instance:this.customAlignAnimationTrigger,propertyName:"customAlignAnimationTrigger",readOnly:!1,enum:[]}),t}}class CWindowBlue extends CWindowModel{constructor(t,e){super(t,e),this.resource="windowBlue.frame"}}class CWindowTool extends CWindowModel{constructor(t,e){super(t,e),this.resource="window_sky_dialog.frame"}}class CWindowChildTool extends CWindowModel{constructor(t,e){super(t,e),this.resource="chiled_window_20_dialog.frame"}}class CAlarm extends CPanel{constructor(t,e){super(t,e),this.alarmAnimationTrigger=new CSceneAnimation,this.opacity=0}showAlarm(t=!0){if(t){let t=this;this.alarmAnimationTrigger.onFinish=function(){t.remove()}}this.alarmAnimationTrigger.start()}}class CWorkSpace extends CPanel{constructor(){super(...arguments),this._workSpaceTranslateX=0,this._workSpaceTranslateY=0,this._workSpaceTranslateZ=0}get workSpaceTranslateX(){return this._workSpaceTranslateX}set workSpaceTranslateX(t){this._workSpaceTranslateX!=t&&(this._workSpaceTranslateX=t,this.doChangeWorkSpaceTranslateValue())}get workSpaceTranslateY(){return this._workSpaceTranslateY}set workSpaceTranslateY(t){this._workSpaceTranslateY!=t&&(this._workSpaceTranslateY=t,this.doChangeWorkSpaceTranslateValue())}get workSpaceTranslateZ(){return this._workSpaceTranslateZ}set workSpaceTranslateZ(t){this._workSpaceTranslateZ!=t&&(this._workSpaceTranslateZ=t,this.doChangeWorkSpaceTranslateValue())}doRemove(){if(null!=this.__board){for(let t=0;t<this.__board.workSpaceList.length;t++)if(this.__board.workSpaceList.get(t)==this){this.__board.workSpaceList.delete(t);break}this.__board=void 0}super.doRemove()}doChangeWorkSpaceTranslateValue(){this.transform.translateX=this._workSpaceTranslateX,this.transform.translateY=this._workSpaceTranslateY,this.transform.translateZ=this._workSpaceTranslateZ,null!=this.onChangeWorkSpaceTranslateValue&&this.onChangeWorkSpaceTranslateValue(this)}}class CCamera extends CNotifyChangeNotifyObject{constructor(){super(...arguments),this._x=0,this._y=0,this._z=0,this._angleX=0,this._angleY=0}get x(){return this._x}set x(t){null!=this._x&&(this._x=t,this.doChangeCameraPosition())}get y(){return this._y}set y(t){null!=this._y&&(this._y=t,this.doChangeCameraPosition())}get z(){return this._z}set z(t){null!=this._z&&(this._z=t,this.doChangeCameraPosition())}get angleX(){return this._angleX}set angleX(t){null!=this._angleX&&(this._angleX=t,this.doChangeCameraPosition())}get angleY(){return this._angleY}set angleY(t){null!=this._angleY&&(this._angleY=t,this.doChangeCameraPosition())}doChangeCameraPosition(){null!=this.onChangeCameraPosition&&this.onChangeCameraPosition(this)}}class CWorkSpaceBoard extends CPanel{constructor(t,e){super(t,e),this._camera=new CCamera,this._workSpaceList=new CList,this.animationDuration=0,this.animationGraphName="";let i=this;this.transform.translateZ=.25,this._workSpaceList.onChange=function(){i.doChangeWorkSpaceList()},this._camera.onChangeCameraPosition=function(){i.doChangeCamera()}}get camera(){return this._camera}get workSpaceList(){return this._workSpaceList}get selectedWorkSpace(){return this._selectedWorkSpace}set selectedWorkSpace(t){this._selectedWorkSpace!=t&&(this._selectedWorkSpace=t,this.doChangeSelectedWorkSpace())}setWorkSpaceSize(){for(let t=0;t<this._workSpaceList.length;t++)this._workSpaceList.get(t).position.left=0,this._workSpaceList.get(t).position.top=0,this._workSpaceList.get(t).position.width=this.position.width,this._workSpaceList.get(t).position.height=this.position.height}doChangeSize(){super.doChangeSize(),this.setWorkSpaceSize()}doChangeWorkSpaceList(){this.setWorkSpaceSize(),null!=this.onChangeWorkSpaceList&&this.onChangeWorkSpaceList(this)}doChangeCamera(){for(let t=0;t<this._workSpaceList.length;t++){let e=this._workSpaceList.get(t).workSpaceTranslateX-this.camera.x,i=this._workSpaceList.get(t).workSpaceTranslateY-this.camera.y,o=this._workSpaceList.get(t).workSpaceTranslateZ-this.camera.z,s=CPoint3D.getAngleToPoint3D(new CPoint3D(e,i,o),0,180+this.camera.angleX,Math.abs(this.camera.z-this._workSpaceList.get(t).transform.translateZ)),n=CPoint3D.getAngleToPoint3D(new CPoint3D(e,i,o),90,180+this.camera.angleY,Math.abs(this.camera.z-this._workSpaceList.get(t).transform.translateZ));this._workSpaceList.get(t).transform.translateX=s.x,this._workSpaceList.get(t).transform.translateY=n.y,this._workSpaceList.get(t).transform.translateZ=o,this._workSpaceList.get(t).transform.rotateY=this.camera.angleX,this._workSpaceList.get(t).transform.rotateX=this.camera.angleY}null!=this.onChangeCamera&&this.onChangeCamera(this)}doChangeSelectedWorkSpace(){let t=this;if(null!=this.selectedWorkSpace){let e=this.camera.x,i=this.camera.y,o=this.camera.z,s=this.selectedWorkSpace.workSpaceTranslateX,n=this.selectedWorkSpace.workSpaceTranslateY,a=this.selectedWorkSpace.workSpaceTranslateZ;0!=this.animationDuration&&""!=this.animationGraphName?CAnimation.graphAnimate(this.animationDuration,[this.animationGraphName],function(r,l,h,d,u){t.camera.x=CCalc.crRange2Value(0,1,u,e,s),t.camera.y=CCalc.crRange2Value(0,1,u,i,n),t.camera.z=CCalc.crRange2Value(0,1,u,o,a)}):(t.camera.x=s,t.camera.y=n,t.camera.z=a)}else{let e=this.camera.x,i=this.camera.y,o=this.camera.z;0!=this.animationDuration&&""!=this.animationGraphName?CAnimation.graphAnimate(this.animationDuration,[this.animationGraphName],function(s,n,a,r,l){t.camera.x=e-e*l,t.camera.y=i-i*l,t.camera.z=o-o*l}):(t.camera.x=0,t.camera.y=0,t.camera.z=0)}null!=this.onChangeSelectedWorkSpace&&this.onChangeSelectedWorkSpace(this)}addWorkSpace(t,e){let i=new CWorkSpace(this,t);return null!=e&&(i.resource=e),i.position.left=0,i.position.top=0,i.position.width=this.position.width,i.position.height=this.position.height,this.workSpaceList.add(i),i}cameraMove(t,e,i,o,s){let n=this.camera.x,a=this.camera.y,r=this.camera.z,l=this.camera.angleX,h=this.camera.angleY;if(0!=this.animationDuration&&""!=this.animationGraphName){let d=this;CAnimation.graphAnimate(this.animationDuration,[this.animationGraphName],function(u,c,g,_,C){d.camera.x=CCalc.crRange2Value(0,1,C,n,t),d.camera.y=CCalc.crRange2Value(0,1,C,a,e),d.camera.z=CCalc.crRange2Value(0,1,C,r,i),d.camera.angleX=CCalc.crRange2Value(0,1,C,l,o),d.camera.angleY=CCalc.crRange2Value(0,1,C,h,s)})}else this.camera.x=t,this.camera.y=e,this.camera.z=i,this.camera.angleX=o,this.camera.angleY=s}}