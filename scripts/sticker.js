"use strict";class CStickersModel extends CWindowModel{constructor(){super(...arguments),this.list=new CListBox(this.body)}doToData(t){super.doToData(t),CDataClass.putData(t,"list",this.list.toData(),{},!0)}doFromData(t){super.doFromData(t),this.list.fromData(CDataClass.getData(t,"list",{},!0))}}class CStickerModel extends CWindowModel{constructor(t,e){super(t,e),this._title="",this._desc="",this._stickerResource="",this.txtTitle=new CTextBox(this.caption),this.txtDesc=new CTextArea(this.body),this.btnSetting=new CButton(this.caption),this.btnAddSticker=new CButton(this.caption),this.btnWrap=new CSelectBox(this.caption),this.stickerId=-1,this.isStickerSet=!1,this.orgWidth=0,this.orgHeight=0,this.orgLeft=0,this.orgTop=0,this.stickerIndex=-1;let i=this;this.txtTitle.visible=!1,this.txtTitle.onChangeFocus=function(){i.txtTitle.focused||(i.title=i.txtTitle.text,i.txtTitle.visible=!1)},this.txtTitle.onKeyDown=function(t,e){"Enter"==e.key&&(i.title=i.txtTitle.text,i.txtTitle.focused=!1)},this.txtDesc.onChangeText=function(){i.desc=i.txtDesc.text},this.txtDesc.onChangeFocus=function(){i.txtDesc.focused&&90==i.transform.rotateY&&CAnimation.animate(200,function(t,e,s){i.opacity=.5+.5*e,i.transform.rotateY=90-90*e})},this.btnWrap.onChangeSelected=function(){i.isStickerSet&&(i.txtDesc.wrap=i.btnWrap.selected,i.txtDesc.useHScrollbar=!i.btnWrap.selected)},this.btnSetting.onClick=function(){i.isStickerSet&&CSystem.prompt("스티커 리소스",["Resource"],CSystem.browserCovers.get("cover"),function(t){""==t[0]?i.stickerResource="sticker_base.frame":i.stickerResource=t[0]})},this.btnAddSticker.onClick=function(){i.doStickerAdd()},CStickerModel.stickers.add(this)}get title(){return this._title}set title(t){this._title!=t&&(this._title=t,this.caption.text=t)}get desc(){return this._desc}set desc(t){this._desc=t,this.txtDesc.text=t}get stickerResource(){return this._stickerResource}set stickerResource(t){this._stickerResource!=t&&(this._stickerResource=t,this.doStickerResourceSet())}doToData(t){super.doToData(t),CDataClass.putData(t,"txtTitle",this.txtTitle.toData(),{},!0),CDataClass.putData(t,"txtDesc",this.txtDesc.toData(),{},!0),CDataClass.putData(t,"btnSetting",this.btnSetting.toData(),{},!0),CDataClass.putData(t,"btnAddSticker",this.btnAddSticker.toData(),{},!0),CDataClass.putData(t,"btnWrap",this.btnWrap.toData(),{},!0)}doFromData(t){super.doFromData(t),this.txtTitle.fromData(CDataClass.getData(t,"txtTitle",{},!0)),this.txtDesc.fromData(CDataClass.getData(t,"txtDesc",{},!0)),this.btnSetting.fromData(CDataClass.getData(t,"btnSetting",{},!0)),this.btnAddSticker.fromData(CDataClass.getData(t,"btnAddSticker",{},!0)),this.btnWrap.fromData(CDataClass.getData(t,"btnWrap",{},!0)),this.txtTitle.visible=!1}doRemove(){CStickerModel.stickers.delete(this),super.doRemove()}doDoubleClick(t){super.doDoubleClick(t),this.txtTitle.visible=!0,this.txtTitle.text=this.caption.text,this.txtTitle.focused=!0}doStickerResourceSet(){this.isStickerSet=!1;let t=this.title,e=this.desc,i=this.btnWrap.selected,s=this.position.left,o=this.position.top,a=this.position.width,r=this.position.height;this.resource=this.stickerResource,this.title=t,this.desc=e,this.caption.text=t,this.btnWrap.selected=i,this.position.left=s,this.position.top=o,this.position.width=a,this.position.height=r,this.isStickerSet=!0}doStickerAdd(){}static showStickers(t){this.stickers.forEach(function(t){t.remove()}),this.stickers.clear();let e=JSON.parse(t);for(let t=0;t<e.length;t++){let i=new CStickerModel(CSystem.desktopList.get(0).applicationLayer);null!=e[t].RESOURCE_NAME&&""!=e[t].RESOURCE_NAME?i.stickerResource=e[t].RESOURCE_NAME:i.stickerResource="sticker_base.frame",i.isStickerSet=!1,i.show(e[t].STICKER_LEFT,e[t].STICKER_TOP,e[t].STICKER_WIDTH,e[t].STICKER_HEIGHT,"","remove"),i.stickerId=e[t].ID,i.title=e[t].TITLE,i.desc=e[t].STICKER_DESC,"Y"==e[t].WRAP_YN&&(i.txtDesc.wrap=!0,i.txtDesc.useHScrollbar=!1,i.btnWrap.selected=!0),i.isStickerSet=!0}}static stickerPreviewOn(t,e){let i=0,s=(CSystem.desktopList.get(0).applicationLayer.position.height-e)/2,o=CSystem.desktopList.get(0).applicationLayer.position.width/CStickerModel.stickers.size;CStickerModel.stickers.forEach(function(a){a.orgLeft=a.position.left,a.orgTop=a.position.top,a.orgWidth=a.position.width,a.orgHeight=a.position.height,a.stickerIndex=i,i++,CAnimation.animate(200,function(i,r,c){a.position.top=CCalc.crRange2Value(0,1,r,a.orgTop,s),a.position.width=CCalc.crRange2Value(0,1,r,a.orgWidth,t),a.position.height=CCalc.crRange2Value(0,1,r,a.orgHeight,e),a.position.left=CCalc.crRange2Value(0,1,r,a.orgLeft,a.stickerIndex*o),a.transform.rotateY=90*r,a.opacity=CCalc.crRange2Value(0,1,r,1,.5)})}),this.isPreview=!0}static stickerPreviewOff(){CStickerModel.stickers.forEach(function(t){let e=t.position.left,i=t.position.top,s=t.position.width,o=t.position.height;CAnimation.animate(200,function(a,r,c){t.position.top=CCalc.crRange2Value(0,1,r,i,t.orgTop),t.position.width=CCalc.crRange2Value(0,1,r,s,t.orgWidth),t.position.height=CCalc.crRange2Value(0,1,r,o,t.orgHeight),t.position.left=CCalc.crRange2Value(0,1,r,e,t.orgLeft),t.transform.rotateY=90-90*r,t.opacity=CCalc.crRange2Value(0,1,r,.5,1)})}),this.isPreview=!1}}CStickerModel.stickers=new Set,CStickerModel.isPreview=!1;